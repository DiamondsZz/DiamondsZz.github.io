<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="L6Lm9d5Crl">
  
  
  
  
  <title>DiamondsZz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="来自一只野生程序猿...">
<meta property="og:type" content="website">
<meta property="og:title" content="DiamondsZz">
<meta property="og:url" content="https://DiamondsZz.github.io/index.html">
<meta property="og:site_name" content="DiamondsZz">
<meta property="og:description" content="来自一只野生程序猿...">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DiamondsZz">
<meta name="twitter:description" content="来自一只野生程序猿...">
  
    <link rel="alternative" href="/atom.xml" title="DiamondsZz" type="application/atom+xml">
  
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet">
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head></html>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

        <a href="/" class="profilepic">
            
            <img lazy-src="/img/iu.jpeg" class="js-avatar">
            
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">DiamondsZz</a></h1>
        </hgroup>
        
        <p class="header-subtitle">DiamondsZz</p>
        
        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        
        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                        </ul>
                    </nav>
                </section>
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/css/" style="font-size: 16.67px;">css</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/vue/" style="font-size: 10px;">vue</a> <a href="/tags/学习/" style="font-size: 13.33px;">学习</a> <a href="/tags/生活，心情/" style="font-size: 10px;">生活，心情</a> <a href="/tags/网站/" style="font-size: 13.33px;">网站</a> <a href="/tags/资源/" style="font-size: 13.33px;">资源</a>
                    </div>
                </section>
                
                
                
                
                <section class="switch-part switch-part3">
                
                    <div id="js-aboutme">矮穷矬!</div>
                </section>
                
            </div>
        </div>
    </header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">DiamondsZz</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/iu.jpeg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">DiamondsZz</a></h1>
            </hgroup>
            
            <p class="header-subtitle">DiamondsZz</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                </div>
            </nav>
        </header>
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-note" class="article article-type-post" itemscope="" itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/03/25/note/" class="article-date">
      <time datetime="2021-03-24T16:00:00.000Z" itemprop="datePublished">2021-03-25</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/03/25/note/">学习记录</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><ol>
<li>基础类型存储在栈内存，被引用或拷贝时，会创建一个完全相等的变量；<blockquote>
<p><code>Undefined</code> <code>Null</code> <code>String</code> <code>Number</code> <code>Boolean</code> <code>Symbol</code> <code>BigInt</code></p>
</blockquote>
</li>
<li>引用类型存储在堆内存，存储的是地址，多个引用指向同一个地址，这里会涉及一个“共享”的概念。<blockquote>
<p><code>Object</code><br><code>Array</code> <code>Date</code> <code>RegExp</code> <code>Function</code> <code>Math</code></p>
</blockquote>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">let a = &#123;</span><br><span class="line">  name: &quot;Julia&quot;,</span><br><span class="line"></span><br><span class="line">  age: 20,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">function change(o) &#123;</span><br><span class="line">  o.age = 24;</span><br><span class="line">  //关键   变量o改变内存指向 跟a已经没有关系</span><br><span class="line">  o = &#123;</span><br><span class="line">    name: &quot;Kath&quot;,</span><br><span class="line">    age: 30,</span><br><span class="line">  &#125;;</span><br><span class="line">  return o;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let b = change(a);</span><br><span class="line"></span><br><span class="line">console.log(b.age); // 第一个console   30</span><br><span class="line"></span><br><span class="line">console.log(a.age); // 第二个console   24</span><br></pre></td></tr></table></figure>
<h2 id="数据类型检测"><a href="#数据类型检测" class="headerlink" title="数据类型检测"></a>数据类型检测</h2><ol>
<li>typeof<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">typeof 1 // &apos;number&apos;</span><br><span class="line"></span><br><span class="line">typeof &apos;1&apos; // &apos;string&apos;</span><br><span class="line"></span><br><span class="line">typeof undefined // &apos;undefined&apos;</span><br><span class="line"></span><br><span class="line">typeof true // &apos;boolean&apos;</span><br><span class="line"></span><br><span class="line">typeof Symbol() // &apos;symbol&apos;</span><br><span class="line"></span><br><span class="line">typeof null // &apos;object&apos;       !!!!!!!!!!!!!!!!</span><br><span class="line"></span><br><span class="line">typeof [] // &apos;object&apos;</span><br><span class="line"></span><br><span class="line">typeof &#123;&#125; // &apos;object&apos;</span><br><span class="line"></span><br><span class="line">typeof console // &apos;object&apos;</span><br><span class="line"></span><br><span class="line">typeof console.log // &apos;function&apos;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li>虽然 typeof null 会输出 object，但这只是 JS 存在的一个悠久 Bug，不代表 null 就是引用数据类型，并且 null 本身也不是对象。因此，null 在 typeof 之后返回的是有问题的结果，不能作为判断 null 的方法。如果你需要在 if 语句中判断是否为 null，直接通过 ‘===null’来判断就好。</li>
<li>引用数据类型 Object，用 typeof 来判断的话，除了 function 会判断为 OK 以外，其余都是 ‘object’，是无法判断出来的。</li>
</ul>
<ol start="2">
<li>instanceof<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">let Car = function() &#123;&#125;</span><br><span class="line"></span><br><span class="line">let benz = new Car()</span><br><span class="line"></span><br><span class="line">benz instanceof Car // true</span><br><span class="line"></span><br><span class="line">let car = new String(&apos;Mercedes Benz&apos;)</span><br><span class="line"></span><br><span class="line">car instanceof String // true</span><br><span class="line"></span><br><span class="line">let str = &apos;Covid-19&apos;</span><br><span class="line"></span><br><span class="line">str instanceof String // false</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">---------------------------------</span><br><span class="line"></span><br><span class="line">function myInstanceof(left, right) &#123;</span><br><span class="line"></span><br><span class="line">  // 这里先用typeof来判断基础数据类型，如果是，直接返回false</span><br><span class="line"></span><br><span class="line">  if(typeof left !== &apos;object&apos; || left === null) return false;</span><br><span class="line"></span><br><span class="line">  // getPrototypeOf是Object对象自带的API，能够拿到参数的原型对象</span><br><span class="line"></span><br><span class="line">  let proto = Object.getPrototypeOf(left);</span><br><span class="line"></span><br><span class="line">  while(true) &#123;                  //循环往下寻找，直到找到相同的原型对象</span><br><span class="line"></span><br><span class="line">    if(proto === null) return false;</span><br><span class="line"></span><br><span class="line">    if(proto === right.prototype) return true;//找到相同原型对象，返回true</span><br><span class="line"></span><br><span class="line">    proto = Object.getPrototypeof(proto);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 验证一下自己实现的myInstanceof是否OK</span><br><span class="line"></span><br><span class="line">console.log(myInstanceof(new Number(123), Number));    // true</span><br><span class="line"></span><br><span class="line">console.log(myInstanceof(123, Number));                // false</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li>instanceof 可以准确地判断复杂引用数据类型，但是不能正确判断基础数据类型；</li>
<li>而 typeof 也存在弊端，它虽然可以判断基础数据类型（null 除外），但是引用数据类型中，除了 function 类型以外，其他的也无法判断。</li>
</ul>
<ol start="3">
<li>Object.prototype.toString<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">Object.prototype.toString(&#123;&#125;)       // &quot;[object Object]&quot;</span><br><span class="line"></span><br><span class="line">Object.prototype.toString.call(&#123;&#125;)  // 同上结果，加上call也ok</span><br><span class="line"></span><br><span class="line">Object.prototype.toString.call(1)    // &quot;[object Number]&quot;</span><br><span class="line"></span><br><span class="line">Object.prototype.toString.call(&apos;1&apos;)  // &quot;[object String]&quot;</span><br><span class="line"></span><br><span class="line">Object.prototype.toString.call(true)  // &quot;[object Boolean]&quot;</span><br><span class="line"></span><br><span class="line">Object.prototype.toString.call(function()&#123;&#125;)  // &quot;[object Function]&quot;</span><br><span class="line"></span><br><span class="line">Object.prototype.toString.call(null)   //&quot;[object Null]&quot;</span><br><span class="line"></span><br><span class="line">Object.prototype.toString.call(undefined) //&quot;[object Undefined]&quot;</span><br><span class="line"></span><br><span class="line">Object.prototype.toString.call(/123/g)    //&quot;[object RegExp]&quot;</span><br><span class="line"></span><br><span class="line">Object.prototype.toString.call(new Date()) //&quot;[object Date]&quot;</span><br><span class="line"></span><br><span class="line">Object.prototype.toString.call([])       //&quot;[object Array]&quot;</span><br><span class="line"></span><br><span class="line">Object.prototype.toString.call(document)  //&quot;[object HTMLDocument]&quot;</span><br><span class="line"></span><br><span class="line">Object.prototype.toString.call(window)   //&quot;[object Window]&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function getType(obj)&#123;</span><br><span class="line">  let type  = typeof obj;</span><br><span class="line">  if (type !== &quot;object&quot;) &#123;    // 先进行typeof判断，如果是基础数据类型，直接返回</span><br><span class="line">    return type;</span><br><span class="line">  &#125;</span><br><span class="line">  // 对于typeof返回结果是object的，再进行如下的判断，正则返回结果</span><br><span class="line">  return Object.prototype.toString.call(obj).replace(/^\[object (\S+)\]$/, &apos;$1&apos;);  // 注意正则中间有个空格</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="数据类型转换"><a href="#数据类型转换" class="headerlink" title="数据类型转换"></a>数据类型转换</h2><ol>
<li>强制类型转换 Number()、parseInt()、parseFloat()、toString()、String()、Boolean()<blockquote>
<p>Number() 方法的强制转换规则<br>如果是布尔值，true 和 false 分别被转换为 1 和 0；<br>如果是数字，返回自身；<br>如果是 null，返回 0；<br>如果是 undefined，返回 NaN；<br>如果是字符串，遵循以下规则：如果字符串中只包含数字（或者是 0X / 0x 开头的十六进制数字字符串，允许包含正负号），则将其转换为十进制；如果字符串中包含有效的浮点格式，将其转换为浮点数值；如果是空字符串，将其转换为 0；如果不是以上格式的字符串，均返回 NaN；<br>如果是 Symbol，抛出错误；<br>如果是对象，并且部署了 [Symbol.toPrimitive] ，那么调用此方法，否则调用对象的 valueOf() 方法，然后依据前面的规则转换返回的值；如果转换的结果是 NaN ，则调用对象的 toString() 方法，再次依照前面的顺序转换返回对应的值</p>
</blockquote>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Number(true);        // 1</span><br><span class="line"></span><br><span class="line">Number(false);       // 0</span><br><span class="line"></span><br><span class="line">Number(&apos;0111&apos;);      //111</span><br><span class="line"></span><br><span class="line">Number(null);        //0</span><br><span class="line"></span><br><span class="line">Number(&apos;&apos;);          //0</span><br><span class="line"></span><br><span class="line">Number(&apos;1a&apos;);        //NaN</span><br><span class="line"></span><br><span class="line">Number(-0X11);       //-17</span><br><span class="line"></span><br><span class="line">Number(&apos;0X11&apos;)       //17</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Boolean() 方法的强制转换规则<br>除了 undefined、 null、 false、 ‘’、 0（包括 +0，-0）、 NaN 转换出来是 false，其他都是 true。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Boolean(0)          //false</span><br><span class="line"></span><br><span class="line">Boolean(null)       //false</span><br><span class="line"></span><br><span class="line">Boolean(undefined)  //false</span><br><span class="line"></span><br><span class="line">Boolean(NaN)        //false</span><br><span class="line"></span><br><span class="line">Boolean(1)          //true</span><br><span class="line"></span><br><span class="line">Boolean(13)         //true</span><br><span class="line"></span><br><span class="line">Boolean(&apos;12&apos;)       //true</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>‘==’ 的隐式类型转换规则</li>
</ol>
<ul>
<li>如果类型相同，无须进行类型转换；</li>
<li>如果其中一个操作值是 null 或者 undefined，那么另一个操作符必须为 null 或者 undefined，才会返回 true，否则都返回 false；</li>
<li>如果其中一个是 Symbol 类型，那么返回 false；</li>
<li>两个操作值如果为 string 和 number 类型，那么就会将字符串转换为 number；</li>
<li>如果一个操作值是 boolean，那么转换成 number；</li>
<li>如果一个操作值为 object 且另一方为 string、number 或者 symbol，就会把 object 转为原始类型再进行判断（调用 object 的 valueOf/toString 方法进行转换）。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">null == undefined       // true  规则2</span><br><span class="line"></span><br><span class="line">null == 0               // false 规则2</span><br><span class="line"></span><br><span class="line">&apos;&apos; == null              // false 规则2</span><br><span class="line"></span><br><span class="line">&apos;&apos; == 0                 // true  规则4 字符串转隐式转换成Number之后再对比</span><br><span class="line"></span><br><span class="line">&apos;123&apos; == 123            // true  规则4 字符串转隐式转换成Number之后再对比</span><br><span class="line"></span><br><span class="line">0 == false              // true  e规则 布尔型隐式转换成Number之后再对比</span><br><span class="line"></span><br><span class="line">1 == true               // true  e规则 布尔型隐式转换成Number之后再对比</span><br><span class="line"></span><br><span class="line">var a = &#123;</span><br><span class="line"></span><br><span class="line">  value: 0,</span><br><span class="line"></span><br><span class="line">  valueOf: function() &#123;</span><br><span class="line"></span><br><span class="line">    this.value++;</span><br><span class="line"></span><br><span class="line">    return this.value;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 注意这里a又可以等于1、2、3</span><br><span class="line"></span><br><span class="line">console.log(a == 1 &amp;&amp; a == 2 &amp;&amp; a ==3);  //true f规则 Object隐式转换</span><br><span class="line"></span><br><span class="line">// 注：但是执行过3遍之后，再重新执行a==3或之前的数字就是false，因为value已经加上去了，这里需要注意一下</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol start="3">
<li>‘+’ 的隐式类型转换规则</li>
</ol>
<ul>
<li>如果其中有一个是字符串，另外一个是 undefined、null 或布尔型，则调用 toString() 方法进行字符串拼接；如果是纯对象、数组、正则等，则默认调用对象的转换方法会存在优先级，然后再进行拼接。</li>
<li>如果其中有一个是数字，另外一个是 undefined、null、布尔型或数字，则会将其转换成数字进行加法运算，对象的情况还是参考上一条规则。</li>
<li>如果其中一个是字符串、一个是数字，则按照字符串规则进行拼接</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">1 + 2        // 3  常规情况</span><br><span class="line"></span><br><span class="line">&apos;1&apos; + &apos;2&apos;    // &apos;12&apos; 常规情况</span><br><span class="line"></span><br><span class="line">// 下面看一下特殊情况</span><br><span class="line"></span><br><span class="line">&apos;1&apos; + undefined   // &quot;1undefined&quot; 规则1，undefined转换字符串</span><br><span class="line"></span><br><span class="line">&apos;1&apos; + null        // &quot;1null&quot; 规则1，null转换字符串</span><br><span class="line"></span><br><span class="line">&apos;1&apos; + true        // &quot;1true&quot; 规则1，true转换字符串</span><br><span class="line"></span><br><span class="line">&apos;1&apos; + 1n          // &apos;11&apos; 比较特殊字符串和BigInt相加，BigInt转换为字符串</span><br><span class="line"></span><br><span class="line">1 + undefined     // NaN  规则2，undefined转换数字相加NaN</span><br><span class="line"></span><br><span class="line">1 + null          // 1    规则2，null转换为0</span><br><span class="line"></span><br><span class="line">1 + true          // 2    规则2，true转换为1，二者相加为2</span><br><span class="line"></span><br><span class="line">1 + 1n            // 错误  不能把BigInt和Number类型直接混合相加</span><br><span class="line"></span><br><span class="line">&apos;1&apos; + 3           // &apos;13&apos; 规则3，字符串拼接</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>Object 的转换规则</li>
</ol>
<ul>
<li>如果部署了 Symbol.toPrimitive 方法，优先调用再返回；</li>
<li>调用 valueOf()，如果转换为基础类型，则返回；</li>
<li>调用 toString()，如果转换为基础类型，则返回；</li>
<li>如果都没有返回基础类型，会报错。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;</span><br><span class="line"></span><br><span class="line">  value: 1,</span><br><span class="line"></span><br><span class="line">  valueOf() &#123;</span><br><span class="line"></span><br><span class="line">    return 2;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  toString() &#123;</span><br><span class="line"></span><br><span class="line">    return &apos;3&apos;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  [Symbol.toPrimitive]() &#123;</span><br><span class="line"></span><br><span class="line">    return 4</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(obj + 1); // 输出5</span><br><span class="line"></span><br><span class="line">// 因为有Symbol.toPrimitive，就优先执行这个；如果Symbol.toPrimitive这段代码删掉，则执行valueOf打印结果为3；如果valueOf也去掉，则调用toString返回&apos;31&apos;(字符串拼接)</span><br><span class="line"></span><br><span class="line">// 再看两个特殊的case：</span><br><span class="line"></span><br><span class="line">10 + &#123;&#125;</span><br><span class="line"></span><br><span class="line">// &quot;10[object Object]&quot;，注意：&#123;&#125;会默认调用valueOf是&#123;&#125;，不是基础类型继续转换，调用toString，返回结果&quot;[object Object]&quot;，于是和10进行&apos;+&apos;运算，按照字符串拼接规则来，参考&apos;+&apos;的规则C</span><br><span class="line"></span><br><span class="line">[1,2,undefined,4,5] + 10</span><br><span class="line"></span><br><span class="line">// &quot;1,2,,4,510&quot;，注意[1,2,undefined,4,5]会默认先调用valueOf结果还是这个数组，不是基础数据类型继续转换，也还是调用toString，返回&quot;1,2,,4,5&quot;，然后再和10进行运算，还是按照字符串拼接规则，参考&apos;+&apos;的第3条规则</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="拷贝"><a href="#拷贝" class="headerlink" title="拷贝"></a>拷贝</h2><h4 id="浅拷贝"><a href="#浅拷贝" class="headerlink" title="浅拷贝"></a>浅拷贝</h4><ol>
<li>Object.assign<br><em>注意点</em></li>
</ol>
<ul>
<li>它不会拷贝对象的继承属性；</li>
<li>它不会拷贝对象的不可枚举的属性；</li>
<li>可以拷贝 Symbol 类型的属性。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">let obj1 = &#123; a:&#123; b:1 &#125;, sym:Symbol(1)&#125;; </span><br><span class="line"></span><br><span class="line">Object.defineProperty(obj1, &apos;innumerable&apos; ,&#123;</span><br><span class="line"></span><br><span class="line">    value:&apos;不可枚举属性&apos;,</span><br><span class="line"></span><br><span class="line">    enumerable:false</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">let obj2 = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">Object.assign(obj2,obj1)</span><br><span class="line"></span><br><span class="line">obj1.a.b = 2;</span><br><span class="line"></span><br><span class="line">console.log(&apos;obj1&apos;,obj1);</span><br><span class="line"></span><br><span class="line">console.log(&apos;obj2&apos;,obj2);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol start="2">
<li>扩展运算符<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">/* 对象的拷贝 */</span><br><span class="line"></span><br><span class="line">let obj = &#123;a:1,b:&#123;c:1&#125;&#125;</span><br><span class="line"></span><br><span class="line">let obj2 = &#123;...obj&#125;</span><br><span class="line"></span><br><span class="line">obj.a = 2</span><br><span class="line"></span><br><span class="line">console.log(obj)  //&#123;a:2,b:&#123;c:1&#125;&#125; console.log(obj2); //&#123;a:1,b:&#123;c:1&#125;&#125;</span><br><span class="line"></span><br><span class="line">obj.b.c = 2</span><br><span class="line"></span><br><span class="line">console.log(obj)  //&#123;a:2,b:&#123;c:2&#125;&#125; console.log(obj2); //&#123;a:1,b:&#123;c:2&#125;&#125;</span><br><span class="line"></span><br><span class="line">/* 数组的拷贝 */</span><br><span class="line"></span><br><span class="line">let arr = [1, 2, 3];</span><br><span class="line"></span><br><span class="line">let newArr = [...arr]; //跟arr.slice()是一样的效果</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li>扩展运算符 和 object.assign 有同样的缺陷，也就是实现的浅拷贝的功能差不多，但是如果属性都是基本类型的值，使用扩展运算符进行浅拷贝会更加方便。</li>
</ul>
<ol start="3">
<li>concat 拷贝数组<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">let arr = [1, 2, 3];</span><br><span class="line"></span><br><span class="line">let newArr = arr.concat();</span><br><span class="line"></span><br><span class="line">newArr[1] = 100;</span><br><span class="line"></span><br><span class="line">console.log(arr);  // [ 1, 2, 3 ]</span><br><span class="line"></span><br><span class="line">console.log(newArr); // [ 1, 100, 3 ]</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li>concat 只能用于数组的浅拷贝，使用场景比较局限。</li>
</ul>
<ol start="4">
<li>slice 拷贝数组 </li>
</ol>
<ul>
<li><p>slice 方法也比较有局限性，因为它仅仅针对数组类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let arr = [1, 2, &#123;val: 4&#125;];</span><br><span class="line"></span><br><span class="line">let newArr = arr.slice();</span><br><span class="line"></span><br><span class="line">newArr[2].val = 1000;</span><br><span class="line"></span><br><span class="line">console.log(arr);  //[ 1, 2, &#123; val: 1000 &#125; ]</span><br></pre></td></tr></table></figure>
</li>
<li><p>浅拷贝只能拷贝一层对象。如果存在对象的嵌套，那么浅拷贝将无能为力。因此深拷贝就是为了解决这个问题而生的，它能解决多层对象嵌套问题，彻底实现拷贝。</p>
</li>
</ul>
<ol start="5">
<li>浅拷贝</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">const shallowClone = (target) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  if (typeof target === &apos;object&apos; &amp;&amp; target !== null) &#123;</span><br><span class="line"></span><br><span class="line">    const cloneTarget = Array.isArray(target) ? []: &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    for (let prop in target) &#123;</span><br><span class="line"></span><br><span class="line">      //是否是自有属性</span><br><span class="line">      if (target.hasOwnProperty(prop)) &#123;</span><br><span class="line"></span><br><span class="line">          cloneTarget[prop] = target[prop];</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return cloneTarget;</span><br><span class="line"></span><br><span class="line">  &#125; else &#123;</span><br><span class="line"></span><br><span class="line">    return target;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="深拷贝"><a href="#深拷贝" class="headerlink" title="深拷贝"></a>深拷贝</h4><ol>
<li>JSON.stringify()<br><em>弊端</em></li>
</ol>
<ul>
<li>拷贝的对象的值中如果有函数、undefined、symbol 这几种类型，经过 JSON.stringify 序列化之后的字符串中这个键值对会消失；</li>
<li>拷贝 Date 引用类型会变成字符串；</li>
<li>无法拷贝不可枚举的属性；</li>
<li>无法拷贝对象的原型链；</li>
<li>拷贝 RegExp 引用类型会变成空对象；</li>
<li>对象中含有 NaN、Infinity 以及 -Infinity，JSON 序列化的结果会变成 null；</li>
<li><p>无法拷贝对象的循环应用，即对象成环 (obj[key] = obj)。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">function Obj() &#123; </span><br><span class="line"></span><br><span class="line">  this.func = function () &#123; alert(1) &#125;; </span><br><span class="line"></span><br><span class="line">  this.obj = &#123;a:1&#125;;</span><br><span class="line"></span><br><span class="line">  this.arr = [1,2,3];</span><br><span class="line"></span><br><span class="line">  this.und = undefined; </span><br><span class="line"></span><br><span class="line">  this.reg = /123/; </span><br><span class="line"></span><br><span class="line">  this.date = new Date(0); </span><br><span class="line"></span><br><span class="line">  this.NaN = NaN;</span><br><span class="line"></span><br><span class="line">  this.infinity = Infinity;</span><br><span class="line"></span><br><span class="line">  this.sym = Symbol(1);</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">let obj1 = new Obj();</span><br><span class="line"></span><br><span class="line">Object.defineProperty(obj1,&apos;innumerable&apos;,&#123; </span><br><span class="line"></span><br><span class="line">  enumerable:false,</span><br><span class="line"></span><br><span class="line">  value:&apos;innumerable&apos;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">console.log(&apos;obj1&apos;,obj1);</span><br><span class="line"></span><br><span class="line">let str = JSON.stringify(obj1);</span><br><span class="line"></span><br><span class="line">let obj2 = JSON.parse(str);</span><br><span class="line"></span><br><span class="line">console.log(&apos;obj2&apos;,obj2);</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 JSON.stringify 方法实现深拷贝对象，虽然到目前为止还有很多无法实现的功能，但是这种方法足以满足日常的开发需求，并且是最简单和快捷的。</p>
</li>
</ul>
<ol start="2">
<li>手写递归实现<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">let obj1 = &#123;</span><br><span class="line"></span><br><span class="line">  a:&#123;</span><br><span class="line"></span><br><span class="line">    b:1</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function deepClone(obj) &#123; </span><br><span class="line"></span><br><span class="line">  let cloneObj = &#123;&#125;</span><br><span class="line"></span><br><span class="line">  for(let key in obj) &#123;                 //遍历</span><br><span class="line"></span><br><span class="line">    if(typeof obj[key] ===&apos;object&apos;) &#123; </span><br><span class="line"></span><br><span class="line">      cloneObj[key] = deepClone(obj[key])  //是对象就再次调用该函数递归</span><br><span class="line"></span><br><span class="line">    &#125; else &#123;</span><br><span class="line"></span><br><span class="line">      cloneObj[key] = obj[key]  //基本类型的话直接复制值</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return cloneObj</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let obj2 = deepClone(obj1);</span><br><span class="line"></span><br><span class="line">obj1.a.b = 2;</span><br><span class="line"></span><br><span class="line">console.log(obj2);   //  &#123;a:&#123;b:1&#125;&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><em>弊端</em></p>
<ul>
<li>这个深拷贝函数并不能复制不可枚举的属性以及 Symbol 类型；</li>
<li>这种方法只是针对普通的引用类型的值做递归复制，而对于 Array、Date、RegExp、Error、Function 这样的引用类型并不能正确地拷贝；</li>
<li>对象的属性里面成环，即循环引用没有解决。</li>
</ul>
<ol start="3">
<li>改进后递归实现<br><em>注意点</em></li>
</ol>
<ul>
<li>针对能够遍历对象的不可枚举属性以及 Symbol 类型，我们可以使用 Reflect.ownKeys 方法；</li>
<li>当参数为 Date、RegExp 类型，则直接生成一个新的实例返回；</li>
<li>利用 Object 的 getOwnPropertyDescriptors 方法可以获得对象的所有属性，以及对应的特性，顺便结合 Object 的 create 方法创建一个新对象，并继承传入原对象的原型链；</li>
<li>利用 WeakMap 类型作为 Hash 表，因为 WeakMap 是弱引用类型，可以有效防止内存泄漏（你可以关注一下 Map 和 weakMap 的关键区别，这里要用 weakMap），作为检测循环引用很有帮助，如果存在循环，则引用直接返回 WeakMap 存储的值。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">const isComplexDataType = obj =&gt; (typeof obj === &apos;object&apos; || typeof obj === &apos;function&apos;) &amp;&amp; (obj !== null)</span><br><span class="line"></span><br><span class="line">const deepClone = function (obj, hash = new WeakMap()) &#123;</span><br><span class="line"></span><br><span class="line">  if (obj.constructor === Date) </span><br><span class="line"></span><br><span class="line">  return new Date(obj)       // 日期对象直接返回一个新的日期对象</span><br><span class="line"></span><br><span class="line">  if (obj.constructor === RegExp)</span><br><span class="line"></span><br><span class="line">  return new RegExp(obj)     //正则对象直接返回一个新的正则对象</span><br><span class="line"></span><br><span class="line">  //如果循环引用了就用 weakMap 来解决</span><br><span class="line"></span><br><span class="line">  if (hash.has(obj)) return hash.get(obj)</span><br><span class="line"></span><br><span class="line">  let allDesc = Object.getOwnPropertyDescriptors(obj)</span><br><span class="line"></span><br><span class="line">  //遍历传入参数所有键的特性</span><br><span class="line"></span><br><span class="line">  let cloneObj = Object.create(Object.getPrototypeOf(obj), allDesc)</span><br><span class="line"></span><br><span class="line">  //继承原型链</span><br><span class="line"></span><br><span class="line">  hash.set(obj, cloneObj)</span><br><span class="line"></span><br><span class="line">  for (let key of Reflect.ownKeys(obj)) &#123; </span><br><span class="line"></span><br><span class="line">    cloneObj[key] = (isComplexDataType(obj[key]) &amp;&amp; typeof obj[key] !== &apos;function&apos;) ? deepClone(obj[key], hash) : obj[key]</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return cloneObj</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 下面是验证代码</span><br><span class="line"></span><br><span class="line">let obj = &#123;</span><br><span class="line"></span><br><span class="line">  num: 0,</span><br><span class="line"></span><br><span class="line">  str: &apos;&apos;,</span><br><span class="line"></span><br><span class="line">  boolean: true,</span><br><span class="line"></span><br><span class="line">  unf: undefined,</span><br><span class="line"></span><br><span class="line">  nul: null,</span><br><span class="line"></span><br><span class="line">  obj: &#123; name: &apos;我是一个对象&apos;, id: 1 &#125;,</span><br><span class="line"></span><br><span class="line">  arr: [0, 1, 2],</span><br><span class="line"></span><br><span class="line">  func: function () &#123; console.log(&apos;我是一个函数&apos;) &#125;,</span><br><span class="line"></span><br><span class="line">  date: new Date(0),</span><br><span class="line"></span><br><span class="line">  reg: new RegExp(&apos;/我是一个正则/ig&apos;),</span><br><span class="line"></span><br><span class="line">  [Symbol(&apos;1&apos;)]: 1,</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Object.defineProperty(obj, &apos;innumerable&apos;, &#123;</span><br><span class="line"></span><br><span class="line">  enumerable: false, value: &apos;不可枚举属性&apos; &#125;</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">obj = Object.create(obj, Object.getOwnPropertyDescriptors(obj))</span><br><span class="line"></span><br><span class="line">obj.loop = obj    // 设置loop成循环引用的属性</span><br><span class="line"></span><br><span class="line">let cloneObj = deepClone(obj)</span><br><span class="line"></span><br><span class="line">cloneObj.arr.push(4)</span><br><span class="line"></span><br><span class="line">console.log(&apos;obj&apos;, obj)</span><br><span class="line"></span><br><span class="line">console.log(&apos;cloneObj&apos;, cloneObj)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><ol>
<li>原型链继承<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">function Parent1() &#123;</span><br><span class="line"></span><br><span class="line">  this.name = &apos;parent1&apos;;</span><br><span class="line"></span><br><span class="line">  this.play = [1, 2, 3]</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Child1() &#123;</span><br><span class="line"></span><br><span class="line">  this.type = &apos;child2&apos;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Child1.prototype = new Parent1();</span><br><span class="line">let c1=new Child1()</span><br><span class="line">let c2=new Child1()</span><br><span class="line">console.log(c1.__proto__===c2.__proto__); //true</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>两个实例使用的是同一个原型对象。它们的内存空间是共享的，当一个发生变化的时候，另外一个也随之进行了变化，这就是使用原型链继承方式的一个缺点。</p>
<ol start="2">
<li>构造函数继承（借助 call）</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">function Parent1()&#123;</span><br><span class="line"></span><br><span class="line">  this.name = &apos;parent1&apos;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Parent1.prototype.getName = function () &#123;</span><br><span class="line"></span><br><span class="line">  return this.name;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function Child1()&#123;</span><br><span class="line"></span><br><span class="line">  Parent1.call(this);</span><br><span class="line"></span><br><span class="line">  this.type = &apos;child1&apos;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">let child = new Child1();</span><br><span class="line"></span><br><span class="line">console.log(child);  // 没问题</span><br><span class="line"></span><br><span class="line">console.log(child.getName());  // 会报错</span><br></pre></td></tr></table></figure>
<p>构造函数实现继承的优缺点，它使父类的引用属性不会被共享，优化了第一种继承方式的弊端；<br>但是随之而来的缺点也比较明显——只能继承父类的实例属性和方法，不能继承原型属性或者方法。</p>
<ol start="3">
<li><p>组合继承（前两种组合）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">function Parent3 () &#123;</span><br><span class="line"></span><br><span class="line">  this.name = &apos;parent3&apos;;</span><br><span class="line"></span><br><span class="line">  this.play = [1, 2, 3];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Parent3.prototype.getName = function () &#123;</span><br><span class="line"></span><br><span class="line">  return this.name;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Child3() &#123;</span><br><span class="line"></span><br><span class="line">  // 第二次调用 Parent3()</span><br><span class="line"></span><br><span class="line">  Parent3.call(this);</span><br><span class="line"></span><br><span class="line">  this.type = &apos;child3&apos;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 第一次调用 Parent3()</span><br><span class="line"></span><br><span class="line">Child3.prototype = new Parent3();</span><br><span class="line"></span><br><span class="line">// 手动挂上构造器，指向自己的构造函数</span><br><span class="line"></span><br><span class="line">Child3.prototype.constructor = Child3;</span><br><span class="line"></span><br><span class="line">var s3 = new Child3();</span><br><span class="line"></span><br><span class="line">var s4 = new Child3();</span><br><span class="line"></span><br><span class="line">s3.play.push(4);</span><br><span class="line"></span><br><span class="line">console.log(s3.play, s4.play);  // 不互相影响</span><br><span class="line"></span><br><span class="line">console.log(s3.getName()); // 正常输出&apos;parent3&apos;</span><br><span class="line"></span><br><span class="line">console.log(s4.getName()); // 正常输出&apos;parent3&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>原型式继承</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">let parent4 = &#123;</span><br><span class="line"></span><br><span class="line">  name: &quot;parent4&quot;,</span><br><span class="line"></span><br><span class="line">  friends: [&quot;p1&quot;, &quot;p2&quot;, &quot;p3&quot;],</span><br><span class="line"></span><br><span class="line">  getName: function() &#123;</span><br><span class="line"></span><br><span class="line">    return this.name;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">let person4 = Object.create(parent4);</span><br><span class="line"></span><br><span class="line">person4.name = &quot;tom&quot;;</span><br><span class="line"></span><br><span class="line">person4.friends.push(&quot;jerry&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">let person5 = Object.create(parent4);</span><br><span class="line"></span><br><span class="line">person5.friends.push(&quot;lucy&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">console.log(person4.name);</span><br><span class="line"></span><br><span class="line">console.log(person4.name === person4.getName());</span><br><span class="line"></span><br><span class="line">console.log(person5.name);</span><br><span class="line"></span><br><span class="line">console.log(person4.friends);</span><br><span class="line"></span><br><span class="line">console.log(person5.friends);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>最后两个输出结果是一样的，关于引用数据类型“共享”的问题，其实 Object.create 方法是可以为一些对象实现浅拷贝的。<br>关于这种继承方式的缺点也很明显，多个实例的引用类型属性指向相同的内存，存在篡改的可能。</p>
<ol start="5">
<li>寄生式继承</li>
</ol>
<ul>
<li><p>使用原型式继承可以获得一份目标对象的浅拷贝，然后利用这个浅拷贝的能力再进行增强，添加一些方法，这样的继承方式就叫作寄生式继承。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"> let parent5 = &#123;</span><br><span class="line"></span><br><span class="line">  name: &quot;parent5&quot;,</span><br><span class="line"></span><br><span class="line">  friends: [&quot;p1&quot;, &quot;p2&quot;, &quot;p3&quot;],</span><br><span class="line"></span><br><span class="line">  getName: function() &#123;</span><br><span class="line"></span><br><span class="line">    return this.name;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function clone(original) &#123;</span><br><span class="line"></span><br><span class="line">  let clone = Object.create(original);</span><br><span class="line"></span><br><span class="line">  clone.getFriends = function() &#123;</span><br><span class="line"></span><br><span class="line">    return this.friends;</span><br><span class="line"></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  return clone;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">let person5 = clone(parent5);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">console.log(person5.getName());</span><br><span class="line"></span><br><span class="line">console.log(person5.getFriends());</span><br></pre></td></tr></table></figure>
</li>
<li><p>虽然其优缺点和原型式继承一样，但是对于普通对象的继承方式来说，寄生式继承相比于原型式继承，还是在父类基础上添加了更多的方法。</p>
</li>
</ul>
<ol start="6">
<li>寄生组合式继承</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">function clone (parent, child) &#123;</span><br><span class="line"></span><br><span class="line">  // 这里改用 Object.create 就可以减少组合继承中多进行一次构造的过程</span><br><span class="line"></span><br><span class="line">  child.prototype = Object.create(parent.prototype);</span><br><span class="line"></span><br><span class="line">  child.prototype.constructor = child;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function Parent6() &#123;</span><br><span class="line"></span><br><span class="line">  this.name = &apos;parent6&apos;;</span><br><span class="line"></span><br><span class="line">  this.play = [1, 2, 3];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> Parent6.prototype.getName = function () &#123;</span><br><span class="line"></span><br><span class="line">  return this.name;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Child6() &#123;</span><br><span class="line"></span><br><span class="line">  Parent6.call(this);</span><br><span class="line"></span><br><span class="line">  this.friends = &apos;child5&apos;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">clone(Parent6, Child6);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Child6.prototype.getFriends = function () &#123;</span><br><span class="line"></span><br><span class="line">  return this.friends;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">let person6 = new Child6();</span><br><span class="line"></span><br><span class="line">console.log(person6);</span><br><span class="line"></span><br><span class="line">console.log(person6.getName());</span><br><span class="line"></span><br><span class="line">console.log(person6.getFriends());</span><br></pre></td></tr></table></figure>
<ul>
<li>这种寄生组合式继承方式，基本可以解决前几种继承方式的缺点，较好地实现了继承想要的结果，同时也减少了构造次数，减少了性能的开销</li>
</ul>
<ol start="7">
<li>ES6 的 extends 关键字实现逻辑<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">class Person &#123;</span><br><span class="line"></span><br><span class="line">  constructor(name) &#123;</span><br><span class="line"></span><br><span class="line">    this.name = name</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 原型方法</span><br><span class="line"></span><br><span class="line">  // 即 Person.prototype.getName = function() &#123; &#125;</span><br><span class="line"></span><br><span class="line">  // 下面可以简写为 getName() &#123;...&#125;</span><br><span class="line"></span><br><span class="line">  getName = function () &#123;</span><br><span class="line"></span><br><span class="line">    console.log(&apos;Person:&apos;, this.name)</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Gamer extends Person &#123;</span><br><span class="line"></span><br><span class="line">  constructor(name, age) &#123;</span><br><span class="line"></span><br><span class="line">    // 子类中存在构造函数，则需要在使用“this”之前首先调用 super()。</span><br><span class="line"></span><br><span class="line">    super(name)</span><br><span class="line"></span><br><span class="line">    this.age = age</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const asuna = new Gamer(&apos;Asuna&apos;, 20)</span><br><span class="line"></span><br><span class="line">asuna.getName() // 成功访问到父类的方法</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>利用 babel 这个编译工具，将 ES6 的代码编译成 ES5</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">function _possibleConstructorReturn (self, call) &#123; </span><br><span class="line"></span><br><span class="line">		// ...</span><br><span class="line"></span><br><span class="line">		return call &amp;&amp; (typeof call === &apos;object&apos; || typeof call === &apos;function&apos;) ? call : self; </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function _inherits (subClass, superClass) &#123; </span><br><span class="line"></span><br><span class="line">    // 这里可以看到</span><br><span class="line"></span><br><span class="line">	subClass.prototype = Object.create(superClass &amp;&amp; superClass.prototype, &#123; </span><br><span class="line"></span><br><span class="line">		constructor: &#123; </span><br><span class="line"></span><br><span class="line">			value: subClass, </span><br><span class="line"></span><br><span class="line">			enumerable: false, </span><br><span class="line"></span><br><span class="line">			writable: true, </span><br><span class="line"></span><br><span class="line">			configurable: true </span><br><span class="line"></span><br><span class="line">		&#125; </span><br><span class="line"></span><br><span class="line">	&#125;); </span><br><span class="line"></span><br><span class="line">	if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var Parent = function Parent () &#123;</span><br><span class="line"></span><br><span class="line">	// 验证是否是 Parent 构造出来的 this</span><br><span class="line"></span><br><span class="line">	_classCallCheck(this, Parent);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">var Child = (function (_Parent) &#123;</span><br><span class="line"></span><br><span class="line">	_inherits(Child, _Parent);</span><br><span class="line"></span><br><span class="line">	function Child () &#123;</span><br><span class="line"></span><br><span class="line">		_classCallCheck(this, Child);</span><br><span class="line"></span><br><span class="line">		return _possibleConstructorReturn(this, (Child.__proto__ || Object.getPrototypeOf(Child)).apply(this, arguments));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	return Child;</span><br><span class="line"></span><br><span class="line">&#125;(Parent));</span><br></pre></td></tr></table></figure>
<p>从上面编译完成的源码中可以看到，它采用的也是寄生组合继承方式，因此也证明了这种方式是较优的解决继承的方式。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/学习/">学习</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/学习/">学习</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/网站/">网站</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/资源/">资源</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-record" class="article article-type-post" itemscope="" itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/03/08/record/" class="article-date">
      <time datetime="2021-03-07T16:00:00.000Z" itemprop="datePublished">2021-03-08</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/03/08/record/">记录</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="ES-Modules"><a href="#ES-Modules" class="headerlink" title="ES Modules"></a>ES Modules</h2><p>1.自动采用严格模式（use strict）<br>2.每个ESM模块都是单独的私有作用域<br>3.ESM模块通过CORS（跨域资源共享）去请求外部js模块<br>4.ESM的script标签会延迟脚本的执行</p>
<h2 id="url-loader、file-loader"><a href="#url-loader、file-loader" class="headerlink" title="url-loader、file-loader"></a>url-loader、file-loader</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">url-loader  小文件使用Data URLs,减少请求次数</span><br><span class="line">file-loader 大文件单独提取存放，提高加载速度</span><br><span class="line">&#123;</span><br><span class="line">  test:/.png$/,</span><br><span class="line">  use:&#123;</span><br><span class="line">    loader:&quot;url-loader&quot;,</span><br><span class="line">	options:&#123;</span><br><span class="line">	   limit:10*1024,//10kb以下使用url-loader,10kb以上使用file-loader</span><br><span class="line">	&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="css-loader、style-loader"><a href="#css-loader、style-loader" class="headerlink" title="css-loader、style-loader"></a>css-loader、style-loader</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">css-loader 将css代码转换成js模块</span><br><span class="line">style-loader 将css代码通过style标签插入html当中</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"> test:/.css$/,</span><br><span class="line"> use:[&apos;style-loader&apos;,&apos;css-loader&apos;]  //由后往前加载loader</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="html-loader"><a href="#html-loader" class="headerlink" title="html-loader"></a>html-loader</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> test:/.html$/,</span><br><span class="line"> use:&#123;</span><br><span class="line">  loader:&apos;html-loader&apos;,</span><br><span class="line">  options:&#123;</span><br><span class="line">     attrs:[&apos;img:src&apos;,&apos;a:href&apos;]  //默认只处理img标签src属性</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="loader"><a href="#loader" class="headerlink" title="loader"></a>loader</h2><ul>
<li>专注实现资源模块加载，实现项目打包</li>
<li>加载过程类似于管道，可以依次使用多个loader，最终结果必须是js代码。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">module:&#123;</span><br><span class="line">rules:[</span><br><span class="line">   &#123;</span><br><span class="line">   test:/.md$/,</span><br><span class="line">   use:&apos;./markdown-loader&apos;  //可以是模块路径或模块名称</span><br><span class="line">   &#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//自定义loader  处理md文件</span><br><span class="line">const marked=reuqire(&apos;marked&apos;)</span><br><span class="line">module.exports=source=&gt;&#123;</span><br><span class="line"> const html = marked(source)</span><br><span class="line"> return  `export default $&#123;JSON.stringify(html)&#125;`   //最终输出结果必须是js代码 。   可以返回html，交给html-loader继续处理</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<ul>
<li>编译转换类：将资源模块转换为js代码。   //<code>css-loader</code>:将css代码转换成js模块</li>
<li>文件操作类：将资源模块拷贝到输出目录，向外到处文件的访问路径   //<code>file-loader</code></li>
<li>代码检查类：对资源模块进行校验   //<code>eslint-loader</code></li>
</ul>
<h2 id="plugin"><a href="#plugin" class="headerlink" title="plugin"></a>plugin</h2><ul>
<li>增强webpack自动化能力，实现大多前端工程化 //清除dist目录插件、拷贝不需要参与打包的静态资源文件到输出目录、压缩输出代码等</li>
<li>拥有更宽的能力范围，通过钩子机制实现</li>
<li>必须是一个函数或者包含<code>apply</code>方法的对象,通过在生命周期的钩子中挂载函数实现扩展</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//自定义插件</span><br><span class="line">class MyPlugin&#123;</span><br><span class="line"></span><br><span class="line"> //webpack启动时自动调用</span><br><span class="line"> apply(compiler)&#123;</span><br><span class="line">  compiler.hooks.emit.tap(&apos;MyPlugin&apos;,compilation=&gt;&#123;</span><br><span class="line">    //compilation  //打包上下文</span><br><span class="line">	//compilation.assets   //打包的资源文件 (对象)</span><br><span class="line">	//compilation.assets[&apos;文件名&apos;].source()  //资源文件内容</span><br><span class="line">	</span><br><span class="line">	compilation.assets[&apos;文件名&apos;]=&#123;</span><br><span class="line">	 source:()=&gt; 返回更改的文件内容，</span><br><span class="line">	 size:()=&gt;返回文件的大小</span><br><span class="line">	&#125;</span><br><span class="line">  &#125;)</span><br><span class="line"> </span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">const &#123;CleanWebpackPlugin&#125;  from &apos;clean-webpack-plugin&apos; //自动清除输出目录 </span><br><span class="line">const HtmlWebpackPlugin  from &apos;html-webpack-plugin&apos; //自动生成html </span><br><span class="line">const CopyWebpackPlugin  from &apos;copy-webpack-plugin&apos; //拷贝不需要打包静态资源到输出目录</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plugins:[ </span><br><span class="line">new CleanWebpackPlugin(),</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//index.html</span><br><span class="line">new HtmlWebpackPlugin(</span><br><span class="line">&#123;</span><br><span class="line">  title:&apos;diamonds&apos;,   //设置生成html的title属性</span><br><span class="line">  meta:&#123;</span><br><span class="line">   viewport:&apos;width=device-width&apos;</span><br><span class="line">  &#125;，</span><br><span class="line">  template:&apos;./src/index.html&apos;   //html使用的模板</span><br><span class="line">&#125;),</span><br><span class="line"></span><br><span class="line">//about.html</span><br><span class="line">new HtmlWebpackPlugin(</span><br><span class="line">&#123;</span><br><span class="line">  filename:&apos;about.html&apos;  //输出的文件名  默认是index.html</span><br><span class="line">&#125;),</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//生产阶段使用</span><br><span class="line">new CopyWebpackPlugin([&apos;public&apos;]),  //将public目录下资源拷贝到输出目录</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="mode"><a href="#mode" class="headerlink" title="mode"></a>mode</h2><p>//工作模式  默认production</p>
<ul>
<li>production  //优化打包结果      代码压缩等</li>
<li>development  //优化打包速度，增加辅助函数便于调试</li>
<li>none   //不做处理</li>
</ul>
<h2 id="–watch"><a href="#–watch" class="headerlink" title="–watch"></a>–watch</h2><p> //监听  自动编译</p>
<h2 id="browser-sync"><a href="#browser-sync" class="headerlink" title="browser-sync"></a>browser-sync</h2><p>//实现浏览器自动刷新</p>
<p><code>browser-sync 文件目录  --files  &#39;**/*&#39;</code>   //启动并监听文件改变</p>
<h2 id="webapck-dev-server"><a href="#webapck-dev-server" class="headerlink" title="webapck-dev-server"></a>webapck-dev-server</h2><p>//集成自动编译、自动刷新功能</p>
<h2 id="devServer"><a href="#devServer" class="headerlink" title="devServer"></a>devServer</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//webpack-dev-server 配置选项</span><br><span class="line">devServer:&#123;</span><br><span class="line">  contentBase:&apos;&apos; , //额外为开发服务器指定查找资源目录</span><br><span class="line">  //代理服务配置</span><br><span class="line">  proxy:&#123;</span><br><span class="line">    //前缀</span><br><span class="line">    &apos;/api&apos;:&#123;</span><br><span class="line">	   //代理请求目标  http://localhost:8080/api/users -&gt; https://api.github.com/api/users</span><br><span class="line">	  target:&apos;https://api.github.com&apos;,</span><br><span class="line">	  //路径重写</span><br><span class="line">	  pathRewrite:&#123;</span><br><span class="line">	  &apos;^/api&apos;:&apos;&apos;   // https://api.github.com/users</span><br><span class="line">	  &#125;,</span><br><span class="line">	  //改变请求源</span><br><span class="line">	  changeOrigin:true</span><br><span class="line">	&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="devtool"><a href="#devtool" class="headerlink" title="devtool"></a>devtool</h2><p>(build初次构建速度、rebuild监视模式重新打包速度、production是否适合在生产环境中使用、quality质量)     </p>
<ul>
<li><code>source-map</code></li>
<li><code>eval</code>  //通过<code>sourceURL</code>描述对应模块文件的资源路径   不生成对应的<code>sourceMap</code>,只能定位到错误出现的具体文件  构建速度快</li>
<li><code>cheap-eveal-source-map</code>   阉割版  生成的<code>sourceMap</code>只能定位到错误具体行，没有列的信息</li>
<li><code>cheap-module-eveal-source-map</code>   解析出来的源代码没有经过对应的loader加工，与手写时候的代码一样  一般开发环境使用多</li>
<li><code>inline-source-map</code> 通过<code>DataURL</code>方式将<code>sourceMap</code>嵌入到代码当中，<code>eval-source-map</code>也是</li>
<li><code>hidden-source-map</code> 代码当中没有通过注释方式引入<code>sourceMap</code></li>
<li><code>nosources-source-map</code> 能看到错误出现行列信息，但看不到源代码   生产环境不会暴露源代码</li>
<li><code>none</code>  推荐生产环境使用</li>
</ul>
<h2 id="HMR-热更新"><a href="#HMR-热更新" class="headerlink" title="HMR  热更新"></a><code>HMR</code>  热更新</h2><ul>
<li>应用运行过程中实时替换某个模块，应用运行状态不受影响</li>
<li>不刷新页面情况下，及时更新模块</li>
<li>提高开发效率</li>
<li>集成在<code>webpack-dev-server</code> 中  </li>
<li>使用方式：<code>webpack-dev-server --hot</code>  或 </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">style-loader自动处理样式文件的热更新  js模块热更新需要手动处理</span><br><span class="line">const webpack=require(&apos;webpack&apos;)</span><br><span class="line">devServer:&#123;</span><br><span class="line">  hot:true  //热替换失败，自动刷新浏览器      hotOnly取消浏览器自动刷新</span><br><span class="line">&#125;,</span><br><span class="line">plugins:[</span><br><span class="line">  //module.hot</span><br><span class="line">  new webpack.HotModuleReplacementPlugin()</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">------------------</span><br><span class="line"></span><br><span class="line">注册模块更新后的处理函数</span><br><span class="line">//打包后代码会被自动移除，不会影响生产环境</span><br><span class="line">if(module.hot)&#123;</span><br><span class="line">module.hot.accept(&apos;模块路径&apos;,()=&gt;&#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="webpack-config-js"><a href="#webpack-config-js" class="headerlink" title="webpack.config.js"></a>webpack.config.js</h2><p><code>webpack --env production</code>  //生产模式打包<br><code>webpack --config webpack.prod.js</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">module.exports=(env,argv)=&gt;&#123;&#125;</span><br><span class="line">if(env===&apos;production&apos;)&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">------------------</span><br><span class="line"></span><br><span class="line">const merge=require(&apos;webpack-merge&apos;)//合并webpack配置文件</span><br></pre></td></tr></table></figure>
<h2 id="definePlugin"><a href="#definePlugin" class="headerlink" title="definePlugin"></a>definePlugin</h2><ul>
<li>为代码注入全局成员</li>
<li><code>production</code>模式下默认启动，并注入<code>process.env.NODE_ENV</code>变量</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">const webpack =reuqire(&apos;webpack&apos;)</span><br><span class="line"></span><br><span class="line">plugins:[</span><br><span class="line"></span><br><span class="line">//注入全局变量</span><br><span class="line"> new webpack.DefinePlugin(&#123;</span><br><span class="line">    API_BASE_URL:&apos;&quot;&quot;&apos; //代码片段  可以通过JSON.stringify()传递变量</span><br><span class="line"> &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="tree-shaking-基于ES-Modules"><a href="#tree-shaking-基于ES-Modules" class="headerlink" title="tree-shaking  (基于ES Modules)"></a>tree-shaking  (基于ES Modules)</h2><ul>
<li>移除为引用代码</li>
<li>生产模式下自动开启</li>
<li>由Webpack打包的代码必须使用ESM</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//优化选项</span><br><span class="line">optimization:&#123;</span><br><span class="line">  usedExports:true,   //只导出外部使用过的成员</span><br><span class="line">  minimize:true, //代码压缩</span><br><span class="line">  concatenateModules:true  // `ScopeHoisting`作用域提升）   尽可能将所有模块合并在一起，提高运行效率，减少代码体积 </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="babel-loader-与-tree-shaking"><a href="#babel-loader-与-tree-shaking" class="headerlink" title="babel-loader 与 tree-shaking"></a>babel-loader 与 tree-shaking</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">module:[</span><br><span class="line">  &#123;</span><br><span class="line">  test:/\.js$/,</span><br><span class="line">  use:&#123;</span><br><span class="line">    loader:&apos;babel-loader&apos;,</span><br><span class="line">	options:&#123;</span><br><span class="line">	 presets:[[&apos;@babel/preset-env&apos;],&#123;</span><br><span class="line">	  modules:&apos;commonjs&apos;   //默认是auto 根据环境判断是否开启ES Module插件</span><br><span class="line">	 &#125;]  //</span><br><span class="line">	&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="sideEffects"><a href="#sideEffects" class="headerlink" title="sideEffects"></a>sideEffects</h2><p>//副作用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">optimization:&#123;</span><br><span class="line">   //production模式下会自动开启  为tree-shaking提供更大的压缩空间   （使用前应确保代码真的没有副作用。 副作用：模块执行时除了导出成员外所做的其它的事情	）</span><br><span class="line">  sideEffects:true//   webpack会先检查当前项目的package.json当中是否有sideEffects字段 ,  sideEffects:false表示没有副作用，也可是数组 sideEffects:[&apos;*.css&apos;]  表示有副作用的模块</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="code-splitting"><a href="#code-splitting" class="headerlink" title="code splitting"></a>code splitting</h2><p>//代码分割 按需加载</p>
<ul>
<li>多入口打包</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">entry:&#123;</span><br><span class="line">   index:&apos;&apos;,</span><br><span class="line">   main:&apos;&apos;</span><br><span class="line">&#125;,</span><br><span class="line">output:&#123;</span><br><span class="line">  //动态生成</span><br><span class="line">   filename:&apos;[name].bundle.js&apos;</span><br><span class="line">&#125;,</span><br><span class="line">plugins:[</span><br><span class="line"></span><br><span class="line">    //默认生成自动注入所有打包结果的html，可以通过chunks属性为生成的html指定所需要的bundle</span><br><span class="line">   new HtmlWebpackPlugin(&#123;</span><br><span class="line">     title:&apos;&apos;,</span><br><span class="line">	 template:&apos;./src/index.html&apos;,</span><br><span class="line">	 filename:&apos;index.html&apos;,</span><br><span class="line">	 chunks:[&apos;index&apos;] </span><br><span class="line">   &#125;),</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">     title:&apos;&apos;,</span><br><span class="line">	 template:&apos;./src/main.html&apos;,</span><br><span class="line">	 filename:&apos;main.html&apos;,</span><br><span class="line">	 chunks:[&apos;main&apos;] </span><br><span class="line">   &#125;),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<ul>
<li>ES Module 动态导入   </li>
</ul>
<p>//模块会被自动分包  可以通过魔法注释为生成的bundle文件设置名字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import (/* webpackChunkName:&apos;&apos; */ &apos;&apos;).then((&#123;default:module&#125;)=&gt;&#123;&#125;)   //相同的chunkName会被打包到一起</span><br></pre></td></tr></table></figure>
<ul>
<li>提取公共模块<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">optimization:&#123;</span><br><span class="line">  splitChunks:&#123;</span><br><span class="line">    chunks:&apos;all&apos;  // 会将所有的公共模块提取到单独的bundle当中</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="mini-css-extract-plugin"><a href="#mini-css-extract-plugin" class="headerlink" title="mini-css-extract-plugin"></a>mini-css-extract-plugin</h2><p>//（css文件超过150kb时可以考虑单独提取）  样式会单独存放在文件当中，不在需要style标签引入（style-loader）,通过link标签方式注入样式文件  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">module:&#123;</span><br><span class="line">   rules:[</span><br><span class="line">   &#123;</span><br><span class="line">   test:/\.css$/,</span><br><span class="line">   use:[</span><br><span class="line">   MiniCssExtractPlugin.loader,  //通过link标签引入样式文件</span><br><span class="line">   &apos;css-loader&apos;</span><br><span class="line">   ] </span><br><span class="line">   &#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="optimize-css-assets-webpack-plugin"><a href="#optimize-css-assets-webpack-plugin" class="headerlink" title="optimize-css-assets-webpack-plugin"></a>optimize-css-assets-webpack-plugin</h2><p> //压缩css文件   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">optimization:&#123;         </span><br><span class="line">  //webpack默认压缩js代码</span><br><span class="line">  //production模式自动开启</span><br><span class="line">  //自动压缩插件</span><br><span class="line">  minimizer:[</span><br><span class="line">   new OptimizeCssAssetsWebpackPlugin()</span><br><span class="line">   new TerserWebpackPlugin()   //压缩js代码</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="输出文件名-Hash"><a href="#输出文件名-Hash" class="headerlink" title="输出文件名 Hash"></a>输出文件名 Hash</h2><ul>
<li>filename:’[name]-[hash].bundle.css’  //项目任一文件发生改变，hash值都会改变</li>
<li>filename:’[name]-[chunkhash].bundle.css’  //chunk级别</li>
<li>filename:’[name]-[contenthash:8].bundle.css’  //单个文件级别</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/学习/">学习</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/学习/">学习</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/网站/">网站</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/资源/">资源</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-project" class="article article-type-post" itemscope="" itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/01/10/project/" class="article-date">
      <time datetime="2021-01-09T16:00:00.000Z" itemprop="datePublished">2021-01-10</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/01/10/project/">前端工程</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h5 id="谈谈你对工程化的初步认识，结合你之前遇到过的问题说出三个以上工程化能够解决问题或者带来的价值。"><a href="#谈谈你对工程化的初步认识，结合你之前遇到过的问题说出三个以上工程化能够解决问题或者带来的价值。" class="headerlink" title="谈谈你对工程化的初步认识，结合你之前遇到过的问题说出三个以上工程化能够解决问题或者带来的价值。"></a>谈谈你对工程化的初步认识，结合你之前遇到过的问题说出三个以上工程化能够解决问题或者带来的价值。</h5><p>答案：工程化是根据业务特点，将前端开发流程规范化，标准化，它包括了开发流程，技术选型，代码规范，构建发布等，用于提升前端工程师的开发效率和代码质量。</p>
<ol>
<li>制定各项规范，编码规范，开发流程规范，前后端接口规范等等</li>
<li>使用版本控制工具 git，commit描述规范</li>
<li>使用合适前端技术和框架，提高生产效率，降低维护难度，采用模块化，组件化，数据分离等</li>
<li>代码可测试，单元测试，端到端测试等</li>
<li>开发部署自动化</li>
</ol>
<h5 id="你认为脚手架除了为我们创建项目结构，还有什么更深的意义？"><a href="#你认为脚手架除了为我们创建项目结构，还有什么更深的意义？" class="headerlink" title="你认为脚手架除了为我们创建项目结构，还有什么更深的意义？"></a>你认为脚手架除了为我们创建项目结构，还有什么更深的意义？</h5><ul>
<li>减少重复性的工作，不需要复制其他项目再删除无关代码，或者从零创建一个项目和文件。</li>
<li>可以根据交互动态生成项目结构和配置文件。</li>
<li>多人协作更为方便，不需要把文件传来传去。</li>
</ul>
<h5 id="概述脚手架实现的过程，并使用-NodeJS-完成一个自定义的小型脚手架工具。"><a href="#概述脚手架实现的过程，并使用-NodeJS-完成一个自定义的小型脚手架工具。" class="headerlink" title="概述脚手架实现的过程，并使用 NodeJS 完成一个自定义的小型脚手架工具。"></a>概述脚手架实现的过程，并使用 NodeJS 完成一个自定义的小型脚手架工具。</h5><p>说明：实现了创建不同主题的，选择不同内容的静态应用</p>
<ul>
<li><p>首先创建目录 初始化 yarn init 创建出 package.json</p>
</li>
<li><p>在package.json中 输入 bin入口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  //...</span><br><span class="line">  &quot;bin&quot;: &quot;lib.js&quot;,</span><br><span class="line">  //...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在根目录创建 lib.js文件 添加bin 入口标识</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env node</span><br><span class="line"></span><br><span class="line">//...</span><br></pre></td></tr></table></figure>
</li>
<li><p>引入inquirer 模块 创建用户与命令行交互的工具 编写所需问题及字段</p>
</li>
<li><p>创建模板目录templates 将项目文件导入到目录中</p>
</li>
<li><p>引入ejs模块 结合所需功能问题变量 改写 templates 下项目文件 达到所需功能</p>
</li>
<li><p>在inquirer回调中 结合nodejs 读写功能 和ejs 模块将问题变量 重写到项目中</p>
</li>
<li><p>然后发布到npm上</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//cli.js 参考</span></span><br><span class="line"><span class="meta">#!/usr/bin/env node</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> inquirer = <span class="built_in">require</span>(<span class="string">'inquirer'</span>)</span><br><span class="line"><span class="keyword">const</span> ejs = <span class="built_in">require</span>(<span class="string">'ejs'</span>)</span><br><span class="line"></span><br><span class="line">inquirer.prompt([</span><br><span class="line">  &#123;</span><br><span class="line">    type: <span class="string">'input'</span>,</span><br><span class="line">    name: <span class="string">'name'</span>,</span><br><span class="line">    message: <span class="string">'Project name?'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    type: <span class="string">'list'</span>,</span><br><span class="line">    name: <span class="string">'theme'</span>,</span><br><span class="line">    message: <span class="string">'Select the theme color'</span>,</span><br><span class="line">    choices: [<span class="string">'Dark'</span>, <span class="string">'Light'</span>],</span><br><span class="line">    filter: <span class="function"><span class="keyword">function</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> val.toLowerCase();</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    type: <span class="string">'checkbox'</span>,</span><br><span class="line">    message: <span class="string">'Select what to include'</span>,</span><br><span class="line">    name: <span class="string">'content'</span>,</span><br><span class="line">    choices: [</span><br><span class="line">      &#123;</span><br><span class="line">        name: <span class="string">'Header'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        name: <span class="string">'Body'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        name: <span class="string">'Footer'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    validate: <span class="function"><span class="keyword">function</span> (<span class="params">answer</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (answer.length &lt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'You must choose at least one content.'</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">])</span><br><span class="line">.then(<span class="function"><span class="params">anwsers</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> tmplDir = path.join(__dirname, <span class="string">'templates'</span>)</span><br><span class="line">  <span class="keyword">const</span> destDir = process.cwd()</span><br><span class="line"></span><br><span class="line">  fs.readdir(tmplDir, (err, files) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">    files.forEach(<span class="function"><span class="params">file</span> =&gt;</span> &#123;</span><br><span class="line">      ejs.renderFile(path.join(tmplDir, file), anwsers, (err, result) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line"></span><br><span class="line">        fs.writeFileSync(path.join(destDir, file), result)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h5 id="尝试使用-Gulp-完成项目的自动化构建"><a href="#尝试使用-Gulp-完成项目的自动化构建" class="headerlink" title="尝试使用 Gulp 完成项目的自动化构建"></a>尝试使用 Gulp 完成项目的自动化构建</h5><p>​查找 gulp 插件：<a href="https://gulpjs.com/plugins/" target="_blank" rel="noopener">https://gulpjs.com/plugins/</a></p>
<ul>
<li><p>根据项目结构分析得出前端静态应用</p>
</li>
<li><p>亮点： <strong>stylelint</strong> <strong>eslint</strong> <strong>postcss</strong> <strong>autoprefixer</strong> 实现 <strong>–fix</strong></p>
</li>
<li><p>根据README 结合 package.json 得知gulp 需要实现的命令 如下：</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">yarn lint</span><br><span class="line">yarn compile</span><br><span class="line">yarn serve</span><br><span class="line">yarn build</span><br><span class="line">yarn start</span><br><span class="line">yarn deploy</span><br><span class="line">yarn clean</span><br><span class="line">//并能实现一下 扩展参数命令</span><br><span class="line">yarn serve --port 5210 --open</span><br></pre></td></tr></table></figure>
<ul>
<li><p>根据具体实现功能分布拆解 主要原理建立通道 分步处理</p>
<p>clean： <strong>del</strong></p>
<p>compile：拆分为 <strong>style</strong> <strong>script</strong> <strong>page</strong> 同时执行</p>
<p>style：在处理sass的基础上 引入gulp-postcss 处理 autoprefixer, 后期可扩展更多postcss功能</p>
<p>script: 处理js 引入 gulp-babel 并 @babel/preset-env 来处理 es6+ 功能</p>
<p>page: 查看html文件为swig 文件，并且layouts,partials 文件夹下的为非入口文件 所以在src 添加ignore 排除这两个目录下的文件 在进行处理</p>
<p>serve：拆分为 <strong>compile</strong> <strong>devServe</strong> 首先生成 temp内容 然后开启开发服务器 监听变化 显示变化</p>
<p>devServe：将生成在 temp 目录下的文件 首先用<strong>watch</strong> 监听文件变化css js html 进行实时监听，实时编译。 <strong>browserSync</strong> 开启静态服务 未查询到的文件 可通过 路由处理 及 文件来源查找进行处理</p>
<p>build：拆分为<strong>clean</strong> 及重新打包 （先 <strong>compile</strong> 后 <strong>useref</strong> ）在打包静态资源类 <strong>image</strong>，<strong>font</strong>，<strong>extra</strong></p>
<p>useref： 在temp下 根据 html 注释 解析文件 将资源文件css 和 js 打包 根据引用资源 在 压缩js css html 生成在 dist 目录下</p>
<p>image，font：经过 imagemin 压缩处理 生成在dist目录下</p>
<p>extra：直接拷贝到dist目录下</p>
<p>start：拆分为<strong>build </strong>及 <strong>prodServe</strong> 处理</p>
<p>prodServe： 将生成的 dist 目录下的文件 通过 <strong>browserSync</strong> 开启静态服务器</p>
<p>deploy：拆分为 <strong>build</strong> 及 <strong>publish</strong> 处理</p>
<p>publish：将 生成的 dist 目录下的文件 通过gulp-gh-pages 插件 进行处理 发布到 gh-pages分支下</p>
<p>lint： 拆分为 <strong>stylesLint</strong> 及 <strong>scriptLint</strong> 处理 又添加了 gulp lint –fix 添加修复功能</p>
<p>styleLint： 通过gulp-postcss 结合相应 <strong>stylelint</strong> 插件 在根目录下.stylelintrc.json 文件引入 stylelint-config-sass-guidelines 对sass 文件进行文件 lint</p>
<p>scriptLint： 通过<strong>gulp-eslint</strong> 在根目录下.eslintrc.js 引入 eslint-config-airbnb-base 进行 强校验 保证代码质量</p>
</li>
<li><p>–production –port 5020 –open –fix 等 可通过 process.argv 获取 查询到 minimist 可进行相应处理 处理结果 可以直接拿到</p>
</li>
<li><p>–production 判断是否存在 存在可生成 js，css sourcemaps 文件</p>
</li>
<li><p>项目配置化，变量统一化， 可读取pages.config.js文件 可填写相应配置项 及 data数据</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//gulpfile.js 仅做参考</span></span><br><span class="line"><span class="keyword">const</span> &#123;</span><br><span class="line">  src, dest, parallel, series, watch,</span><br><span class="line">&#125; = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> del = <span class="built_in">require</span>(<span class="string">'del'</span>);</span><br><span class="line"><span class="keyword">const</span> browserSync = <span class="built_in">require</span>(<span class="string">'browser-sync'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> loadPlugins = <span class="built_in">require</span>(<span class="string">'gulp-load-plugins'</span>);</span><br><span class="line"><span class="keyword">const</span> autoprefixer = <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>);</span><br><span class="line"><span class="keyword">const</span> stylelint = <span class="built_in">require</span>(<span class="string">'stylelint'</span>);</span><br><span class="line"><span class="keyword">const</span> scss = <span class="built_in">require</span>(<span class="string">'postcss-scss'</span>);</span><br><span class="line"><span class="keyword">const</span> reporter = <span class="built_in">require</span>(<span class="string">'postcss-reporter'</span>);</span><br><span class="line"><span class="keyword">const</span> minimist = <span class="built_in">require</span>(<span class="string">'minimist'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> plugins = loadPlugins();</span><br><span class="line"><span class="keyword">const</span> bs = browserSync.create();</span><br><span class="line"><span class="keyword">const</span> cwd = process.cwd();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> args = minimist(process.argv.slice(<span class="number">2</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> isProd = process.env.NODE_ENV ? process.env.NODE_ENV === <span class="string">'production'</span> : args.production || args.prod || <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bsInit = &#123;</span><br><span class="line">  notify: <span class="literal">false</span>,</span><br><span class="line">  port: args.port || <span class="number">2080</span>,</span><br><span class="line">  open: args.open || <span class="literal">false</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> config = &#123;</span><br><span class="line">  build: &#123;</span><br><span class="line">    src: <span class="string">'src'</span>,</span><br><span class="line">    dist: <span class="string">'dist'</span>,</span><br><span class="line">    temp: <span class="string">'temp'</span>,</span><br><span class="line">    public: <span class="string">'public'</span>,</span><br><span class="line">    paths: &#123;</span><br><span class="line">      styles: <span class="string">'assets/styles/**/*.scss'</span>,</span><br><span class="line">      scripts: <span class="string">'assets/scripts/**/*.js'</span>,</span><br><span class="line">      pages: <span class="string">'**/*.html'</span>,</span><br><span class="line">      images: <span class="string">'assets/images/**/*.&#123;jpg,jpeg,png,gif,svg&#125;'</span>,</span><br><span class="line">      fonts: <span class="string">'assets/fonts/**/*.&#123;eot,svg,ttf,woff,woff2&#125;'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> loadConfig = <span class="built_in">require</span>(<span class="string">`<span class="subst">$&#123;cwd&#125;</span>/pages.config.js`</span>);</span><br><span class="line">  config = &#123; ...config, ...loadConfig &#125;;</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> clean = <span class="function"><span class="params">()</span> =&gt;</span> del([config.build.dist, config.build.temp]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> style = <span class="function"><span class="params">()</span> =&gt;</span> src(config.build.paths.styles, &#123; <span class="attr">base</span>: config.build.src, <span class="attr">cwd</span>: config.build.src, <span class="attr">sourcemaps</span>: !isProd &#125;)</span><br><span class="line">  .pipe(plugins.sass(&#123; <span class="attr">outputStyle</span>: <span class="string">'expanded'</span> &#125;))</span><br><span class="line">  .pipe(plugins.postcss([</span><br><span class="line">    autoprefixer(),</span><br><span class="line">  ]))</span><br><span class="line">  .pipe(dest(config.build.temp, &#123; <span class="attr">sourcemaps</span>: <span class="string">'.'</span> &#125;))</span><br><span class="line">  .pipe(bs.reload(&#123; <span class="attr">stream</span>: <span class="literal">true</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> stylesLint = <span class="function"><span class="params">()</span> =&gt;</span> src(config.build.paths.styles, &#123; <span class="attr">base</span>: config.build.src, <span class="attr">cwd</span>: config.build.src &#125;)</span><br><span class="line">  .pipe(plugins.postcss([</span><br><span class="line">    stylelint(&#123; <span class="attr">fix</span>: args.fix &#125;),</span><br><span class="line">    reporter(),</span><br><span class="line">  ], &#123; <span class="attr">syntax</span>: scss &#125;));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> script = <span class="function"><span class="params">()</span> =&gt;</span> src(config.build.paths.scripts, &#123;</span><br><span class="line">  base: config.build.src, <span class="attr">cwd</span>: config.build.src, <span class="attr">sourcemaps</span>: !isProd,</span><br><span class="line">&#125;)</span><br><span class="line">  .pipe(plugins.babel(&#123; <span class="attr">presets</span>: [<span class="built_in">require</span>(<span class="string">'@babel/preset-env'</span>)] &#125;))</span><br><span class="line">  .pipe(dest(config.build.temp, &#123; <span class="attr">sourcemaps</span>: <span class="string">'.'</span> &#125;))</span><br><span class="line">  .pipe(bs.reload(&#123; <span class="attr">stream</span>: <span class="literal">true</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> scriptsLint = <span class="function"><span class="params">()</span> =&gt;</span> src(config.build.paths.scripts, &#123;</span><br><span class="line">  base: config.build.src, <span class="attr">cwd</span>: config.build.src,</span><br><span class="line">&#125;)</span><br><span class="line">  .pipe(plugins.eslint(&#123; <span class="attr">fix</span>: args.fix &#125;))</span><br><span class="line">  .pipe(plugins.eslint.format())</span><br><span class="line">  .pipe(plugins.eslint.failAfterError());</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> page = <span class="function"><span class="params">()</span> =&gt;</span> src(config.build.paths.pages, &#123;</span><br><span class="line">  base: config.build.src, <span class="attr">cwd</span>: config.build.src, <span class="attr">ignore</span>: [<span class="string">'&#123;layouts,partials&#125;/**'</span>],</span><br><span class="line">&#125;)</span><br><span class="line">  .pipe(plugins.swig(&#123; <span class="attr">data</span>: config.data, <span class="attr">defaults</span>: &#123; <span class="attr">cache</span>: <span class="literal">false</span> &#125; &#125;))</span><br><span class="line">  .pipe(dest(config.build.temp))</span><br><span class="line">  .pipe(bs.reload(&#123; <span class="attr">stream</span>: <span class="literal">true</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> image = <span class="function"><span class="params">()</span> =&gt;</span> src(config.build.paths.images, &#123;</span><br><span class="line">  base: config.build.src, <span class="attr">cwd</span>: config.build.src,</span><br><span class="line">&#125;)</span><br><span class="line">  .pipe(plugins.imagemin())</span><br><span class="line">  .pipe(dest(config.build.dist));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> font = <span class="function"><span class="params">()</span> =&gt;</span> src(config.build.paths.fonts, &#123; <span class="attr">base</span>: config.build.src, <span class="attr">cwd</span>: config.build.src &#125;)</span><br><span class="line">  .pipe(plugins.imagemin())</span><br><span class="line">  .pipe(dest(config.build.dist));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> extra = <span class="function"><span class="params">()</span> =&gt;</span> src(<span class="string">'**'</span>, &#123; <span class="attr">base</span>: config.build.public, <span class="attr">cwd</span>: config.build.public &#125;)</span><br><span class="line">  .pipe(dest(config.build.dist));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> devServe = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  watch(config.build.paths.styles, &#123; <span class="attr">cwd</span>: config.build.src &#125;, style);</span><br><span class="line">  watch(config.build.paths.scripts, &#123; <span class="attr">cwd</span>: config.build.src &#125;, script);</span><br><span class="line">  watch(config.build.paths.pages, &#123; <span class="attr">cwd</span>: config.build.src &#125;, page);</span><br><span class="line"></span><br><span class="line">  watch([</span><br><span class="line">    config.build.paths.images,</span><br><span class="line">    config.build.paths.fonts,</span><br><span class="line">  ], &#123; <span class="attr">cwd</span>: config.build.src &#125;, bs.reload);</span><br><span class="line"></span><br><span class="line">  watch(<span class="string">'**'</span>, &#123; <span class="attr">cwd</span>: config.build.public &#125;, bs.reload);</span><br><span class="line"></span><br><span class="line">  bs.init(&#123;</span><br><span class="line">    ...bsInit,</span><br><span class="line">    server: &#123;</span><br><span class="line">      baseDir: [config.build.temp, config.build.dist, config.build.public, config.build.src],</span><br><span class="line">      routes: &#123;</span><br><span class="line">        <span class="string">'/node_modules'</span>: <span class="string">'node_modules'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> prodServe = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  bs.init(&#123;</span><br><span class="line">    ...bsInit,</span><br><span class="line">    server: &#123;</span><br><span class="line">      baseDir: config.build.dist,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useref = <span class="function"><span class="params">()</span> =&gt;</span> src(</span><br><span class="line">  config.build.paths.pages,</span><br><span class="line">  &#123; <span class="attr">base</span>: config.build.temp, <span class="attr">cwd</span>: config.build.temp &#125;,</span><br><span class="line">)</span><br><span class="line">  .pipe(plugins.useref(&#123; <span class="attr">searchPath</span>: [config.build.temp, <span class="string">'.'</span>, <span class="string">'..'</span>] &#125;))</span><br><span class="line">  <span class="comment">// html js css</span></span><br><span class="line">  .pipe(plugins.if(<span class="regexp">/\.js$/</span>, plugins.uglify()))</span><br><span class="line">  .pipe(plugins.if(<span class="regexp">/\.css$/</span>, plugins.cleanCss()))</span><br><span class="line">  .pipe(plugins.if(<span class="regexp">/\.html$/</span>, plugins.htmlmin(&#123;</span><br><span class="line">    collapseWhitespace: <span class="literal">true</span>,</span><br><span class="line">    minifyCSS: <span class="literal">true</span>,</span><br><span class="line">    minifyJS: <span class="literal">true</span>,</span><br><span class="line">  &#125;)))</span><br><span class="line">  .pipe(dest(config.build.dist));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> publish = <span class="function"><span class="params">()</span> =&gt;</span> src(<span class="string">'**'</span>, &#123; <span class="attr">base</span>: config.build.dist, <span class="attr">cwd</span>: config.build.dist &#125;)</span><br><span class="line">  <span class="comment">// .pipe(plugins.gzip())</span></span><br><span class="line">  .pipe(plugins.ghPages());</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> lint = parallel(stylesLint, scriptsLint);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> compile = parallel(style, script, page);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 上线之前执行的任务</span></span><br><span class="line"><span class="keyword">const</span> build = series(</span><br><span class="line">  clean,</span><br><span class="line">  parallel(</span><br><span class="line">    series(compile, useref),</span><br><span class="line">    image,</span><br><span class="line">    font,</span><br><span class="line">    extra,</span><br><span class="line">  ),</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> serve = series(compile, devServe);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> start = series(build, prodServe);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> deploy = series(build, publish);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  clean,</span><br><span class="line">  lint,</span><br><span class="line">  compile,</span><br><span class="line">  serve,</span><br><span class="line">  build,</span><br><span class="line">  start,</span><br><span class="line">  deploy,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="使用-Grunt-完成项目的自动化构建"><a href="#使用-Grunt-完成项目的自动化构建" class="headerlink" title="使用 Grunt 完成项目的自动化构建"></a>使用 Grunt 完成项目的自动化构建</h5><p>说明：</p>
<p>​    查找 grunt 插件：<a href="https://www.gruntjs.net/plugins" target="_blank" rel="noopener">https://www.gruntjs.net/plugins</a></p>
<ul>
<li><p>思路大体跟gulp一致 首先查找对应功能的插件 根据插件文档 编写插件信息</p>
</li>
<li><p>根据grunt文件管理 可以拆分 cwd src dest ext 等 精确控制</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  expand: true,</span><br><span class="line">  cwd: config.build.src,</span><br><span class="line">  src: [config.build.paths.styles],</span><br><span class="line">  dest: config.build.temp,</span><br><span class="line">  ext: &apos;.css&apos;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>grunt-usemin 代替 gulp-useref</p>
</li>
<li><p>grunt-browser-sync grunt-contrib-copy</p>
</li>
<li><p>watch 用到插件为 grunt-contrib-watch gulp则是本身功能</p>
</li>
<li><p>copy 用到插件为grunt-contrib-copy gulp则是本身功能</p>
</li>
<li><p>del 可使用 del.sync 同步执行</p>
</li>
<li><p>处理 swig 用到 grunt-html-template 插件</p>
</li>
</ul>
<p>​<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//gruntfile.js 参考配置</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> sass = <span class="built_in">require</span>(<span class="string">'sass'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> del = <span class="built_in">require</span>(<span class="string">'del'</span>);</span><br><span class="line"><span class="keyword">const</span> browserSync = <span class="built_in">require</span>(<span class="string">'browser-sync'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> loadGruntTasks = <span class="built_in">require</span>(<span class="string">'load-grunt-tasks'</span>);</span><br><span class="line"><span class="keyword">const</span> autoprefixer = <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>);</span><br><span class="line"><span class="keyword">const</span> stylelint = <span class="built_in">require</span>(<span class="string">'stylelint'</span>);</span><br><span class="line"><span class="keyword">const</span> scss = <span class="built_in">require</span>(<span class="string">'postcss-scss'</span>);</span><br><span class="line"><span class="keyword">const</span> reporter = <span class="built_in">require</span>(<span class="string">'postcss-reporter'</span>);</span><br><span class="line"><span class="keyword">const</span> minimist = <span class="built_in">require</span>(<span class="string">'minimist'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bs = browserSync.create();</span><br><span class="line"><span class="keyword">const</span> cwd = process.cwd();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> args = minimist(process.argv.slice(<span class="number">2</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> isProd = process.env.NODE_ENV ? process.env.NODE_ENV === <span class="string">'production'</span> : args.production || args.prod || <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bsInit = &#123;</span><br><span class="line">  notify: <span class="literal">false</span>,</span><br><span class="line">  port: args.port || <span class="number">2080</span>,</span><br><span class="line">  open: args.open || <span class="literal">false</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> config = &#123;</span><br><span class="line">  build: &#123;</span><br><span class="line">    src: <span class="string">'src'</span>,</span><br><span class="line">    dist: <span class="string">'dist'</span>,</span><br><span class="line">    temp: <span class="string">'temp'</span>,</span><br><span class="line">    public: <span class="string">'public'</span>,</span><br><span class="line">    paths: &#123;</span><br><span class="line">      styles: <span class="string">'assets/styles/**/*.scss'</span>,</span><br><span class="line">      scripts: <span class="string">'assets/scripts/**/*.js'</span>,</span><br><span class="line">      pages: <span class="string">'**/*.html'</span>,</span><br><span class="line">      images: <span class="string">'assets/images/**/*.&#123;jpg,jpeg,png,gif,svg&#125;'</span>,</span><br><span class="line">      fonts: <span class="string">'assets/fonts/**/*.&#123;eot,svg,ttf,woff,woff2&#125;'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> loadConfig = <span class="built_in">require</span>(<span class="string">`<span class="subst">$&#123;cwd&#125;</span>/pages.config.js`</span>);</span><br><span class="line">  config = &#123; ...config, ...loadConfig &#125;;</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">grunt</span>) =&gt;</span> &#123;</span><br><span class="line">  grunt.initConfig(&#123;</span><br><span class="line">    sass: &#123;</span><br><span class="line">      options: &#123;</span><br><span class="line">        sourceMap: !isProd,</span><br><span class="line">        implementation: sass,</span><br><span class="line">        outputStyle: <span class="string">'expanded'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      main: &#123;</span><br><span class="line">        expand: <span class="literal">true</span>,</span><br><span class="line">        cwd: config.build.src,</span><br><span class="line">        src: [config.build.paths.styles],</span><br><span class="line">        dest: config.build.temp,</span><br><span class="line">        ext: <span class="string">'.css'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    postcss: &#123;</span><br><span class="line">      main: &#123;</span><br><span class="line">        options: &#123;</span><br><span class="line">          processors: [</span><br><span class="line">            autoprefixer(),</span><br><span class="line">          ],</span><br><span class="line">        &#125;,</span><br><span class="line">        expand: <span class="literal">true</span>,</span><br><span class="line">        cwd: config.build.temp,</span><br><span class="line">        src: [<span class="string">'assets/styles/**/*.css'</span>],</span><br><span class="line">        dest: config.build.temp,</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      lint: &#123;</span><br><span class="line">        options: &#123;</span><br><span class="line">          processors: [</span><br><span class="line">            stylelint(&#123; <span class="attr">fix</span>: args.fix &#125;),</span><br><span class="line">            reporter(),</span><br><span class="line">          ],</span><br><span class="line">        &#125;,</span><br><span class="line">        src: <span class="string">`<span class="subst">$&#123;path.join(config.build.src, config.build.paths.styles)&#125;</span>`</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    eslint: &#123;</span><br><span class="line">      options: &#123;</span><br><span class="line">        fix: args.fix,</span><br><span class="line">      &#125;,</span><br><span class="line">      main: <span class="string">`<span class="subst">$&#123;path.join(config.build.src, config.build.paths.scripts)&#125;</span>`</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    babel: &#123;</span><br><span class="line">      options: &#123;</span><br><span class="line">        sourceMap: !isProd,</span><br><span class="line">        presets: [<span class="string">'@babel/preset-env'</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">      main: &#123;</span><br><span class="line">        expand: <span class="literal">true</span>,</span><br><span class="line">        cwd: config.build.src,</span><br><span class="line">        src: [config.build.paths.scripts],</span><br><span class="line">        dest: config.build.temp,</span><br><span class="line">        ext: <span class="string">'.js'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    html_template: &#123;</span><br><span class="line">      options: &#123;</span><br><span class="line">        cache: <span class="literal">false</span>,</span><br><span class="line">        locals: config.data,</span><br><span class="line">      &#125;,</span><br><span class="line">      main: &#123;</span><br><span class="line">        expand: <span class="literal">true</span>,</span><br><span class="line">        cwd: config.build.src,</span><br><span class="line">        src: [config.build.paths.pages, <span class="string">'!layouts/**'</span>, <span class="string">'!partials/**'</span>],</span><br><span class="line">        dest: config.build.temp,</span><br><span class="line">        ext: <span class="string">'.html'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    imagemin: &#123;</span><br><span class="line">      image: &#123;</span><br><span class="line">        expand: <span class="literal">true</span>,</span><br><span class="line">        cwd: config.build.src,</span><br><span class="line">        src: [config.build.paths.images],</span><br><span class="line">        dest: config.build.dist,</span><br><span class="line">      &#125;,</span><br><span class="line">      font: &#123;</span><br><span class="line">        expand: <span class="literal">true</span>,</span><br><span class="line">        cwd: config.build.src,</span><br><span class="line">        src: [config.build.paths.fonts],</span><br><span class="line">        dest: config.build.dist,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    copy: &#123;</span><br><span class="line">      main: &#123;</span><br><span class="line">        expand: <span class="literal">true</span>,</span><br><span class="line">        cwd: config.build.public,</span><br><span class="line">        src: [<span class="string">'**'</span>],</span><br><span class="line">        dest: config.build.dist,</span><br><span class="line">      &#125;,</span><br><span class="line">      html: &#123;</span><br><span class="line">        expand: <span class="literal">true</span>,</span><br><span class="line">        cwd: config.build.temp,</span><br><span class="line">        src: [config.build.paths.pages],</span><br><span class="line">        dest: config.build.dist,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    useminPrepare: &#123;</span><br><span class="line">      main: &#123;</span><br><span class="line">        expand: <span class="literal">true</span>,</span><br><span class="line">        cwd: config.build.temp,</span><br><span class="line">        src: [config.build.paths.pages],</span><br><span class="line">      &#125;,</span><br><span class="line">      options: &#123;</span><br><span class="line">        dest: config.build.dist,</span><br><span class="line">        root: [config.build.temp, <span class="string">'.'</span>, <span class="string">'..'</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    usemin: &#123;</span><br><span class="line">      main: &#123;</span><br><span class="line">        expand: <span class="literal">true</span>,</span><br><span class="line">        cwd: config.build.dist,</span><br><span class="line">        src: [config.build.paths.pages],</span><br><span class="line">      &#125;,</span><br><span class="line">      options: &#123;</span><br><span class="line"></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'gh-pages'</span>: &#123;</span><br><span class="line">      options: &#123;</span><br><span class="line">        base: config.build.dist,</span><br><span class="line">        branch: <span class="string">'gh-pages-grunt'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      main: [<span class="string">'**'</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">    watch: &#123;</span><br><span class="line">      script: &#123;</span><br><span class="line">        files: [<span class="string">`<span class="subst">$&#123;path.join(config.build.src, config.build.paths.scripts)&#125;</span>`</span>],</span><br><span class="line">        tasks: [<span class="string">'babel'</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">      style: &#123;</span><br><span class="line">        files: [<span class="string">`<span class="subst">$&#123;path.join(config.build.src, config.build.paths.styles)&#125;</span>`</span>],</span><br><span class="line">        tasks: [<span class="string">'style'</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">      page: &#123;</span><br><span class="line">        files: [<span class="string">`<span class="subst">$&#123;path.join(config.build.src, config.build.paths.pages)&#125;</span>`</span>],</span><br><span class="line">        tasks: [<span class="string">'html_template'</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    browserSync: &#123;</span><br><span class="line">      dev: &#123;</span><br><span class="line">        bsFiles: &#123;</span><br><span class="line">          src: [</span><br><span class="line">            config.build.temp,</span><br><span class="line">            config.build.dist,</span><br><span class="line">          ],</span><br><span class="line">        &#125;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          ...bsInit,</span><br><span class="line">          watchTask: <span class="literal">true</span>,</span><br><span class="line">          server: &#123;</span><br><span class="line">            baseDir: [config.build.temp, config.build.dist, config.build.public, config.build.src],</span><br><span class="line">            routes: &#123;</span><br><span class="line">              <span class="string">'/node_modules'</span>: <span class="string">'node_modules'</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      prod: &#123;</span><br><span class="line">        bsFiles: &#123;</span><br><span class="line">          src: config.build.dist,</span><br><span class="line">        &#125;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          ...bsInit,</span><br><span class="line">          server: &#123;</span><br><span class="line">            baseDir: config.build.dist,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  loadGruntTasks(grunt);</span><br><span class="line"></span><br><span class="line">  grunt.registerTask(<span class="string">'reload'</span>, () =&gt; &#123;</span><br><span class="line">    bs.reload();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  grunt.registerTask(<span class="string">'stylesLint'</span>, []);</span><br><span class="line"></span><br><span class="line">  grunt.registerTask(<span class="string">'scriptsLint'</span>, []);</span><br><span class="line"></span><br><span class="line">  grunt.registerTask(<span class="string">'clean'</span>, () =&gt; &#123;</span><br><span class="line">    del.sync([config.build.dist, config.build.temp, <span class="string">'.tmp'</span>]);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  grunt.registerTask(<span class="string">'style'</span>, [<span class="string">'sass'</span>, <span class="string">'postcss:main'</span>]);</span><br><span class="line"></span><br><span class="line">  grunt.registerTask(<span class="string">'compile'</span>, [<span class="string">'style'</span>, <span class="string">'babel'</span>, <span class="string">'html_template'</span>]);</span><br><span class="line"></span><br><span class="line">  grunt.registerTask(<span class="string">'build'</span>, [</span><br><span class="line">    <span class="string">'clean'</span>,</span><br><span class="line">    <span class="string">'compile'</span>,</span><br><span class="line">    <span class="string">'copy'</span>,</span><br><span class="line">    <span class="string">'useminPrepare'</span>,</span><br><span class="line">    <span class="string">'concat:generated'</span>,</span><br><span class="line">    <span class="string">'cssmin:generated'</span>,</span><br><span class="line">    <span class="string">'uglify:generated'</span>,</span><br><span class="line">    <span class="string">'usemin'</span>,</span><br><span class="line">    <span class="string">'imagemin'</span>,</span><br><span class="line">  ]);</span><br><span class="line"></span><br><span class="line">  grunt.registerTask(<span class="string">'serve'</span>, [<span class="string">'compile'</span>, <span class="string">'browserSync:dev'</span>, <span class="string">'watch'</span>]);</span><br><span class="line"></span><br><span class="line">  grunt.registerTask(<span class="string">'start'</span>, [<span class="string">'build'</span>, <span class="string">'browserSync:prod'</span>]);</span><br><span class="line"></span><br><span class="line">  grunt.registerTask(<span class="string">'deploy'</span>, [<span class="string">'build'</span>, <span class="string">'gh-pages'</span>]);</span><br><span class="line"></span><br><span class="line">  grunt.registerTask(<span class="string">'lint'</span>, [<span class="string">'postcss:lint'</span>, <span class="string">'eslint'</span>]);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/前端/">前端</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-study" class="article article-type-post" itemscope="" itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/01/10/study/" class="article-date">
      <time datetime="2021-01-09T16:00:00.000Z" itemprop="datePublished">2021-01-10</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/01/10/study/">前端学习</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>2021-1-10</p>
</blockquote>
<h3 id="如何理解-JS-异步编程，EventLoop、消息队列都是做什么的，什么是宏任务，什么是微任务？"><a href="#如何理解-JS-异步编程，EventLoop、消息队列都是做什么的，什么是宏任务，什么是微任务？" class="headerlink" title="如何理解 JS 异步编程，EventLoop、消息队列都是做什么的，什么是宏任务，什么是微任务？"></a>如何理解 JS 异步编程，EventLoop、消息队列都是做什么的，什么是宏任务，什么是微任务？</h3><ul>
<li><p>JS 异步编程</p>
<p>JavaScript 语言的执行环境是单线程的，一次只能执行一个任务，多任务需要排队等候，这种模式可能会阻塞代码，导致代码执行效率低下。为了避免这个问题，出现了异步编程。一般是通过 callback 回调函数、事件发布/订阅、Promise 等来组织代码，本质都是通过回调函数来实现异步代码的存放与执行。</p>
</li>
<li><p>EventLoop 事件环和消息队列</p>
<p><strong>EventLoop</strong> 是一种循环机制 ，不断去轮询一些队列 ，从中找到 需要执行的任务并按顺序执行的一个执行模型。</p>
<p><strong>消息队列</strong> 是用来存放宏任务的队列， 比如定时器时间到了， 定时间内传入的方法引用会存到该队列， ajax回调之后的执行方法也会存到该队列。</p>
</li>
</ul>
<p>  一开始整个脚本作为一个宏任务执行。执行过程中同步代码直接执行，宏任务等待时间到达或者成功后，将方法的回调放入宏任务队列中，微任务进入微任务队列。</p>
<p>  当前主线程的宏任务执行完出队，检查并清空微任务队列。接着执行浏览器 UI 线程的渲染工作，检查web worker 任务，有则执行。</p>
<p>  然后再取出一个宏任务执行。以此循环…</p>
<ul>
<li><p>宏任务与微任务</p>
<p><strong>宏任务</strong>可以理解为每次执行栈执行的代码就是一个宏任务（包括每次从事件队列中获取一个事件回调并放到执行栈中执行）。</p>
<p>浏览器为了让 JS 内部宏任务 与 DOM 操作能够有序的执行，会在一个宏任务执行结束后，在下一个宏任务执行开始前，对页面进行重新渲染。</p>
<p>宏任务包含：script(整体代码)、setTimeout、setInterval、I/O、UI交互事件、MessageChannel 等</p>
</li>
</ul>
<p>  <strong>微任务</strong>可以理解是在当前任务执行结束后需要立即执行的任务。也就是说，在当前任务后，在渲染之前，执行清空微任务。</p>
<p>  所以它的响应速度相比宏任务会更快，因为无需等待 UI 渲染。</p>
<p>  微任务包含：Promise.then、MutaionObserver、process.nextTick(Node.js 环境)等</p>
<h3 id="基于以下代码完成下面的四个练习"><a href="#基于以下代码完成下面的四个练习" class="headerlink" title="基于以下代码完成下面的四个练习"></a>基于以下代码完成下面的四个练习</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">const fp = require(&apos;lodash/fp&apos;)</span><br><span class="line">// 数据：horsepower 马力，dollar_value 价格，in_stock 库存</span><br><span class="line">const cars = [</span><br><span class="line">    &#123; name: &apos;Ferrari FF&apos;, horsepower: 660, dollar_value: 700000, in_stock: true &#125;,</span><br><span class="line">    &#123; name: &apos;Spyker C12 Zagato&apos;, horsepower: 650, dollar_value: 648000, in_stock: false &#125;,</span><br><span class="line">    &#123; name: &apos;Jaguar XKR-S&apos;, horsepower: 550, dollar_value: 132000, in_stock: false &#125;,</span><br><span class="line">    &#123; name: &apos;Audi R8&apos;, horsepower: 525, dollar_value: 114200, in_stock: false &#125;,</span><br><span class="line">    &#123; name: &apos;Aston Martin One-77&apos;, horsepower: 750, dollar_value: 1850000, in_stock: true &#125;,</span><br><span class="line">    &#123; name: &apos;Pagani Huayra&apos;, horsepower: 700, dollar_value: 1300000, in_stock: false &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h4 id="使用组合函数-fp-flowRight-重新实现下面这个函数"><a href="#使用组合函数-fp-flowRight-重新实现下面这个函数" class="headerlink" title="使用组合函数 fp.flowRight() 重新实现下面这个函数"></a>使用组合函数 fp.flowRight() 重新实现下面这个函数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">let isLastInStock = function(cars)&#123;</span><br><span class="line">    // 获取最后一条数据</span><br><span class="line">    let last_car = fp.last(cars)</span><br><span class="line">    // 获取最后一条数据的 in_stock 属性值</span><br><span class="line">    return fp.prop(&apos;in_stock&apos;, last_car)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>先定义获取最后一条数据的函数，再定义获取某个对象中的 in_stock 属性的函数，再用 fp.flowRight 组合函数</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let isLastInStock = fp.flowRight(fp.prop(&apos;in_stock&apos;), fp.last);</span><br><span class="line">console.log(isLastInStock(cars)); // false</span><br></pre></td></tr></table></figure>
<h4 id="使用-fp-flowRight-、fp-prop-和-fp-first-获取第一个-car-的-name"><a href="#使用-fp-flowRight-、fp-prop-和-fp-first-获取第一个-car-的-name" class="headerlink" title="使用 fp.flowRight()、fp.prop() 和 fp.first() 获取第一个 car 的 name"></a>使用 fp.flowRight()、fp.prop() 和 fp.first() 获取第一个 car 的 name</h4><blockquote>
<p>先定义获取第一条数据的函数，再定义获取某个对象中的 name 属性的函数，再用 fp.flowRight 组合函数</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const getFirstName = fp.flowRight(fp.prop(&quot;name&quot;), fp.first)</span><br><span class="line">console.log(getFirstName(cars)) // Ferrari FF</span><br></pre></td></tr></table></figure>
<h4 id="使用帮助函数-average-重构-averageDollarValue，使用函数组合的方式实现"><a href="#使用帮助函数-average-重构-averageDollarValue，使用函数组合的方式实现" class="headerlink" title="使用帮助函数 _average 重构 averageDollarValue，使用函数组合的方式实现"></a>使用帮助函数 _average 重构 averageDollarValue，使用函数组合的方式实现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">let _average = function(xs)&#123;</span><br><span class="line">    return fp.reduce(fp.add, 0, xs) / xs.length</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>先定义获取某个对象中的 dollar_value 属性的函数，将该函数作为 fp.map 的数组元素处理函数，再用 fp.flowRight 组合函数</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let averageDollarValue = fp.flowRight(_average, fp.map(&apos;dollar_value&apos;));</span><br><span class="line">console.log(averageDollarValue(cars));  //790700</span><br></pre></td></tr></table></figure>
<h4 id="使用-flowRight-写一个-sanitizeNames-函数，返回一个下划线连续的小写字符串，把数组中的-name-转换为这种形式，例如：sanitizeNames-“Hello-World”-gt-“hello-world”"><a href="#使用-flowRight-写一个-sanitizeNames-函数，返回一个下划线连续的小写字符串，把数组中的-name-转换为这种形式，例如：sanitizeNames-“Hello-World”-gt-“hello-world”" class="headerlink" title="使用 flowRight 写一个 sanitizeNames() 函数，返回一个下划线连续的小写字符串，把数组中的 name 转换为这种形式，例如：sanitizeNames([“Hello World”]) =&gt; [“hello_world”]"></a>使用 flowRight 写一个 sanitizeNames() 函数，返回一个下划线连续的小写字符串，把数组中的 name 转换为这种形式，例如：sanitizeNames([“Hello World”]) =&gt; [“hello_world”]</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let _underscore = fp.replace(/\W+/g, &apos;_&apos;) // 无须改动，并在 sanitizeNames 中使用它</span><br></pre></td></tr></table></figure>
<blockquote>
<p>先定义获取某个对象中的 name 属性的函数，再定义转化为小写的函数，再将空格和下划线替换，,再用 fp.flowRight 组合函数</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">let sanitizeNames = fp.flowRight(</span><br><span class="line">  fp.map(_underscore),</span><br><span class="line">  fp.map(fp.toLower),</span><br><span class="line">  fp.map((car) =&gt; car.name)</span><br><span class="line">);</span><br><span class="line">console.log(sanitizeNames(CARS)) </span><br><span class="line">// [</span><br><span class="line">//  &apos;ferrari_ff&apos;,       </span><br><span class="line">//  &apos;spyker_c12_zagato&apos;,</span><br><span class="line">//  &apos;jaguar_xkr_s&apos;,</span><br><span class="line">//  &apos;audi_r8&apos;,</span><br><span class="line">//  &apos;aston_martin_one_77&apos;,</span><br><span class="line">//  &apos;pagani_huayra&apos;</span><br><span class="line">// ]</span><br></pre></td></tr></table></figure>
<h3 id="基于下面提供的代码，完成后续的四个练习"><a href="#基于下面提供的代码，完成后续的四个练习" class="headerlink" title="基于下面提供的代码，完成后续的四个练习"></a>基于下面提供的代码，完成后续的四个练习</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// support.js</span><br><span class="line">class Container &#123;</span><br><span class="line">    static of(value)&#123;</span><br><span class="line">        return new Container(value)</span><br><span class="line">    &#125;</span><br><span class="line">    constructor(value)&#123;</span><br><span class="line">        this._value = value</span><br><span class="line">    &#125;</span><br><span class="line">    map(fn)&#123;</span><br><span class="line">        return Container.of(fn(this._value))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Maybe &#123;</span><br><span class="line">    static of(x)&#123;</span><br><span class="line">        return new Maybe(x)</span><br><span class="line">    &#125;</span><br><span class="line">    isNothing()&#123;</span><br><span class="line">        return this._value === null || this._value === undefined</span><br><span class="line">    &#125;</span><br><span class="line">    constructor(x)&#123;</span><br><span class="line">        this._value = x</span><br><span class="line">    &#125;</span><br><span class="line">    map(fn)&#123;</span><br><span class="line">        return this.isNothing() ? this : Maybe.of(fn(this._value))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">module.exports = &#123; Maybe, Container &#125;</span><br></pre></td></tr></table></figure>
<h4 id="使用-fp-add-x-y-和-fp-map-f-x-创建一个能让-functor-里的值增加的函数-ex1"><a href="#使用-fp-add-x-y-和-fp-map-f-x-创建一个能让-functor-里的值增加的函数-ex1" class="headerlink" title="使用 fp.add(x, y) 和 fp.map(f,x) 创建一个能让 functor 里的值增加的函数 ex1"></a>使用 fp.add(x, y) 和 fp.map(f,x) 创建一个能让 functor 里的值增加的函数 ex1</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const fp = require(&apos;lodash/fp&apos;)</span><br><span class="line">const &#123;Maybe, Container&#125; = require(&apos;./support&apos;)</span><br><span class="line">let maybe = Maybe.of([5,6,1])</span><br><span class="line">let ex1 = () =&gt; &#123;</span><br><span class="line">    // 你需要实现的函数。。。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>函子对象的 map 方法可以运行一个函数对值进行处理，函数的参数为传入 of 方法的参数；接着对传入的整个数组进行遍历，并对每一项执行 fp.add 方法</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let ex1 = maybe.map(i =&gt; fp.map(fp.add(1), i))</span><br><span class="line">console.log(ex1) // [6, 7, 2]</span><br></pre></td></tr></table></figure>
<h4 id="实现一个函数-ex2，能够使用-fp-first-获取列表的第一个元素"><a href="#实现一个函数-ex2，能够使用-fp-first-获取列表的第一个元素" class="headerlink" title="实现一个函数 ex2，能够使用 fp.first 获取列表的第一个元素"></a>实现一个函数 ex2，能够使用 fp.first 获取列表的第一个元素</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const fp = require(&apos;lodash/fp&apos;)</span><br><span class="line">const &#123;Maybe, Container&#125; = require(&apos;./support&apos;)</span><br><span class="line">let xs = Container.of([&apos;do&apos;, &apos;ray&apos;, &apos;me&apos;, &apos;fa&apos;, &apos;so&apos;, &apos;la&apos;, &apos;ti&apos;, &apos;do&apos;])</span><br><span class="line">let ex2 = () =&gt; &#123;</span><br><span class="line">    // 你需要实现的函数。。。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>解答如下：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let ex2 = xs.map(i =&gt; fp.first(i))</span><br><span class="line">console.log(ex2)// do</span><br></pre></td></tr></table></figure>
<h4 id="实现一个函数-ex3，使用-safeProp-和-fp-first-找到-user-的名字的首字母"><a href="#实现一个函数-ex3，使用-safeProp-和-fp-first-找到-user-的名字的首字母" class="headerlink" title="实现一个函数 ex3，使用 safeProp 和 fp.first 找到 user 的名字的首字母"></a>实现一个函数 ex3，使用 safeProp 和 fp.first 找到 user 的名字的首字母</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const fp = require(&apos;lodash/fp&apos;)</span><br><span class="line">const &#123;Maybe, Container&#125; = require(&apos;./support&apos;)</span><br><span class="line">let safeProp = fp.curry(function(x, o)&#123;</span><br><span class="line">    return Maybe.of(o[x])</span><br><span class="line">&#125;)</span><br><span class="line">let user = &#123; id: 2, name: &apos;Albert&apos; &#125;</span><br><span class="line">let ex3 = () =&gt; &#123;</span><br><span class="line">    // 你需要实现的函数。。。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>调用 ex3 函数传入 user 对象，safeProp 是经过柯里化处理的，可以先传“属性”参数，后传“对象”参数。safeProp 函数处理后返回 user 的值，再调用fp.first 获取首字母</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">let ex3 = fp.flowRight(fp.map(i =&gt; fp.first(i)), safeProp(&apos;name&apos;))</span><br><span class="line">console.log(ex3(user)) // A</span><br><span class="line">// 或者 return safeProp(&quot;name&quot;, user).map(x =&gt; fp.first(x));</span><br></pre></td></tr></table></figure>
<h4 id="使用-Maybe-重写-ex4，不要有-if-语句"><a href="#使用-Maybe-重写-ex4，不要有-if-语句" class="headerlink" title="使用 Maybe 重写 ex4，不要有 if 语句"></a>使用 Maybe 重写 ex4，不要有 if 语句</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const fp = require(&apos;lodash/fp&apos;)</span><br><span class="line">const &#123;Maybe, Container&#125; = require(&apos;./support&apos;)</span><br><span class="line">let ex4 = function(n)&#123;</span><br><span class="line">    if(n)&#123;</span><br><span class="line">        return parseInt(n)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>MayBe 函子用来处理外部的空值情况，防止空值的异常，拿到函子的值之后进行 parseInt 转化</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let ex4 = n =&gt; Maybe.of(n).map(parseInt)</span><br><span class="line">console.log(ex4(&apos;1&apos;)) // 1</span><br></pre></td></tr></table></figure>
<h3 id="手写实现-MyPromise-源码"><a href="#手写实现-MyPromise-源码" class="headerlink" title="手写实现 MyPromise 源码"></a>手写实现 MyPromise 源码</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 初始状态</span></span><br><span class="line"><span class="keyword">const</span> PENDING = <span class="string">"pending"</span>;</span><br><span class="line"><span class="comment">// 完成状态</span></span><br><span class="line"><span class="keyword">const</span> FULFILLED = <span class="string">"fulfilled"</span>;</span><br><span class="line"><span class="comment">// 失败状态</span></span><br><span class="line"><span class="keyword">const</span> REJECTED = <span class="string">"rejected"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步执行方法封装</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asyncExecFun</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> fn(), <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行promise resolve功能</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolvePromise</span>(<span class="params">promise, res, resolve, reject</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 返回同一个promise</span></span><br><span class="line">  <span class="keyword">if</span> (promise === res) &#123;</span><br><span class="line">    reject(<span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Chaining cycle detected for promise #&lt;MyPromise&gt;"</span>));</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// promise结果</span></span><br><span class="line">  <span class="keyword">if</span> (res <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">    res.then(resolve, reject);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 非promise结果</span></span><br><span class="line">    resolve(res);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. 是个构造函数</span></span><br><span class="line"><span class="comment"> * 2. 传入一个可执行函数 函数的入参第一个为 fullFill函数 第二个为 reject函数；  函数立即执行，  参数函数异步执行</span></span><br><span class="line"><span class="comment"> * 3. 状态一旦更改就不可以变更  只能 pending =&gt; fulfilled 或者  pending =&gt; rejected</span></span><br><span class="line"><span class="comment"> * 4. then 的时候要处理入参的情况 successCallback 和failCallback 均可能为非函数</span></span><br><span class="line"><span class="comment"> *      默认的 failCallback 一定要将异常抛出， 这样下一个promise便可将其捕获 异常冒泡的目的</span></span><br><span class="line"><span class="comment"> * 5. then 中执行回调的时候要捕获异常 将其传给下一个promise</span></span><br><span class="line"><span class="comment"> *    如果promise状态未变更 则将回调方法添加到对应队列中</span></span><br><span class="line"><span class="comment"> *    如果promise状态已经变更 需要异步处理成功或者失败回调</span></span><br><span class="line"><span class="comment"> *    因为可能出现 回调结果和当前then返回的Promise一致 从而导致死循环问题</span></span><br><span class="line"><span class="comment"> * 6. catch只是then的一种特殊的写法 方便理解和使用</span></span><br><span class="line"><span class="comment"> * 7. finally 特点 1. 不过resolve或者reject都会执行</span></span><br><span class="line"><span class="comment"> *                2. 回调没有参数</span></span><br><span class="line"><span class="comment"> *                3. 返回一个Promise 且值可以穿透到下一个then或者catch</span></span><br><span class="line"><span class="comment"> * 8. Promise.resolve, Promise.reject 根据其参数返回对应的值 或者状态的Promise即可</span></span><br><span class="line"><span class="comment"> * 9. Proise.all 特点  1. 返回一个Promise</span></span><br><span class="line"><span class="comment"> *                    2. 入参是数组 resolve的情况下出参也是数组 且结果顺序和调用顺序一致</span></span><br><span class="line"><span class="comment"> *                    3. 所有的值或者promise都完成才能resolve 所有要计数</span></span><br><span class="line"><span class="comment"> *                    4. 只要有一个为reject 返回的Promise便reject</span></span><br><span class="line"><span class="comment"> * 10. Proise.race 特点 1. 返回一个Promise</span></span><br><span class="line"><span class="comment"> *                    2. 入参是数组 那么出参根据第一个成功或者失败的参数来确定</span></span><br><span class="line"><span class="comment"> *                    3. 只要有一个resolve 或者reject 便更改返回Promise的状态</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPromise</span> </span>&#123;</span><br><span class="line">  status = PENDING;</span><br><span class="line">  value = <span class="literal">undefined</span>;</span><br><span class="line">  reason = <span class="literal">undefined</span>;</span><br><span class="line">  successCallbacks = [];</span><br><span class="line">  failCallbacks = [];</span><br><span class="line">  <span class="keyword">constructor</span>(exector) &#123;</span><br><span class="line">    <span class="comment">// 立即执行传入参数</span></span><br><span class="line">    <span class="comment">// 参数直接写为 this.resolve  会导致函数内 this指向会发生改变</span></span><br><span class="line">    <span class="comment">// 异步执行状态变更</span></span><br><span class="line">    <span class="comment">// 捕获执行器的异常</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        exector(</span><br><span class="line">          (value) =&gt; asyncExecFun(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.resolve(value)),</span><br><span class="line">          (reason) =&gt; asyncExecFun(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.reject(reason))</span><br><span class="line">        );</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="keyword">this</span>.reject(e)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  resolve(value) &#123;</span><br><span class="line">    <span class="comment">// 如果状态已经变更则直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.status !== PENDING) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">this</span>.value = value;</span><br><span class="line">    <span class="keyword">this</span>.status = FULFILLED;</span><br><span class="line">    <span class="comment">// 执行所有成功回调</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">this</span>.successCallbacks.length) <span class="keyword">this</span>.successCallbacks.shift()();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  reject(reason) &#123;</span><br><span class="line">    <span class="comment">// 如果状态已经变更则直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.status !== PENDING) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">this</span>.reason = reason;</span><br><span class="line">    <span class="keyword">this</span>.status = REJECTED;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">this</span>.failCallbacks.length)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">'(in MyPromise)'</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 执行所有失败回调</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">this</span>.failCallbacks.length) <span class="keyword">this</span>.failCallbacks.shift()();</span><br><span class="line">  &#125;</span><br><span class="line">  then(successCallback, failCallback) &#123;</span><br><span class="line">    <span class="comment">// 成功函数处理 忽略函数之外的其他值</span></span><br><span class="line">    successCallback =</span><br><span class="line">      <span class="keyword">typeof</span> successCallback == <span class="string">"function"</span> ? successCallback : <span class="function">(<span class="params">v</span>) =&gt;</span> v;</span><br><span class="line">    <span class="comment">// 失败函数处理 忽略函数之外的其他值 抛出异常  实现catch冒泡的关键</span></span><br><span class="line">    failCallback =</span><br><span class="line">      <span class="keyword">typeof</span> failCallback == <span class="string">"function"</span></span><br><span class="line">        ? failCallback</span><br><span class="line">        : <span class="function">(<span class="params">reason</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> reason;</span><br><span class="line">          &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> promise = <span class="keyword">new</span> MyPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 统一异常处理逻辑</span></span><br><span class="line">      <span class="keyword">const</span> execFun = <span class="function">(<span class="params">fn, val</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">let</span> res = fn(val);</span><br><span class="line">          resolvePromise(promise, res, resolve, reject);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          reject(e);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">// 执行成功回调</span></span><br><span class="line">      <span class="keyword">const</span> execSuccessCallback = <span class="function"><span class="params">()</span> =&gt;</span> execFun(successCallback, <span class="keyword">this</span>.value);</span><br><span class="line">      <span class="comment">// 执行失败回调</span></span><br><span class="line">      <span class="keyword">const</span> execFailCallback = <span class="function"><span class="params">()</span> =&gt;</span> execFun(failCallback, <span class="keyword">this</span>.reason);</span><br><span class="line">      <span class="comment">// 同步将对应成功或者失败回调事件加入对应回调队列</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.status === PENDING) &#123;</span><br><span class="line">        <span class="comment">// 将成功回调加入队列</span></span><br><span class="line">        <span class="keyword">this</span>.successCallbacks.push(execSuccessCallback);</span><br><span class="line">        <span class="comment">// 讲失败回调加入队列</span></span><br><span class="line">        <span class="keyword">this</span>.failCallbacks.push(execFailCallback);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 延迟执行 可以将函数执行结果和当前then 返回的promise 进行比较</span></span><br><span class="line">      asyncExecFun(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 如果已经 fulfilled 可直接调用成功回调方法</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.status === FULFILLED) &#123;</span><br><span class="line">          execSuccessCallback();</span><br><span class="line">          <span class="comment">// 如果已经 rejected 可直接调用失败回调方法</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.status === REJECTED) &#123;</span><br><span class="line">          execFailCallback();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> promise;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">catch</span>(failCallback) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.then(<span class="literal">undefined</span>, failCallback);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">finally</span>(callback) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.then(</span><br><span class="line">      <span class="comment">// 穿透正常值</span></span><br><span class="line">      (value) =&gt; MyPromise.resolve(callback()).then(<span class="function"><span class="params">()</span> =&gt;</span> value),</span><br><span class="line">      (reason) =&gt;</span><br><span class="line">        MyPromise.resolve(callback()).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// 穿透异常信息</span></span><br><span class="line">          <span class="keyword">throw</span> reason;</span><br><span class="line">        &#125;)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> resolve(value) &#123;</span><br><span class="line">    <span class="comment">// 如果是MyPromise 实例 则直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (value <span class="keyword">instanceof</span> MyPromise) <span class="keyword">return</span> value;</span><br><span class="line">    <span class="comment">// 如果是MyPromise 实例 否则返回一个 MyPromise实例</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function">(<span class="params">resolve</span>) =&gt;</span> resolve(value));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> reject(reason) &#123;</span><br><span class="line">    <span class="comment">// 如果是MyPromise 实例 则直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (reason <span class="keyword">instanceof</span> MyPromise) <span class="keyword">return</span> reason;</span><br><span class="line">    <span class="comment">// 如果是MyPromise 实例 否则返回一个 MyPromise实例</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> reject(reason));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// all方法</span></span><br><span class="line">  <span class="keyword">static</span> all(array) &#123;</span><br><span class="line">    <span class="comment">// 存储结果</span></span><br><span class="line">    <span class="keyword">let</span> result = [];</span><br><span class="line">    <span class="comment">// 存储数组长度</span></span><br><span class="line">    <span class="keyword">let</span> len = array.length;</span><br><span class="line">    <span class="comment">// 创建返回MyPromise</span></span><br><span class="line">    <span class="keyword">let</span> promise = <span class="keyword">new</span> MyPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 定义当前MyPromise的索引</span></span><br><span class="line">      <span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line">      <span class="comment">// 添加数据的公用方法</span></span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">addData</span>(<span class="params">key, data</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 赋值</span></span><br><span class="line">        result[key] = data;</span><br><span class="line">        <span class="comment">// 索引递增</span></span><br><span class="line">        index++;</span><br><span class="line">        <span class="comment">// 全部执行完则resolve</span></span><br><span class="line">        <span class="keyword">if</span> (index == len) &#123;</span><br><span class="line">          resolve(result);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 按顺序变量数组</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> curr = array[i];</span><br><span class="line">        <span class="comment">// 如果是MyPromise则 按其规则处理</span></span><br><span class="line">        <span class="keyword">if</span> (curr <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">          curr.then(<span class="function">(<span class="params">value</span>) =&gt;</span> addData(i, value), reject);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 非MyPromise直接赋值</span></span><br><span class="line">          addData(i, curr);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 返回新的MyPromise实例</span></span><br><span class="line">    <span class="keyword">return</span> promise;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 只要有一个成功或者失败就返回</span></span><br><span class="line">  <span class="keyword">static</span> race(array) &#123;</span><br><span class="line">    <span class="keyword">let</span> promise = <span class="keyword">new</span> MyPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> curr = array[i];</span><br><span class="line">        <span class="comment">// MyPromise实例 结果处理</span></span><br><span class="line">        <span class="keyword">if</span> (curr <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">          curr.then(resolve, reject);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 非MyPromise实例处理</span></span><br><span class="line">          resolve(curr);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> promise;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = MyPromise;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/前端/">前端</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/css/">css</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-ts" class="article article-type-post" itemscope="" itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/01/10/ts/" class="article-date">
      <time datetime="2021-01-09T16:00:00.000Z" itemprop="datePublished">2021-01-10</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/01/10/ts/">typescript</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="请说出下列最终的执行结果，并解释为什么。"><a href="#请说出下列最终的执行结果，并解释为什么。" class="headerlink" title="请说出下列最终的执行结果，并解释为什么。"></a>请说出下列最终的执行结果，并解释为什么。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var a = [];</span><br><span class="line">for (var i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">    a[i] = function() &#123;</span><br><span class="line">        console.log(i)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">a[6]()</span><br></pre></td></tr></table></figure>
<p>答：结果是10。因为for循环里的i是全局变量，for循环执行完之后，i已经变成了10，所以之后无论调用a几，输出的都是10。</p>
<hr>
<h2 id="请说出下列最终的执行结果，并解释为什么。-1"><a href="#请说出下列最终的执行结果，并解释为什么。-1" class="headerlink" title="请说出下列最终的执行结果，并解释为什么。"></a>请说出下列最终的执行结果，并解释为什么。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var tmp = 123;</span><br><span class="line">if (true) &#123;</span><br><span class="line">    console.log(tmp)</span><br><span class="line">    let tmp</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>答：结果报错，cannot access ‘tmp’ before initialization<br>     原因：let 会形成块级作用域和封闭作用域，所以 tmp 无法拿到外层 var 声明的值，只能在块级作用域中查找。let 不会导致变量提升，因此<code>console.log(tmp)</code>无法找到声明，出现暂时性死区。</p>
<hr>
<h2 id="结合ES6新语法，用最简单的方法找出数组中的最小值。"><a href="#结合ES6新语法，用最简单的方法找出数组中的最小值。" class="headerlink" title="结合ES6新语法，用最简单的方法找出数组中的最小值。"></a>结合ES6新语法，用最简单的方法找出数组中的最小值。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var arr = [12, 34, 32, 89, 4]</span><br></pre></td></tr></table></figure>
<p>答：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arr.sort((a, b) =&gt; a-b)[0]</span><br><span class="line">arr.reduce((min,num)=&gt;min&lt;num?min:num)</span><br><span class="line">Math.min(...arr)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="请详细说明-var，let，const-三种声明变量方式之间的具体差别。"><a href="#请详细说明-var，let，const-三种声明变量方式之间的具体差别。" class="headerlink" title="请详细说明 var，let，const 三种声明变量方式之间的具体差别。"></a>请详细说明 var，let，const 三种声明变量方式之间的具体差别。</h2><table>
<thead>
<tr>
<th></th>
<th>var</th>
<th>let</th>
<th>const</th>
</tr>
</thead>
<tbody>
<tr>
<td>提升</td>
<td>声明提升，使用undefined初始化</td>
<td>不存在变量提升</td>
<td>不存在变量提升</td>
</tr>
<tr>
<td>作用域</td>
<td>全局</td>
<td>块级</td>
<td>块级</td>
</tr>
<tr>
<td>初始化</td>
<td>可以仅声明不初始化</td>
<td>可以仅声明不初始化</td>
<td>必须在声明时初始化</td>
</tr>
<tr>
<td>重复定义</td>
<td>可以</td>
<td>不可以</td>
<td>不可以</td>
</tr>
<tr>
<td>多次赋值</td>
<td>可以</td>
<td>可以</td>
<td>基本数据类型不可以，引用数据类型仅可改变值</td>
</tr>
<tr>
<td>声明前访问</td>
<td>可以</td>
<td>不可以</td>
<td>不可以</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="请说出下列代码最终输出的结果，并解释为什么。"><a href="#请说出下列代码最终输出的结果，并解释为什么。" class="headerlink" title="请说出下列代码最终输出的结果，并解释为什么。"></a>请说出下列代码最终输出的结果，并解释为什么。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var a = 10;</span><br><span class="line">var obj = &#123;</span><br><span class="line">    a: 20,</span><br><span class="line">    fn () &#123;</span><br><span class="line">        setTimeout(() =&gt; &#123;</span><br><span class="line">            console.log(this.a)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.fn()</span><br></pre></td></tr></table></figure>
<p>答：打印20。因为setTimeout是箭头函数，里面的this指向没有改变和fn函数里的this是一致的都指向obj，所以会输出20</p>
<hr>
<h2 id="简述Symbol类型的用途。"><a href="#简述Symbol类型的用途。" class="headerlink" title="简述Symbol类型的用途。"></a>简述Symbol类型的用途。</h2><p>答：</p>
<ul>
<li>作为对象的属性，可以作为对象的私有属性，</li>
<li>阻止对象上属性名的冲突，每个 Symbol 都独一无二的，可以保证不与其他属性名产生冲突，</li>
<li>使用Symbol来替代常量</li>
</ul>
<hr>
<h2 id="说说什么是浅拷贝，什么是深拷贝。"><a href="#说说什么是浅拷贝，什么是深拷贝。" class="headerlink" title="说说什么是浅拷贝，什么是深拷贝。"></a>说说什么是浅拷贝，什么是深拷贝。</h2><p>答：</p>
<ul>
<li>浅拷贝：针对 Object,Array 这种复杂数据类型，浅拷贝复制一层对象的属性，属性中的值是基本数据类型直接复制值，如果是引用类型复制内存地址的指针，所以在修改复制后的变量里引用类型的里面的值时，会导致原始数据也被修改</li>
<li>深拷贝：针对 Object,Array 这种复杂数据类型，深复制递归复制了所有的层级，新数据和原始数据不存在联系，因此在修改复制后的变量里引用类型的里面的值时，不会导致原始数据也被修改</li>
</ul>
<hr>
<h2 id="简述TypeScript和JavaScript之间的关系。"><a href="#简述TypeScript和JavaScript之间的关系。" class="headerlink" title="简述TypeScript和JavaScript之间的关系。"></a>简述TypeScript和JavaScript之间的关系。</h2><p>答：TypeScript 并不是一个完全新的语言, 它是 JavaScript 的超集，为 JavaScript 的生态增加了类型机制，并最终将代码编译为纯粹的 JavaScript 代码。</p>
<table>
<thead>
<tr>
<th>TypeScript</th>
<th>JavaScript</th>
</tr>
</thead>
<tbody>
<tr>
<td>JavaScript 的超集用于解决大型项目的代码复杂性</td>
<td>一种脚本语言，用于创建动态网页。</td>
</tr>
<tr>
<td>可以在编译期间发现并纠正错误</td>
<td>作为一种解释型语言，只能在运行时发现错误</td>
</tr>
<tr>
<td>强类型，支持静态和动态类型</td>
<td>弱类型，没有静态类型选项</td>
</tr>
<tr>
<td>最终被编译成 JavaScript 代码，使浏览器可以理解</td>
<td>可以直接在浏览器中使用</td>
</tr>
<tr>
<td>支持模块、泛型和接口</td>
<td>不支持模块，泛型或接口</td>
</tr>
<tr>
<td>支持 ES3，ES4，ES5 和 ES6 等</td>
<td>不支持编译其他 ES3，ES4，ES5 或 ES6 功能</td>
</tr>
<tr>
<td>社区的支持仍在增长，而且还不是很大</td>
<td>大量的社区支持以及大量文档和解决问题的支持</td>
</tr>
</tbody>
</table>
<h2 id="请谈谈你所认为的TypeScript优缺点。"><a href="#请谈谈你所认为的TypeScript优缺点。" class="headerlink" title="请谈谈你所认为的TypeScript优缺点。"></a>请谈谈你所认为的TypeScript优缺点。</h2><p>优点：</p>
<ul>
<li>任何一种 javascript 运行环境都支持</li>
<li>功能更为强大，生态更健全、更完善</li>
<li>TypeScript 属于渐进式的</li>
<li>增强代码的可读性和可维护性，增强了编译器和 IDE 的功能，定义可以作为文文档</li>
<li>在编译阶段就可以发现大部分大错误，不需要在运行时才发现</li>
</ul>
<p>缺点：</p>
<ul>
<li>语言本身多了很多概率，提高学习成本</li>
<li>项目初期，TypeScript 增加开发成本</li>
<li>集成到构建流程需要一些工足量</li>
<li>可能和一些库结合不完美，需要单独添加一些声明，不过大部分的库都支持了 TypeScript</li>
</ul>
<h2 id="描述引用计数的工作原理和优缺点。"><a href="#描述引用计数的工作原理和优缺点。" class="headerlink" title="描述引用计数的工作原理和优缺点。"></a>描述引用计数的工作原理和优缺点。</h2><p>工作原理：设置引用数,判断当前引用数是否为 0，引用关系改变时修改引用数字</p>
<p>优点：</p>
<ol>
<li>发现垃圾时立即回收</li>
<li>最大限度减少程序暂停（保证空间不会被占满）</li>
</ol>
<p>缺点：</p>
<ol>
<li>无法回收循环引用的对象</li>
<li>时间开销大（监控对象，维护引用数）</li>
</ol>
<h2 id="描述标记整理算法的工作流程。"><a href="#描述标记整理算法的工作流程。" class="headerlink" title="描述标记整理算法的工作流程。"></a>描述标记整理算法的工作流程。</h2><ol>
<li><p>遍历所有对象找标记活动对象</p>
</li>
<li><p>清除阶段会先执行整理，移动对象位置，将活动对象放在一起</p>
</li>
<li><p>清除没有标记的对象，同时把第一次遍历所做的标记抹掉</p>
</li>
<li><p>把回收的空间放到空闲列表上面，方便后续程序申请空间使用</p>
<p>优点： 减少了内存空间的碎片化，缺点： 不能立即回收对象</p>
</li>
</ol>
<h2 id="描述V8中新生代存储区垃圾回收的流程。"><a href="#描述V8中新生代存储区垃圾回收的流程。" class="headerlink" title="描述V8中新生代存储区垃圾回收的流程。"></a>描述V8中新生代存储区垃圾回收的流程。</h2><ol>
<li>回收过程采用复制算法+标记整理算法</li>
<li>新生代分为 from-to 两个等大空间 32M(32 位为 16M)</li>
<li>使用空间为 from 内存区，空闲空间为 to 内存区，当 from 空间应用一定大小会触发标记整理</li>
<li>当发生标记整理后，复制活动对象到 to 内存区，然后 From 空间进行内存释放。</li>
<li>如果拷贝时出现晋升，将新生代活动对象移入老生代</li>
<li>当 To 空间的使用率达到 25%时，将新生代活动对象移入老生代</li>
<li>当一轮 GC 执行完毕后还存活的新生代测需要晋级</li>
<li>当一次 GC 操作后，From 和 to 需要进行置换</li>
</ol>
<h2 id="描述增量标记算法在何时使用及工作原理。"><a href="#描述增量标记算法在何时使用及工作原理。" class="headerlink" title="描述增量标记算法在何时使用及工作原理。"></a>描述增量标记算法在何时使用及工作原理。</h2><p>答： 使用时机：会穿插在程序的运行中执行。</p>
<p>​工作原理： 对象存在直接可达和间接可达，将遍历对象标记，拆分成多个小步骤，先标记直接可达对象。间接可达的标记与程序执行交替执行，最终完成清除。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/前端/">前端</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-webpack" class="article article-type-post" itemscope="" itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/01/10/webpack/" class="article-date">
      <time datetime="2021-01-09T16:00:00.000Z" itemprop="datePublished">2021-01-10</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/01/10/webpack/">前端构建</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>1、Webpack 的构建流程主要有哪些环节？如果可以请尽可能详尽的描述 Webpack 打包的整个过程。<br>答: webpack是运行在nodejs环境下，配置文件遵循commonjs规范。其配置文件webpack.config.js导出一个object/function/promise/array。 Webpack在启动后，会从entry开始，递归解析entry依赖的所有Module，每找到一个Module，就会根据Module.rules里配置的Loader规则进行相应的转换处理，对Module进行转换后，再解析出当前Module依赖的Module，这些Module会以entry为单位进行分组，即为一个Chunk。因此一个Chunk，就是一个entry及其所有依赖的Module合并的结果。最后Webpack会将所有的Chunk转换成文件输出Output。在整个构建流程中，Webpack会在恰当的时机执行Plugin里定义的逻辑，从而完成Plugin插件的优化任务。其流程如下：</p>
<p>1、配置初始化<br>webpack会首先读取配置文件，执行默认配置</p>
<p>2、编译前准备<br>webpack 会实例化compiler，注册plugins、resolverFactory、hooks。</p>
<p>3、reslove前准备<br>webpack 实例化compilation、NormalModuleFactory和ContextModuleFactory</p>
<p>4、reslove流程<br>解析文件的路径信息以及inline loader和配置的loader合并、排序</p>
<p>5、构建module<br>runLoaders处理源码，得到一个编译后的字符串或buffer。将文件解析为ast，分析module间的依赖关系，递归解析依赖文件</p>
<p>6、生成chunk<br>实例化chunk并生成chunk graph，设置module id，chunk id，hash等</p>
<p>7、资源构建<br>使用不同的template渲染chunk资源</p>
<p>8、文件生成<br>创建目标文件夹及文件并将资源写入，打印构建信息</p>
<p>2、Loader 和 Plugin 有哪些不同？请描述一下开发 Loader 和 Plugin 的思路。<br>答： loader：用于对模块源码的转换，因为webpack本身只支持js处理，loader描述了webpack如何处理非javascript模块，并且在build中引入这些依赖。loader可以将文件从不同css预处理转换为css,将ts转换为JavaScript，或者将内联图像转换为data URL。比如说：sass-loader、css-Loader，style-Loader、file-loader等。</p>
<p>loader开发:就像开发中间件管道，可以首先新建一个导出模块,入参为source，对source进行一系列处理，然后返回js代码（或跟上别的loader）</p>
<p>module.exports = (source)=&gt;{</p>
<pre><code>return result(source)
</code></pre><p>}<br>plugin：plugin通过webpack钩子机制实现，相比于loader,plugin拥有更宽的能力。其目的在于解决loader无法实现的其他事，从打包优化和压缩，到重新定义环境变量，功能强大到可以用来处理各种各样的任务。 plugin开发：plugin被要求必须是一个函数或者是包含apply方法的对象。入参是一个compiler对象，其包含构建所需信息，开发时可以通过compiler中hooks属性访问到emit钩子，并通过其tap方法注册一个钩子函数，定制钩子名称和挂载函数。该函数入参为compilation打包上下文，通过遍历compilation下assets的所有键得到所有文件名称。然后根据 键 的source（）方法拿到对应的content内容，然后对content进行一些处理，并返回给souce函数，以达到我们的插件目的。</p>
<p>webpack.common.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; VueLoaderPlugin &#125; = <span class="built_in">require</span>(<span class="string">'vue-loader'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">'./utils.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">entry:utils.resolve(<span class="string">'./src/main.js'</span>),</span><br><span class="line">output:&#123;</span><br><span class="line">  path:utils.resolve(<span class="string">'./dist'</span>),</span><br><span class="line">  filename:<span class="string">'[name].[hash:6].js'</span></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">  resolve: &#123;</span><br><span class="line">    extensions: [<span class="string">'.js'</span>, <span class="string">'.vue'</span>, <span class="string">'.json'</span>],</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="string">'assets'</span>: utils.resolve(<span class="string">'assets'</span>),</span><br><span class="line">      <span class="string">'pages'</span>: utils.resolve(<span class="string">'src/pages'</span>),</span><br><span class="line">      <span class="string">'public'</span>: utils.resolve(<span class="string">'public'</span>),</span><br><span class="line">      <span class="string">'components'</span>: utils.resolve(<span class="string">'src/components'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(js|vue)$/</span>,</span><br><span class="line">        use: <span class="string">'eslint-loader'</span>,</span><br><span class="line">        enforce: <span class="string">'pre'</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">        title:<span class="string">"my vue"</span>,</span><br><span class="line">      filename: <span class="string">'index.html'</span>,</span><br><span class="line">      template: <span class="string">'src/index.html'</span>,</span><br><span class="line">      inject: <span class="literal">true</span>,</span><br><span class="line">      url:<span class="string">'public/'</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> VueLoaderPlugin()</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>webpack.dev.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">'./webpack.common.js'</span>)</span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">'./utils.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> PORT = <span class="number">8080</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = merge(baseConfig, &#123;</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  devtool: <span class="string">'cheap-module-eval-source-map'</span>,</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    clientLogLevel: <span class="string">'warning'</span>,</span><br><span class="line">    hot: <span class="literal">true</span>,</span><br><span class="line">    port: PORT,</span><br><span class="line">    open: <span class="literal">true</span>,</span><br><span class="line">    contentBase:utils.resolve(<span class="string">'./dist'</span>),</span><br><span class="line">    publicPath:<span class="string">'/'</span>,</span><br><span class="line">    overlay: &#123; <span class="attr">warnings</span>: <span class="literal">false</span>, <span class="attr">errors</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css?$/</span>,</span><br><span class="line">        use: [<span class="string">'vue-style-loader'</span>,<span class="string">'css-loader'</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.styl(us)?$/</span>,</span><br><span class="line">        use: [<span class="string">'vue-style-loader'</span>,<span class="string">'css-loader'</span>, <span class="string">'stylus-loader'</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(js|vue)$/</span>,</span><br><span class="line">        use: <span class="string">'eslint-loader'</span>,</span><br><span class="line">        enforce: <span class="string">'pre'</span></span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        test: <span class="regexp">/\.less?$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">'vue-style-loader'</span>,</span><br><span class="line">          <span class="string">'css-loader'</span>,</span><br><span class="line">          <span class="string">'less-loader'</span></span><br><span class="line">        ]</span><br><span class="line">      &#125; ,&#123;</span><br><span class="line">        test: <span class="regexp">/\.vue$/</span>,</span><br><span class="line">        use: <span class="string">'vue-loader'</span></span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'babel-loader'</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpe?g|gif|svg)(\?.*)?$/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'url-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            limit: <span class="number">10</span>*<span class="number">1024</span>,</span><br><span class="line">            esModule: <span class="literal">false</span>,</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        test: <span class="regexp">/\.(mp4|webm|ogg|mp3|wav|flac|aac)(\?.*)?$/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'url-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            limit: <span class="number">10000</span>,</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        test: <span class="regexp">/\.(woff2?|eot|ttf|otf)(\?.*)?$/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'url-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            limit: <span class="number">10000</span>,</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>webpack.prod.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">'./webpack.common'</span>)</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">'mini-css-extract-plugin'</span>)</span><br><span class="line"><span class="keyword">const</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">'copy-webpack-plugin'</span>)</span><br><span class="line"><span class="keyword">const</span> &#123;CleanWebpackPlugin&#125; = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>)</span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">'./utils.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = merge(baseConfig, &#123;</span><br><span class="line">  mode: <span class="string">'production'</span>,</span><br><span class="line">  devtool: <span class="string">'none'</span>,</span><br><span class="line">  optimization: &#123;</span><br><span class="line">    usedExports:<span class="literal">true</span>,</span><br><span class="line">    minimize:<span class="literal">true</span>,</span><br><span class="line">    splitChunks: &#123;</span><br><span class="line">      cacheGroups: &#123;</span><br><span class="line">        commons: &#123;</span><br><span class="line">          test: <span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">          name: <span class="string">'vendor'</span>,</span><br><span class="line">          chunks: <span class="string">'all'</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css?$/</span>,</span><br><span class="line">        use: [MiniCssExtractPlugin.loader, <span class="string">'css-loader'</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.styl(us)?$/</span>,</span><br><span class="line">        use: [MiniCssExtractPlugin.loader, <span class="string">'css-loader'</span>, <span class="string">'stylus-loader'</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(js|vue)$/</span>,</span><br><span class="line">        use: <span class="string">'eslint-loader'</span>,</span><br><span class="line">        enforce: <span class="string">'pre'</span></span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        test: <span class="regexp">/\.less?$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">'vue-style-loader'</span>,</span><br><span class="line">          <span class="string">'css-loader'</span>,</span><br><span class="line">          <span class="string">'less-loader'</span></span><br><span class="line">        ]</span><br><span class="line">      &#125; ,&#123;</span><br><span class="line">        test: <span class="regexp">/\.vue$/</span>,</span><br><span class="line">        use: <span class="string">'vue-loader'</span></span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">          </span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpe?g|gif|svg)(\?.*)?$/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'url-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            limit: <span class="number">10</span>*<span class="number">1024</span>,</span><br><span class="line">            esModule: <span class="literal">false</span>,</span><br><span class="line">            name: utils.assetsPath(<span class="string">'img/[name].[hash:7].[ext]'</span>)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        test: <span class="regexp">/\.(mp4|webm|ogg|mp3|wav|flac|aac)(\?.*)?$/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'url-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            limit: <span class="number">10000</span>,</span><br><span class="line">            name: utils.assetsPath(<span class="string">'media/[name].[hash:7].[ext]'</span>)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        test: <span class="regexp">/\.(woff2?|eot|ttf|otf)(\?.*)?$/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'url-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            limit: <span class="number">10000</span>,</span><br><span class="line">            name: utils.assetsPath(<span class="string">'fonts/[name].[hash:7].[ext]'</span>)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> CleanWebpackPlugin(),</span><br><span class="line">    <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: <span class="string">'main.css'</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin(&#123;</span><br><span class="line">      patterns: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">from</span>: utils.resolve(<span class="string">'public/'</span>),</span><br><span class="line">          to: utils.resolve(<span class="string">'dist/public'</span>),</span><br><span class="line">          toType: <span class="string">'dir'</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>util.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  resolve: <span class="function"><span class="keyword">function</span> (<span class="params">dir</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> path.join(__dirname, dir)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  assetsPath: <span class="function"><span class="keyword">function</span> (<span class="params">_path</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> assetsSubDirectory = <span class="string">'public'</span></span><br><span class="line">    <span class="keyword">return</span> path.posix.join(assetsSubDirectory, _path)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/前端/">前端</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-log" class="article article-type-post" itemscope="" itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/08/16/log/" class="article-date">
      <time datetime="2020-08-15T16:00:00.000Z" itemprop="datePublished">2020-08-16</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/08/16/log/">前端记录</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p> 记录一下，给自己看。</p>
<blockquote>
<p>2020-8-16</p>
</blockquote>
<h2 id="H5当中contenteditable-属性"><a href="#H5当中contenteditable-属性" class="headerlink" title="H5当中contenteditable 属性"></a>H5当中contenteditable 属性</h2><ul>
<li>contenteditable 属性规定元素内容是否可编辑  </li>
<li>通过<code>&amp;:focus{outline: none;}</code>去除聚焦边框</li>
<li><code>oninput</code> 监听文本变化</li>
</ul>
<h2 id="微信表情包使用"><a href="#微信表情包使用" class="headerlink" title="微信表情包使用"></a>微信表情包使用</h2><ul>
<li><code>https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/${Math.floor(Math.random() * 104 + 1)}.gif&quot;</code></li>
</ul>
<h2 id="点击复制"><a href="#点击复制" class="headerlink" title="点击复制"></a>点击复制</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">      copy(dom) &#123;</span><br><span class="line">	//创建input元素</span><br><span class="line">	let input = document.createElement(&apos;input&apos;)</span><br><span class="line">	document.body.appendChild(input)</span><br><span class="line">	input.value = this.$refs[dom].innerText</span><br><span class="line">	//input元素选中状态</span><br><span class="line">	input.select()</span><br><span class="line">	//复制内容到剪切板</span><br><span class="line">	document.execCommand(&apos;copy&apos;)</span><br><span class="line">	//移除input元素</span><br><span class="line">	document.body.removeChild(input)</span><br><span class="line">	this.$notify(&#123; type: &apos;success&apos;, message: &apos;复制成功！&apos;, duration: 500 &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2020-8-18</p>
</blockquote>
<h2 id="vue-cli-publicPath-来自官方文档"><a href="#vue-cli-publicPath-来自官方文档" class="headerlink" title="vue-cli publicPath(来自官方文档)"></a>vue-cli publicPath(来自官方文档)</h2><ul>
<li>默认情况下，Vue CLI 会假设你的应用是被部署在一个域名的根路径上，例如 <a href="https://www.my-app.com/。" target="_blank" rel="noopener">https://www.my-app.com/。</a><br>如果应用被部署在一个子路径上，你就需要用这个选项指定这个子路径。例如，如果你的应用被部署在 <a href="https://www.my-app.com/my-app/，则设置" target="_blank" rel="noopener">https://www.my-app.com/my-app/，则设置</a> publicPath 为 /my-app/。<br>这个值也可以被设置为空字符串 (‘’) 或是相对路径 (‘./‘)，这样所有的资源都会被链接为相对路径，这样打出来的包可以被部署在任意路径，也可以用在类似 Cordova hybrid 应用的文件系统中。</li>
<li>相对路径的 publicPath 有一些使用上的限制。在以下情况下，应当避免使用相对 :<br>当使用基于 HTML5 history.pushState 的路由时；<br>当使用 pages 选项构建多页面应用时.</li>
<li>这个值在开发环境下同样生效。如果你想把开发服务器架设在根路径，你可以使用一个条件式的值：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  publicPath: process.env.NODE_ENV === &apos;production&apos;</span><br><span class="line">    ? &apos;/production-sub-path/&apos;</span><br><span class="line">    : &apos;/&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2020-8-24</p>
</blockquote>
<h2 id="Ant-Design-输入框、下拉框取消聚焦时的边框颜色"><a href="#Ant-Design-输入框、下拉框取消聚焦时的边框颜色" class="headerlink" title="Ant-Design 输入框、下拉框取消聚焦时的边框颜色"></a>Ant-Design 输入框、下拉框取消聚焦时的边框颜色</h2><ul>
<li>输入框</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/deep/ .ant-input &#123;</span><br><span class="line">                     //ant-design输入框聚焦样式通过box-shadow设置</span><br><span class="line">                   &amp;:focus &#123;</span><br><span class="line">                                box-shadow: none;</span><br><span class="line">                            &#125;</span><br><span class="line">                  &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>下拉框</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//ant-design下拉框聚焦样式通过box-shadow设置</span><br><span class="line">                        /deep/ .ant-select-focused &#123;</span><br><span class="line">                            .ant-select-selection &#123;</span><br><span class="line">                                box-shadow: none;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br></pre></td></tr></table></figure>
<h2 id="Ant-Design-Table组件设置四角圆角属性-border-radius"><a href="#Ant-Design-Table组件设置四角圆角属性-border-radius" class="headerlink" title="Ant-Design Table组件设置四角圆角属性 border-radius"></a>Ant-Design Table组件设置四角圆角属性 border-radius</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">/deep/ .ant-table-thead tr &#123;</span><br><span class="line">            th &#123;</span><br><span class="line">                &amp;:nth-child(1) &#123;</span><br><span class="line">                    border-top-left-radius: 15px;</span><br><span class="line">                &#125;</span><br><span class="line">                &amp;:nth-last-child(1) &#123;</span><br><span class="line">                    border-top-right-radius: 15px;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        /deep/ .ant-table-tbody &#123;</span><br><span class="line">            background-color: #fff;</span><br><span class="line">            tr &#123;</span><br><span class="line">                &amp;:nth-last-child(1) &#123;</span><br><span class="line">                    td &#123;</span><br><span class="line">                        &amp;:nth-child(1) &#123;</span><br><span class="line">                            border-bottom-left-radius: 15px;</span><br><span class="line">                        &#125;</span><br><span class="line">                        &amp;:nth-last-child(1) &#123;</span><br><span class="line">                            border-bottom-right-radius: 15px;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2020-8-27</p>
</blockquote>
<h2 id="必选星号-字体"><a href="#必选星号-字体" class="headerlink" title="必选星号 字体"></a>必选星号 字体</h2><ul>
<li><code>font-family: SimSun, sans-serif</code></li>
</ul>
<blockquote>
<p>2020-8-28</p>
</blockquote>
<h2 id="实现-placeholder-效果"><a href="#实现-placeholder-效果" class="headerlink" title="实现  placeholder 效果"></a>实现  placeholder 效果</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&amp;:before &#123;</span><br><span class="line">      content: &apos;请输入...&apos;;</span><br><span class="line">      color: gray;</span><br><span class="line">&#125;</span><br><span class="line">&amp;:focus:before &#123;</span><br><span class="line"> content: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2020-8-29</p>
</blockquote>
<h2 id="oninput-事件"><a href="#oninput-事件" class="headerlink" title="oninput 事件"></a><code>oninput</code> 事件</h2><p><em>该事件在<code>&lt;input&gt;</code>或 <code>&lt;textarea&gt;</code>元素的值发生改变时触发。
</em>提示： 该事件类似于<code>onchange</code>事件。不同之处在于 <code>oninput</code> 事件在元素值发生变化是立即触发，<code>onchange</code> 在元素失去焦点时触发。<br>*另外一点不同是 <code>onchange</code>事件也可以作用于<code>&lt;keygen&gt;</code>和 <code>&lt;select&gt;</code>元素。</p>
<blockquote>
<p>2020-8-30</p>
</blockquote>
<h2 id="vant-Dialog弹出框、Popup弹出层样式修改"><a href="#vant-Dialog弹出框、Popup弹出层样式修改" class="headerlink" title="vant Dialog弹出框、Popup弹出层样式修改"></a>vant Dialog弹出框、Popup弹出层样式修改</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">position: absolute;</span><br><span class="line">left: 0;</span><br><span class="line">right: 0;</span><br><span class="line">top: 0;</span><br><span class="line">bottom: 0;</span><br><span class="line">margin: auto;</span><br><span class="line">transform: translate3d(0, 0, 0); 解决字体模糊</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2020-9-1</p>
</blockquote>
<h2 id="滚动条"><a href="#滚动条" class="headerlink" title="滚动条"></a>滚动条</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">                    &amp;::-webkit-scrollbar &#123;</span><br><span class="line">                        width: 10px; /*滚动条宽度*/</span><br><span class="line">                    &#125;</span><br><span class="line">                    &amp;::-webkit-scrollbar-thumb &#123;</span><br><span class="line">                        /*滚动条滑块*/</span><br><span class="line">                        border-radius: 10px;</span><br><span class="line">                        box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);</span><br><span class="line">                        background: #535353;</span><br><span class="line">                    &#125;</span><br><span class="line">                    &amp;::-webkit-scrollbar-track &#123;</span><br><span class="line">                        /*滚动条轨道*/</span><br><span class="line">                        box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);</span><br><span class="line">                        border-radius: 10px;</span><br><span class="line">                        background: #ededed;</span><br><span class="line">                    &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2020-9-9</p>
</blockquote>
<h2 id="location-search"><a href="#location-search" class="headerlink" title="location.search"></a><code>location.search</code></h2><ul>
<li><code>location.search</code> 属性是一个可读可写的字符串，可设置或返回当前 URL 的查询部分（问号 ? 之后的部分）。</li>
<li>hash路由时也可</li>
</ul>
<blockquote>
<p>2020-9-10</p>
</blockquote>
<h2 id="attname"><a href="#attname" class="headerlink" title="attname"></a><code>attname</code></h2><ul>
<li><code>url?attname=&#39;&#39;</code>  可以自定义资源文件下载的文件后缀和名字（比如七牛云转链的APK文件）</li>
</ul>
<h2 id="deep"><a href="#deep" class="headerlink" title="/deep/"></a><code>/deep/</code></h2><ul>
<li>less  修改富文本图片样式时需要用到   （这样描述估计只有本尊自己能看懂，没错，就是给我自己看的）</li>
</ul>
<blockquote>
<p>2020-9-15</p>
</blockquote>
<h2 id="env-prod配置文件"><a href="#env-prod配置文件" class="headerlink" title=".env.prod配置文件"></a><code>.env.prod配置文件</code></h2><ul>
<li>配置文件注释使用<code>#</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">NODE_ENV=production   (打包部署时，NODE_ENV需为production)</span><br><span class="line">测试环境</span><br><span class="line">VUE_APP_API_BASE_URL=xxx </span><br><span class="line">VUE_APP_API_REDIRECT_URL=xxx</span><br><span class="line">预发环境</span><br><span class="line">VUE_APP_API_BASE_URL=xxx</span><br><span class="line">VUE_APP_API_REDIRECT_URL=xxx</span><br><span class="line">线上测试环境</span><br><span class="line">VUE_APP_API_BASE_URL=xxx</span><br><span class="line">VUE_APP_API_REDIRECT_URL=xxx</span><br><span class="line">正式线上环境</span><br><span class="line">VUE_APP_API_BASE_URL=xxx</span><br><span class="line">VUE_APP_API_REDIRECT_URL=xxx</span><br></pre></td></tr></table></figure>
<h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a><code>package.json</code></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">        &quot;serve&quot;: &quot;vue-cli-service serve --mode dev&quot;,</span><br><span class="line">        &quot;build&quot;: &quot;vue-cli-service build --mode prod&quot;,</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<h2 id="npm-cache-clear-–force-清除缓存"><a href="#npm-cache-clear-–force-清除缓存" class="headerlink" title="npm cache clear –force 清除缓存"></a>npm cache clear –force 清除缓存</h2><blockquote>
<p>2020-9-18</p>
</blockquote>
<h2 id="env-prod配置文件-1"><a href="#env-prod配置文件-1" class="headerlink" title=".env.prod配置文件"></a><code>.env.prod配置文件</code></h2><ul>
<li>配置文件注释使用<code>#</code></li>
</ul>
<blockquote>
<p>2020-9-22</p>
</blockquote>
<h2 id="promise"><a href="#promise" class="headerlink" title="promise"></a><code>promise</code></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line">const PENDING = &quot;pending&quot;; // 等待</span><br><span class="line">const FULFILLED = &quot;fulfilled&quot;; // 成功</span><br><span class="line">const REJECTED = &quot;rejected&quot;; // 失败</span><br><span class="line"></span><br><span class="line">class _Promise &#123;</span><br><span class="line">  constructor(executor) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      executor(this.resolve, this.reject);</span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">      this.reject(e);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  // promsie 状态</span><br><span class="line">  status = PENDING;</span><br><span class="line">  // 成功之后的值</span><br><span class="line">  value = undefined;</span><br><span class="line">  // 失败后的原因</span><br><span class="line">  reason = undefined;</span><br><span class="line">  // 成功回调</span><br><span class="line">  successCallback = [];</span><br><span class="line">  // 失败回调</span><br><span class="line">  failCallback = [];</span><br><span class="line"></span><br><span class="line">  resolve = (value) =&gt; &#123;</span><br><span class="line">    // 如果状态不是等待 阻止程序向下执行</span><br><span class="line">    if (this.status !== PENDING) return;</span><br><span class="line">    // 将状态更改为成功</span><br><span class="line">    this.status = FULFILLED;</span><br><span class="line">    // 保存成功之后的值</span><br><span class="line">    this.value = value;</span><br><span class="line">    // 判断成功回调是否存在 如果存在 调用</span><br><span class="line">    // this.successCallback &amp;&amp; this.successCallback(this.value);</span><br><span class="line">    while (this.successCallback.length) this.successCallback.shift()();</span><br><span class="line">  &#125;;</span><br><span class="line">  reject = (reason) =&gt; &#123;</span><br><span class="line">    // 如果状态不是等待 阻止程序向下执行</span><br><span class="line">    if (this.status !== PENDING) return;</span><br><span class="line">    // 将状态更改为失败</span><br><span class="line">    this.status = REJECTED;</span><br><span class="line">    // 保存失败后的原因</span><br><span class="line">    this.reason = reason;</span><br><span class="line">    // 判断失败回调是否存在 如果存在 调用</span><br><span class="line">    // this.failCallback &amp;&amp; this.failCallback(this.reason);</span><br><span class="line">    while (this.failCallback.length) this.failCallback.shift()();</span><br><span class="line">  &#125;;</span><br><span class="line">  then(successCallback, failCallback) &#123;</span><br><span class="line">    // 参数可选</span><br><span class="line">    successCallback = successCallback ? successCallback : (value) =&gt; value;</span><br><span class="line">    // 参数可选</span><br><span class="line">    failCallback = failCallback</span><br><span class="line">      ? failCallback</span><br><span class="line">      : (reason) =&gt; &#123;</span><br><span class="line">          throw reason;</span><br><span class="line">        &#125;;</span><br><span class="line">    let promsie2 = new _Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">      // 判断状态</span><br><span class="line">      if (this.status === FULFILLED) &#123;</span><br><span class="line">        setTimeout(() =&gt; &#123;</span><br><span class="line">          try &#123;</span><br><span class="line">            let x = successCallback(this.value);</span><br><span class="line">            // 判断 x 的值是普通值还是Promise对象</span><br><span class="line">            // 如果是普通值 直接调用resolve</span><br><span class="line">            // 如果是promise对象 查看promsie对象返回的结果</span><br><span class="line">            // 再根据promise对象返回的结果 决定调用resolve 还是调用reject</span><br><span class="line">            resolvePromise(promsie2, x, resolve, reject);</span><br><span class="line">          &#125; catch (e) &#123;</span><br><span class="line">            reject(e);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, 0);</span><br><span class="line">      &#125; else if (this.status === REJECTED) &#123;</span><br><span class="line">        setTimeout(() =&gt; &#123;</span><br><span class="line">          try &#123;</span><br><span class="line">            let x = failCallback(this.reason);</span><br><span class="line">            // 判断 x 的值是普通值还是promise对象</span><br><span class="line">            // 如果是普通值 直接调用resolve</span><br><span class="line">            // 如果是promise对象 查看promsie对象返回的结果</span><br><span class="line">            // 再根据promise对象返回的结果 决定调用resolve 还是调用reject</span><br><span class="line">            resolvePromise(promsie2, x, resolve, reject);</span><br><span class="line">          &#125; catch (e) &#123;</span><br><span class="line">            reject(e);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, 0);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        // 等待</span><br><span class="line">        // 将成功回调和失败回调存储起来</span><br><span class="line">        this.successCallback.push(() =&gt; &#123;</span><br><span class="line">          setTimeout(() =&gt; &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">              let x = successCallback(this.value);</span><br><span class="line">              // 判断 x 的值是普通值还是promise对象</span><br><span class="line">              // 如果是普通值 直接调用resolve</span><br><span class="line">              // 如果是promise对象 查看promsie对象返回的结果</span><br><span class="line">              // 再根据promise对象返回的结果 决定调用resolve 还是调用reject</span><br><span class="line">              resolvePromise(promsie2, x, resolve, reject);</span><br><span class="line">            &#125; catch (e) &#123;</span><br><span class="line">              reject(e);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;, 0);</span><br><span class="line">        &#125;);</span><br><span class="line">        this.failCallback.push(() =&gt; &#123;</span><br><span class="line">          setTimeout(() =&gt; &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">              let x = failCallback(this.reason);</span><br><span class="line">              // 判断 x 的值是普通值还是promise对象</span><br><span class="line">              // 如果是普通值 直接调用resolve</span><br><span class="line">              // 如果是promise对象 查看promsie对象返回的结果</span><br><span class="line">              // 再根据promise对象返回的结果 决定调用resolve 还是调用reject</span><br><span class="line">              resolvePromise(promsie2, x, resolve, reject);</span><br><span class="line">            &#125; catch (e) &#123;</span><br><span class="line">              reject(e);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;, 0);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    return promsie2;</span><br><span class="line">  &#125;</span><br><span class="line">  finally(callback) &#123;</span><br><span class="line">    return this.then(</span><br><span class="line">      (value) =&gt; &#123;</span><br><span class="line">        return _Promise.resolve(callback()).then(() =&gt; value);</span><br><span class="line">      &#125;,</span><br><span class="line">      (reason) =&gt; &#123;</span><br><span class="line">        return _Promise.resolve(callback()).then(() =&gt; &#123;</span><br><span class="line">          throw reason;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  catch(failCallback) &#123;</span><br><span class="line">    return this.then(undefined, failCallback);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //all静态方法</span><br><span class="line">  static all(array) &#123;</span><br><span class="line">    let result = [];</span><br><span class="line">    let index = 0;</span><br><span class="line">    return new _Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">      function addData(key, value) &#123;</span><br><span class="line">        result[key] = value;</span><br><span class="line">        index++;</span><br><span class="line">        if (index === array.length) &#123;</span><br><span class="line">          resolve(result);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      for (let i = 0; i &lt; array.length; i++) &#123;</span><br><span class="line">        let current = array[i];</span><br><span class="line">        if (current instanceof _Promise) &#123;</span><br><span class="line">          // promise 对象</span><br><span class="line">          current.then(</span><br><span class="line">            (value) =&gt; addData(i, value),</span><br><span class="line">            (reason) =&gt; reject(reason)</span><br><span class="line">          );</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          // 普通值</span><br><span class="line">          addData(i, array[i]);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  //resolve静态方法</span><br><span class="line">  static resolve(value) &#123;</span><br><span class="line">    if (value instanceof _Promise) return value;</span><br><span class="line">    return new _Promise((resolve) =&gt; resolve(value));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function resolvePromise(promsie2, x, resolve, reject) &#123;</span><br><span class="line">  if (promsie2 === x) &#123;</span><br><span class="line">    return reject(</span><br><span class="line">      new TypeError(&quot;Chaining cycle detected for promise #&lt;Promise&gt;&quot;)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  //promise对象</span><br><span class="line">  if (x instanceof _Promise) &#123;</span><br><span class="line">    x.then(resolve, reject);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    // 普通值</span><br><span class="line">    resolve(x);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">module.exports = __Promise;</span><br></pre></td></tr></table></figure>
<h2 id="AntDesign-Notification"><a href="#AntDesign-Notification" class="headerlink" title="AntDesign  Notification"></a><code>AntDesign  Notification</code></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">this.$notification.open(&#123;</span><br><span class="line">  getContainer: function () &#123;</span><br><span class="line">    return document.querySelector(&quot;#team_set&quot;);</span><br><span class="line">  &#125;,</span><br><span class="line">  message: &quot;生成链接&quot;,</span><br><span class="line">  description: (h) =&gt; &#123;</span><br><span class="line">    return h(&quot;div&quot;, [</span><br><span class="line">      h(&quot;h3&quot;, &quot;长链接&quot;),</span><br><span class="line">      h(&quot;div&quot;, &#123;</span><br><span class="line">        //html attribute</span><br><span class="line">        attrs: &#123;</span><br><span class="line">          id: &quot;longUrl&quot;,</span><br><span class="line">          class: &quot;notification-text&quot;,</span><br><span class="line">        &#125;, //dom  property</span><br><span class="line">        domProps: &#123;</span><br><span class="line">          innerHTML: `$&#123;this.link.redirectUrl&#125;`,</span><br><span class="line">        &#125;,</span><br><span class="line">        on: &#123;</span><br><span class="line">          click: this.copy,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;),</span><br><span class="line">      h(&quot;h3&quot;, &quot;短链接&quot;),</span><br><span class="line">      h(&quot;div&quot;, &#123;</span><br><span class="line">        //html attribute</span><br><span class="line">        attrs: &#123;</span><br><span class="line">          id: &quot;shortUrl&quot;,</span><br><span class="line">          class: &quot;notification-text&quot;,</span><br><span class="line">        &#125;, //dom  property</span><br><span class="line">        domProps: &#123;</span><br><span class="line">          innerHTML: `$&#123;this.link.shorUrl&#125;`,</span><br><span class="line">        &#125;,</span><br><span class="line">        on: &#123;</span><br><span class="line">          click: this.copy,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;),</span><br><span class="line">    ]);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="图片宽度高度相等"><a href="#图片宽度高度相等" class="headerlink" title="图片宽度高度相等"></a><code>图片宽度高度相等</code></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> .face-list &#123;</span><br><span class="line">        display: flex;</span><br><span class="line">        justify-content: space-between;</span><br><span class="line">        flex-wrap: wrap;</span><br><span class="line">        padding: 10px;</span><br><span class="line">        &amp;::after &#123;</span><br><span class="line">            content: &apos;&apos;;</span><br><span class="line">            flex-grow: 9999;</span><br><span class="line">        &#125;</span><br><span class="line">        .face-list-item &#123;</span><br><span class="line">            width: 8%;</span><br><span class="line">            margin: 2% 1%;</span><br><span class="line">            padding: 8px;</span><br><span class="line">            border: 1px solid #d9d9d9;</span><br><span class="line">            border-radius: 6px;</span><br><span class="line">            .face-list-item-img &#123;</span><br><span class="line">                padding: 50% 0;</span><br><span class="line">                cursor: pointer;</span><br><span class="line">                position: relative;</span><br><span class="line">                .face-list-item-cover &#123;</span><br><span class="line">                    position: absolute;</span><br><span class="line">                    top: 0px;</span><br><span class="line">                    background-color: rgba(0, 0, 0, 0.5);</span><br><span class="line">                    width: 100%;</span><br><span class="line">                    height: 100%;</span><br><span class="line">                    display: flex;</span><br><span class="line">                    justify-content: center;</span><br><span class="line">                    align-items: center;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="AntDesign-select组件-popupScroll事件"><a href="#AntDesign-select组件-popupScroll事件" class="headerlink" title="AntDesign select组件 popupScroll事件"></a><code>AntDesign select组件 popupScroll事件</code></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//下拉框滚动事件</span><br><span class="line">        selectScroll(e) &#123;</span><br><span class="line">            //滚动距离顶部的高度</span><br><span class="line">            let scrollTop = e.target.scrollTop</span><br><span class="line">            //滚动区域高度</span><br><span class="line">            let scrollHeight = e.target.scrollHeight</span><br><span class="line">            //滚动可视区域高度</span><br><span class="line">            let height = parseInt(e.target.style.height.replace(&apos;px&apos;, &apos;&apos;))</span><br><span class="line">            //是否滚动到底部</span><br><span class="line">            if (scrollTop + height === scrollHeight) &#123;</span><br><span class="line">               </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure>
<h2 id="响应头-responseType-Blob"><a href="#响应头-responseType-Blob" class="headerlink" title="响应头 responseType:Blob"></a>响应头 responseType:Blob</h2><p>处理文件下载时返回的二进制数据</p>
<h2 id="get请求url含特殊参数时"><a href="#get请求url含特殊参数时" class="headerlink" title="get请求url含特殊参数时"></a>get请求url含特殊参数时</h2><p>需要对特殊参数进行编码(encodeURIComponent)</p>
<p>encodeURIComponent:该方法不会对 ASCII 字母和数字进行编码，也不会对这些 ASCII 标点符号进行编码： - _ . ! ~ * ‘ ( ) 。<br>其他字符（比如 ：;/?:@&amp;=+$,# 这些用于分隔 URI 组件的标点符号），都是由一个或多个十六进制的转义序列替换的。</p>
<h2 id="lottie-json动画"><a href="#lottie-json动画" class="headerlink" title="lottie  (json动画)"></a>lottie  (json动画)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const el = document.querySelector(&quot;#lottie_avtivity&quot;);</span><br><span class="line">lottie.loadAnimation(&#123;</span><br><span class="line">  container: el,</span><br><span class="line">  renderer: &quot;svg&quot;,</span><br><span class="line">  loop: true,</span><br><span class="line">  autoplay: true,</span><br><span class="line">  path: &quot;lottie.json&quot;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="DatePicker、MonthPicker、RangePicker、WeekPicker-部分-locale-是从-value-中读取，需要先正确设置-moment-的-locale。"><a href="#DatePicker、MonthPicker、RangePicker、WeekPicker-部分-locale-是从-value-中读取，需要先正确设置-moment-的-locale。" class="headerlink" title="DatePicker、MonthPicker、RangePicker、WeekPicker 部分 locale 是从 value 中读取，需要先正确设置 moment 的 locale。"></a>DatePicker、MonthPicker、RangePicker、WeekPicker 部分 locale 是从 value 中读取，需要先正确设置 moment 的 locale。</h2><h2 id="replace-s-g-’’-清除所有空白字符"><a href="#replace-s-g-’’-清除所有空白字符" class="headerlink" title="replace(/\s/g,’’)   清除所有空白字符"></a>replace(/\s/g,’’)   清除所有空白字符</h2><h2 id="375px以下适配"><a href="#375px以下适配" class="headerlink" title="375px以下适配"></a>375px以下适配</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@screen: 3.75;</span><br><span class="line">@media screen and(max-width:375px) &#123;</span><br><span class="line">  #app &#123;</span><br><span class="line">    padding: 20vw / @screen 0;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="获取url查询参数"><a href="#获取url查询参数" class="headerlink" title="获取url查询参数"></a>获取url查询参数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function getUrlParams(field) &#123;</span><br><span class="line">  //查询字符串  去掉?</span><br><span class="line">  const queryStr = window.location.search.slice(1);</span><br><span class="line">  //查询参数数组</span><br><span class="line">  const queryArr = queryStr.split(&quot;&amp;&quot;);</span><br><span class="line">  for (const query of queryArr) &#123;</span><br><span class="line">    const key = query.split(&quot;=&quot;)[0];</span><br><span class="line">    const value = query.split(&quot;=&quot;)[1];</span><br><span class="line">    //匹配到字段</span><br><span class="line">    if (field === key) return value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="提示框"><a href="#提示框" class="headerlink" title="提示框"></a>提示框</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;tip&quot; id=&quot;tip&quot;&gt;复制成功&lt;/div&gt;</span><br><span class="line">.tip&#123;</span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 30px;</span><br><span class="line">    line-height: 30px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    border-radius: 6px;</span><br><span class="line">    background-color: rgba(0, 0, 0, .4);</span><br><span class="line">    color:  rgba(256, 256, 256, .8);</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    opacity: 0;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    left: 50%;</span><br><span class="line">    transform: translate(-50%);</span><br><span class="line">    transition: opacity .8s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="正则"><a href="#正则" class="headerlink" title="正则"></a>正则</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">渠道专属推广位   /^([a-zA-Z])\1_[0-9]&#123;1,&#125;_[0-9]&#123;1,&#125;_[0-9]&#123;1,&#125;$/g, message: &apos;格式:mm_123456_123456_123456&apos; </span><br><span class="line"></span><br><span class="line">手机号  /^[1][3|4|5|6|7|8|9][0-9]&#123;9&#125;$/g</span><br></pre></td></tr></table></figure>
<h2 id="textarea-禁止拖拽"><a href="#textarea-禁止拖拽" class="headerlink" title="textarea  禁止拖拽"></a>textarea  禁止拖拽</h2><p>resize:none</p>
<h2 id="腾讯图形验证码"><a href="#腾讯图形验证码" class="headerlink" title="腾讯图形验证码"></a>腾讯图形验证码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;https://ssl.captcha.qq.com/TCaptcha.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> //验证码生成</span><br><span class="line">    tencentCode() &#123;</span><br><span class="line">      let tencentCodeDom = document.querySelector(&quot;#TencentCaptchaCode&quot;);</span><br><span class="line">      let self = this;</span><br><span class="line">      this.tencentCodeObject = new TencentCaptcha(</span><br><span class="line">        tencentCodeDom,</span><br><span class="line">        &quot;2062726362&quot;,</span><br><span class="line">        function (res) &#123;</span><br><span class="line">          //判断验证成功</span><br><span class="line">          if (res.ret === 2) &#123;</span><br><span class="line">            self.loading = false;</span><br><span class="line">          &#125; else if (res.ret === 0) &#123;</span><br><span class="line">            self</span><br><span class="line">              .Login(&#123;</span><br><span class="line">                loginTilKey: self.loginTilKey,</span><br><span class="line">                values: self.loginParams,</span><br><span class="line">              &#125;)</span><br><span class="line">              .then((res) =&gt; &#123;</span><br><span class="line">                self.loginSuccess();</span><br><span class="line">              &#125;)</span><br><span class="line">              .catch((res) =&gt; self.requestFailed(res))</span><br><span class="line">              .finally(() =&gt; &#123;</span><br><span class="line">                self.loading = false;</span><br><span class="line">                self.resetValidateCode();</span><br><span class="line">              &#125;);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<h2 id="h函数"><a href="#h函数" class="headerlink" title="h函数"></a>h函数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">render (h) &#123;</span><br><span class="line">  return h(&apos;div&apos;, &#123;</span><br><span class="line">    // Component props</span><br><span class="line">    props: &#123;</span><br><span class="line">      msg: &apos;hi&apos;,</span><br><span class="line">      onCustomEvent: this.customEventHandler</span><br><span class="line">    &#125;,</span><br><span class="line">    // normal HTML attributes</span><br><span class="line">    attrs: &#123;</span><br><span class="line">      id: &apos;foo&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    // DOM props</span><br><span class="line">    domProps: &#123;</span><br><span class="line">      innerHTML: &apos;bar&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    // Event handlers are nested under &quot;on&quot;, though</span><br><span class="line">    // modifiers such as in v-on:keyup.enter are not</span><br><span class="line">    // supported. You&apos;ll have to manually check the</span><br><span class="line">    // keyCode in the handler instead.</span><br><span class="line">    on: &#123;</span><br><span class="line">      click: this.clickHandler</span><br><span class="line">    &#125;,</span><br><span class="line">    // For components only. Allows you to listen to</span><br><span class="line">    // native events, rather than events emitted from</span><br><span class="line">    // the component using vm.$emit.</span><br><span class="line">    nativeOn: &#123;</span><br><span class="line">      click: this.nativeClickHandler</span><br><span class="line">    &#125;,</span><br><span class="line">    // class is a special module, same API as `v-bind:class`</span><br><span class="line">    class: &#123;</span><br><span class="line">      foo: true,</span><br><span class="line">      bar: false</span><br><span class="line">    &#125;,</span><br><span class="line">    // style is also same as `v-bind:style`</span><br><span class="line">    style: &#123;</span><br><span class="line">      color: &apos;red&apos;,</span><br><span class="line">      fontSize: &apos;14px&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    // other special top-level properties</span><br><span class="line">    key: &apos;key&apos;,</span><br><span class="line">    ref: &apos;ref&apos;,</span><br><span class="line">    // assign the `ref` is used on elements/components with v-for</span><br><span class="line">    refInFor: true,</span><br><span class="line">    slot: &apos;slot&apos;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Ant-Design-upload-文件封面设置"><a href="#Ant-Design-upload-文件封面设置" class="headerlink" title="Ant Design  upload   文件封面设置"></a>Ant Design  upload   文件封面设置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">:preview-file=&quot;handlePreviewImg&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  //图片base64预览</span><br><span class="line">    getBase64More(file) &#123;</span><br><span class="line">      return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">        const reader = new FileReader();</span><br><span class="line">        reader.readAsDataURL(file);</span><br><span class="line">        reader.onload = () =&gt; resolve(reader.result);</span><br><span class="line">        reader.onerror = (error) =&gt; reject(error);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//文件封面设置</span><br><span class="line">    async handlePreviewImg(file) &#123;</span><br><span class="line">      //视频</span><br><span class="line">      if (file.type === &quot;video/mp4&quot;) &#123;</span><br><span class="line">        return Promise.resolve(&quot;https://kuaizhan.ecostudio.cn/video.png&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      //图片</span><br><span class="line">      else &#123;</span><br><span class="line">        //图片封面</span><br><span class="line">        const imgCover = await this.getBase64More(file);</span><br><span class="line">        return Promise.resolve(imgCover);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<h2 id="linus"><a href="#linus" class="headerlink" title="linus"></a>linus</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">rm-rf 删除目录</span><br></pre></td></tr></table></figure>
<h2 id="a标签-下载跨域文件"><a href="#a标签-下载跨域文件" class="headerlink" title="a标签  下载跨域文件"></a>a标签  下载跨域文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"> download(url, name) &#123;</span><br><span class="line">      const xhr = new XMLHttpRequest();</span><br><span class="line">      xhr.open(&quot;GET&quot;, url, true);</span><br><span class="line">      xhr.responseType = &quot;blob&quot;;</span><br><span class="line">      xhr.onload = function (e) &#123;</span><br><span class="line">        const url = window.URL.createObjectURL(xhr.response);</span><br><span class="line">        const a = document.createElement(&quot;a&quot;);</span><br><span class="line">        a.href = url;</span><br><span class="line">        a.download = name;</span><br><span class="line">        a.click();</span><br><span class="line">      &#125;;</span><br><span class="line">      xhr.send();</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<h2 id="pm2"><a href="#pm2" class="headerlink" title="pm2"></a>pm2</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pm2 list 查看</span><br><span class="line">pm2 start npm --name strapi-demo -- run start 启动、别名</span><br><span class="line">pm2 delete 删除(id)</span><br><span class="line">pm2 stop 停止(name)</span><br></pre></td></tr></table></figure>
<h2 id="git"><a href="#git" class="headerlink" title="git"></a>git</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1. 删除本地tag</span><br><span class="line">　　　　git tag -d tag-name</span><br><span class="line">2. 删除远程tag</span><br><span class="line">　　　　git push origin :refs/tags/tag-name</span><br></pre></td></tr></table></figure>
<h2 id="port设置"><a href="#port设置" class="headerlink" title="port设置"></a>port设置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1. windows:    eg: &quot;start&quot;: &quot;set PORT=9000 &amp;&amp; react-scripts start&quot; </span><br><span class="line">　　　</span><br><span class="line">2. Linux:    eg: &quot;start&quot;: &quot;PORT=9000  react-scripts start&quot;</span><br></pre></td></tr></table></figure>
<h2 id="WeakSet、WeakMap"><a href="#WeakSet、WeakMap" class="headerlink" title="WeakSet、WeakMap"></a>WeakSet、WeakMap</h2><ul>
<li>WeakSet</li>
</ul>
<ol>
<li>WeakSet 结构与 Set 类似，也是不重复的值的集合。但是，它与 Set 有两个区别。首先，WeakSet 的成员只能是对象，而不能是其他类型的值。</li>
<li>其次，WeakSet 中的对象都是弱引用，即垃圾回收机制不考虑 WeakSet 对该对象的引用，也就是说，如果其他对象都不再引用该对象，那么垃圾回收机制会自动回收该对象所占用的内存，不考虑该对象还存在于 WeakSet 之中。<br>这是因为垃圾回收机制依赖引用计数，如果一个值的引用次数不为0，垃圾回收机制就不会释放这块内存。结束使用该值之后，有时会忘记取消引用，导致内存无法释放，进而可能会引发内存泄漏。WeakSet 里面的引用，都不计入垃圾回收机制，所以就不存在这个问题。<br>因此，WeakSet 适合临时存放一组对象，以及存放跟对象绑定的信息。只要这些对象在外部消失，它在 WeakSet 里面的引用就会自动消失。<br>由于上面这个特点，WeakSet 的成员是不适合引用的，因为它会随时消失。<br>另外，由于 WeakSet 内部有多少个成员，取决于垃圾回收机制有没有运行，运行前后很可能成员个数是不一样的，而垃圾回收机制何时运行是不可预测的，因此 ES6 规定 WeakSet 不可遍历。</li>
<li>WeakSet 没有size属性，没有办法遍历它的成员。</li>
<li>WeakSet 不能遍历，是因为成员都是弱引用，随时可能消失，遍历机制无法保证成员的存在，很可能刚刚遍历结束，成员就取不到了。<br>WeakSet 的一个用处，是储存 DOM 节点，而不用担心这些节点从文档移除时，会引发内存泄漏。</li>
</ol>
<ul>
<li>WeakMap</li>
</ul>
<ol>
<li>首先，WeakMap只接受对象作为键名（null除外），不接受其他类型的值作为键名。</li>
<li>其次，WeakMap的键名所指向的对象，不计入垃圾回收机制。</li>
<li>WeakMap的设计目的在于，有时我们想在某个对象上面存放一些数据，但是这会形成对于这个对象的引用。请看下面的例子。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const e1 = document.getElementById(&apos;foo&apos;);</span><br><span class="line">const e2 = document.getElementById(&apos;bar&apos;);</span><br><span class="line">const arr = [</span><br><span class="line">  [e1, &apos;foo 元素&apos;],</span><br><span class="line">  [e2, &apos;bar 元素&apos;],</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>上面代码中，e1和e2是两个对象，我们通过arr数组对这两个对象添加一些文字说明。这就形成了arr对e1和e2的引用。<br>一旦不再需要这两个对象，我们就必须手动删除这个引用，否则垃圾回收机制就不会释放e1和e2占用的内存。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 不需要 e1 和 e2 的时候</span><br><span class="line">// 必须手动删除引用</span><br><span class="line">arr [0] = null;</span><br><span class="line">arr [1] = null;</span><br></pre></td></tr></table></figure></p>
<p>上面这样的写法显然很不方便。一旦忘了写，就会造成内存泄露。<br>WeakMap 就是为了解决这个问题而诞生的，它的键名所引用的对象都是弱引用，即垃圾回收机制不将该引用考虑在内。<br>因此，只要所引用的对象的其他引用都被清除，垃圾回收机制就会释放该对象所占用的内存。<br>也就是说，一旦不再需要，WeakMap 里面的键名对象和所对应的键值对会自动消失，不用手动删除引用。</p>
<h2 id="Reflect"><a href="#Reflect" class="headerlink" title="Reflect"></a>Reflect</h2><ul>
<li>Reflect对象的设计目的有这样几个。</li>
</ul>
<ol>
<li>将Object对象的一些明显属于语言内部的方法（比如Object.defineProperty），放到Reflect对象上。<br>现阶段，某些方法同时在Object和Reflect对象上部署，未来的新方法将只部署在Reflect对象上。<br>也就是说，从Reflect对象上可以拿到语言内部的方法。</li>
<li>修改某些Object方法的返回结果，让其变得更合理。<br>比如，Object.defineProperty(obj, name, desc)在无法定义属性时，会抛出一个错误，而Reflect.defineProperty(obj, name, desc)则会返回false。</li>
<li>让Object操作都变成函数行为。某些Object操作是命令式，比如name in obj和delete obj[name]，而Reflect.has(obj, name)和Reflect.deleteProperty(obj, name)让它们变成了函数行为。</li>
<li>Reflect对象的方法与Proxy对象的方法一一对应，只要是Proxy对象的方法，就能在Reflect对象上找到对应的方法。这就让Proxy对象可以方便地调用对应的Reflect方法，完成默认行为，作为修改行为的基础。<br>也就是说，不管Proxy怎么修改默认行为，你总可以在Reflect上获取默认行为。</li>
<li>Reflect.ownKeys方法用于返回对象的所有属性，基本等同于Object.getOwnPropertyNames与Object.getOwnPropertySymbols之和。</li>
<li>Reflect.construct方法等同于new target(…args)，这提供了一种不使用new，来调用构造函数的方法。</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/前端/">前端</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/css/">css</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-vue" class="article article-type-post" itemscope="" itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/24/vue/" class="article-date">
      <time datetime="2019-03-23T16:00:00.000Z" itemprop="datePublished">2019-03-24</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/24/vue/">vue</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>2019-3-24</p>
</blockquote>
<h2 id="双向绑定"><a href="#双向绑定" class="headerlink" title="双向绑定"></a>双向绑定</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">var Book = &#123;&#125;</span><br><span class="line">var name = &apos;&apos;;</span><br><span class="line">Object.defineProperty(Book, &apos;name&apos;, &#123;</span><br><span class="line">  set: function (value) &#123;</span><br><span class="line">    name = value;</span><br><span class="line">    console.log(&apos;你取了一个书名叫做&apos; + value);</span><br><span class="line">  &#125;,</span><br><span class="line">  get: function () &#123;</span><br><span class="line">    return &apos;《&apos; + name + &apos;》&apos;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line">Book.name = &apos;vue权威指南&apos;;  // 你取了一个书名叫做vue权威指南</span><br><span class="line">console.log(Book.name);  // 《vue权威指南》</span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">源自:http://www.cnblogs.com/canfoo/p/6891868.html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 当我们点击按钮的时候动态给 data 增加的成员是否是响应式数据，如果不是的话，如何把新增成员设置成响应式数据，它的内部原理是什么。</span><br><span class="line"></span><br><span class="line">答：不是响应式数据。响应式对象和响应式数组是指在vue初始化时期，利用Object.defineProperty()方法对其进行监听，这样在修改数据时会及时体现在页面上。</span><br><span class="line"></span><br><span class="line">- 设置为响应式数据有两种方法：</span><br><span class="line"></span><br><span class="line">  - 1、给 dog 的属性 name 设置一个初始值，可以为空字符串或者 undefined 之类的，代码和原因如下：</span><br><span class="line"></span><br><span class="line">    ```js</span><br><span class="line">    let vm = new Vue(&#123;</span><br><span class="line">        el: &apos;#app&apos;,</span><br><span class="line">        data: &#123;</span><br><span class="line">            msg: &apos;object&apos;,</span><br><span class="line">            dog: &#123;</span><br><span class="line">                name: &apos;&apos;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        method: &#123;</span><br><span class="line">            clickHandler() &#123;</span><br><span class="line">                // 该 name 属性是否是响应式的</span><br><span class="line">                this.dog.name = &apos;Trump&apos;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
<pre><code>- 原因：vm[key] setter 操作的时候会触发 data[key] 的 setter 操作，data[key] 的 setter 操作会 walk 这个新的值（walk方法是给data里的对象类型的值设置响应式），而题目中的 data 的 dog 是个空对象，没有任何属性，所以初始化 Vue 实例的时候，在给 dog 设置 proxy 的时候没有任何属性有 getter 和 setter 方法，所以在点击按钮动态的给 dog 添加 name 属性，并设置值的时候是不会触发 dog 对象下的属性 name 的 setter 方法，故不是响应式数据。而给 dog 对象添加了 name 的初始值后，dog 对象的 name 属性就有了 getter 和 setter 方法，故可以实现响应式。代码如下：

  - vue.js(监听 vm[key]的 getter 和 setter 操作 )

  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Vue</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(options) &#123;</span><br><span class="line">        <span class="comment">// 1、通过属性保存选项的数据</span></span><br><span class="line">        <span class="keyword">this</span>.$options = options || &#123;&#125;</span><br><span class="line">        <span class="keyword">this</span>.$data = options.data || &#123;&#125;</span><br><span class="line">        <span class="keyword">this</span>.$el = <span class="keyword">typeof</span> options.el === <span class="string">'string'</span> ? <span class="built_in">document</span>.querySelector(options.el) : options.el</span><br><span class="line">            <span class="comment">// 2、把 data 中的成员转换成 getter 和 setter,并注入到 vue 实例中</span></span><br><span class="line">        <span class="keyword">this</span>._proxyData(<span class="keyword">this</span>.$data)</span><br><span class="line">            <span class="comment">// 3、调用 observer 对象，监听数据的变化</span></span><br><span class="line">        <span class="keyword">new</span> Observer(<span class="keyword">this</span>.$data)</span><br><span class="line">            <span class="comment">// 4、调用 compiler 对象，解析指令和插值表达式</span></span><br><span class="line">        <span class="keyword">new</span> Compiler(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    _proxyData(data) &#123;</span><br><span class="line">        <span class="comment">// 遍历 data 中的所有属性</span></span><br><span class="line">        <span class="built_in">Object</span>.keys(data).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 把 data 的属性注入到 vue 实例中</span></span><br><span class="line">            <span class="built_in">Object</span>.defineProperty(<span class="keyword">this</span>, key, &#123;</span><br><span class="line">                enumerable: <span class="literal">true</span>,</span><br><span class="line">                configurable: <span class="literal">true</span>,</span><br><span class="line">                get() &#123;</span><br><span class="line">                    <span class="keyword">return</span> data[key]</span><br><span class="line">                &#125;,</span><br><span class="line">                set(newValue) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (newValue !== data[key]) &#123;</span><br><span class="line">                        data[key] = newValue</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

  - observe.js (data[key] 的 setter 操作会 walk 这个新的值,walk方法是给data里的对象类型的值设置响应式)

    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(data) &#123;</span><br><span class="line">        <span class="keyword">this</span>.walk(data)</span><br><span class="line">    &#125;</span><br><span class="line">    walk(data) &#123;</span><br><span class="line">        <span class="comment">// 1、判断 data 是否是对象</span></span><br><span class="line">        <span class="keyword">if</span> (!data || <span class="keyword">typeof</span> data !== <span class="string">'object'</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2、遍历 data 对象的所有属性</span></span><br><span class="line">        <span class="built_in">Object</span>.keys(data).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.defineReactive(data, key, data[key])</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    defineReactive(obj, key, val) &#123;</span><br><span class="line">        <span class="keyword">let</span> that = <span class="keyword">this</span></span><br><span class="line">            <span class="comment">// 负责收集依赖，并发送通知</span></span><br><span class="line">        <span class="keyword">let</span> dep = <span class="keyword">new</span> Dep()</span><br><span class="line">            <span class="comment">// 如果 val 是对象，把 val 内部的属性转换成响应式数据</span></span><br><span class="line">        that.walk(val)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(obj, key, &#123;</span><br><span class="line">            enumerable: <span class="literal">true</span>,</span><br><span class="line">            configurable: <span class="literal">true</span>,</span><br><span class="line">            get() &#123;</span><br><span class="line">                <span class="comment">// 收集依赖</span></span><br><span class="line">                Dep.target &amp;&amp; dep.addSub(Dep.target)</span><br><span class="line">                <span class="keyword">return</span> val</span><br><span class="line">            &#125;,</span><br><span class="line">            set(newValue) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(newValue, <span class="string">'&gt;&gt;&gt;&gt;&gt;'</span>, val)</span><br><span class="line">                <span class="keyword">if</span> (newValue === val) &#123;</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">                val = newValue</span><br><span class="line">                that.walk(newValue)</span><br><span class="line">                    <span class="comment">// 发送通知</span></span><br><span class="line">                dep.notify()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</code></pre><ul>
<li><p>2、使用 Vue.set(target, key, value) 时，target 为需要添加属性的对象，key 是要添加的属性名，value 为属性 key 对应的值, vue 中 set 的源码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">set</span> (<span class="params">target: Array&lt;any&gt; | Object, key: any, val: any</span>): <span class="title">any</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span> &amp;&amp;</span><br><span class="line">    (isUndef(target) || isPrimitive(target))</span><br><span class="line">  ) &#123;</span><br><span class="line">    warn(<span class="string">`Cannot set reactive property on undefined, null, or primitive value: <span class="subst">$&#123;(target: any)&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(target) &amp;&amp; isValidArrayIndex(key)) &#123;</span><br><span class="line">    target.length = <span class="built_in">Math</span>.max(target.length, key)</span><br><span class="line">    target.splice(key, <span class="number">1</span>, val)</span><br><span class="line">    <span class="keyword">return</span> val</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (key <span class="keyword">in</span> target &amp;&amp; !(key <span class="keyword">in</span> <span class="built_in">Object</span>.prototype)) &#123;</span><br><span class="line">    target[key] = val</span><br><span class="line">    <span class="keyword">return</span> val</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> ob = (target: any).__ob__</span><br><span class="line">  <span class="keyword">if</span> (target._isVue || (ob &amp;&amp; ob.vmCount)) &#123;</span><br><span class="line">    process.env.NODE_ENV !== <span class="string">'production'</span> &amp;&amp; warn(</span><br><span class="line">      <span class="string">'Avoid adding reactive properties to a Vue instance or its root $data '</span> +</span><br><span class="line">      <span class="string">'at runtime - declare it upfront in the data option.'</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> val</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!ob) &#123;</span><br><span class="line">    target[key] = val</span><br><span class="line">    <span class="keyword">return</span> val</span><br><span class="line">  &#125;</span><br><span class="line">  defineReactive(ob.value, key, val)</span><br><span class="line">  ob.dep.notify()</span><br><span class="line">  <span class="keyword">return</span> val</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>上面源码的执行逻辑如下(参考链接：<a href="https://www.cnblogs.com/heavenYJJ/p/9559439.html)：" target="_blank" rel="noopener">https://www.cnblogs.com/heavenYJJ/p/9559439.html)：</a></li>
<li>1、如果是在开发环境，且 target 未定义（为 null、undefined ）或 target 为基础数据类型（string、boolean、number、symbol）时，抛出告警；</li>
<li>2、如果 target 为数组且 key 为有效的数组 key 时，将数组的长度设置为 target.length 和 key 中的最大的那一个，然后调用数组的 splice 方法（ vue 中重写的 splice 方法）添加元素；</li>
<li>3、如果属性 key 存在于 target 对象中且 key 不是 Object.prototype 上的属性时，表明这是在修改 target 对象属性 key 的值（不管 target 对象是否是响应式的，只要 key 存在于 target 对象中，就执行这一步逻辑），此时就直接将 value 直接赋值给 target[key]；</li>
<li>4、判断 target，当 target 为 vue 实例或根数据 data 对象时，在开发环境下抛错；</li>
<li>5、当一个数据为响应式时，vue 会给该数据添加一个 <strong>ob</strong> 属性，因此可以通过判断target对象是否存在 <strong>ob</strong> 属性来判断 target 是否是响应式数据，当 target 是非响应式数据时，我们就按照普通对象添加属性的方式来处理；当 target 对象是响应式数据时，我们将 target 的属性 key 也设置为响应式并手动触发通知其属性值的更新；</li>
</ul>
</li>
<li><p>defineReactive(ob.value, key, val) ,将新增属性设置为响应式; ob.dep.notify() 手动触发通知该属性值的更新, 所以我们可以修改代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">'#app'</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            msg: <span class="string">'object'</span>,</span><br><span class="line">            dog: &#123;</span><br><span class="line">                name: <span class="literal">undefined</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        method: &#123;</span><br><span class="line">            clickHandler() &#123;</span><br><span class="line">                <span class="comment">// 该 name 属性是否是响应式的</span></span><br><span class="line">                <span class="keyword">this</span>.$set(<span class="keyword">this</span>.data.dog, name, <span class="string">'Trump'</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="请简述-Diff-算法的执行过程"><a href="#请简述-Diff-算法的执行过程" class="headerlink" title="请简述 Diff 算法的执行过程"></a>请简述 Diff 算法的执行过程</h2><p>diff算法是一种通过同层的树节点进行比较的高效算法，避免了对树进行逐层搜索遍历，所以时间复杂度只有 O(n)。 </p>
<p>diff算法有两个比较显著的特点： </p>
<p>1、比较只会在同层级进行, 不会跨层级比较。 </p>
<p>2、在diff比较的过程中，循环从两边向中间收拢。 </p>
<p>diff流程： </p>
<p>1 、首先定义 oldStartIdx、newStartIdx、oldEndIdx 以及 newEndIdx 分别是新老两个 VNode 的两边的索引。 </p>
<p>2、接下来是一个 while 循环，在这过程中，oldStartIdx、newStartIdx、oldEndIdx 以及 newEndIdx 会逐渐向中间靠拢。while 循环的退出条件是直到老节点或者新节点的开始位置大于结束位置。</p>
<p>while 循环中会遇到四种情况： </p>
<p>情形一：当新老 VNode 节点的 start 是同一节点时，直接 patchVnode 即可，同时新老 VNode 节点的开始索引都加 1。 </p>
<p>情形二：当新老 VNode 节点的 end  是同一节点时，直接 patchVnode 即可，同时新老 VNode 节点的结束索引都减 1。 </p>
<p>情形三：当老 VNode 节点的 start 和新 VNode 节点的 end  是同一节点时，这说明这次数据更新后 oldStartVnode 已经跑到了 oldEndVnode 后面去了。这时候在 patchVnode 后，还需要将当前真实 dom 节点移动到 oldEndVnode 的后面，同时老 VNode 节点开始索引加 1，新 VNode 节点的结束索引减 1。 </p>
<p>情形四：当老 VNode 节点的 end 和新 VNode 节点的 start 是同一节点时，这说明这次数据更新后 oldEndVnode 跑到了 oldStartVnode 的前面去了。这时候在 patchVnode 后，还需要将当前真实 dom 节点移动到 oldStartVnode 的前面，同时老 VNode 节点结束索引减 1，新 VNode 节点的开始索引加 1。  </p>
<p>3、while 循环的退出条件是直到老节点或者新节点的开始位置大于结束位置。 </p>
<p>情形一：如果在循环中，oldStartIdx大于oldEndIdx了，那就表示oldChildren比newChildren先循环完毕，那么newChildren里面剩余的节点都是需要新增的节点，把[newStartIdx, newEndIdx]之间的所有节点都插入到DOM中 </p>
<p>情形二：如果在循环中，newStartIdx大于newEndIdx了，那就表示newChildren比oldChildren先循环完毕，那么oldChildren里面剩余的节点都是需要删除的节点，把[oldStartIdx, oldEndIdx]之间的所有节点都删除</p>
<h2 id="模拟-VueRouter-的-hash-模式的实现，实现思路和-History-模式类似，把-URL-中的-后面的内容作为路由的地址，可以通过-hashchange-事件监听路由地址的变化。"><a href="#模拟-VueRouter-的-hash-模式的实现，实现思路和-History-模式类似，把-URL-中的-后面的内容作为路由的地址，可以通过-hashchange-事件监听路由地址的变化。" class="headerlink" title="模拟 VueRouter 的 hash 模式的实现，实现思路和 History 模式类似，把 URL 中的 # 后面的内容作为路由的地址，可以通过 hashchange 事件监听路由地址的变化。"></a>模拟 VueRouter 的 hash 模式的实现，实现思路和 History 模式类似，把 URL 中的 # 后面的内容作为路由的地址，可以通过 hashchange 事件监听路由地址的变化。</h2> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="built_in">console</span>.dir(Vue)</span><br><span class="line"><span class="keyword">let</span> _Vue = <span class="literal">null</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">VueRouter</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 实现 vue 的插件机制</span></span><br><span class="line">  <span class="keyword">static</span> install(Vue) &#123;</span><br><span class="line">    <span class="comment">//1 判断当前插件是否被安装</span></span><br><span class="line">    <span class="keyword">if</span> (VueRouter.install.installed) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    VueRouter.install.installed = <span class="literal">true</span></span><br><span class="line">    <span class="comment">//2 把Vue的构造函数记录在全局</span></span><br><span class="line">    _Vue = Vue</span><br><span class="line">    <span class="comment">//3 把创建Vue的实例传入的router对象注入到Vue实例</span></span><br><span class="line">    <span class="comment">// _Vue.prototype.$router = this.$options.router</span></span><br><span class="line">    <span class="comment">// 混入</span></span><br><span class="line">    _Vue.mixin(&#123;</span><br><span class="line">      beforeCreate() &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.$options.router) &#123;</span><br><span class="line">          _Vue.prototype.$router = <span class="keyword">this</span>.$options.router</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 初始化属性</span></span><br><span class="line">  <span class="keyword">constructor</span>(options) &#123;</span><br><span class="line">    <span class="keyword">this</span>.options = options <span class="comment">// options 记录构造函数传入的对象</span></span><br><span class="line">    <span class="keyword">this</span>.routeMap = &#123;&#125; <span class="comment">// routeMap 路由地址和组件的对应关系</span></span><br><span class="line">    <span class="comment">// observable     data 是一个响应式对象</span></span><br><span class="line">    <span class="keyword">this</span>.data = _Vue.observable(&#123;</span><br><span class="line">      current: <span class="string">"/"</span> <span class="comment">// 当前路由地址</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">this</span>.init()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 调用 createRouteMap, initComponent, initEvent 三个方法</span></span><br><span class="line">  init() &#123;</span><br><span class="line">    <span class="keyword">this</span>.createRouteMap()</span><br><span class="line">    <span class="keyword">this</span>.initComponent(_Vue)</span><br><span class="line">    <span class="keyword">this</span>.initEvent()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 用来初始化 routeMap 属性，路由规则转换为键值对</span></span><br><span class="line">  createRouteMap() &#123;</span><br><span class="line">    <span class="comment">//遍历所有的路由规则 把路由规则解析成键值对的形式存储到routeMap中</span></span><br><span class="line">    <span class="keyword">this</span>.options.routes.forEach(<span class="function"><span class="params">route</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.routeMap[route.path] = route.component</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 用来创建 router-link 和 router-view 组件</span></span><br><span class="line">  initComponent(Vue) &#123;</span><br><span class="line">    <span class="comment">// router-link 组件</span></span><br><span class="line">    Vue.component(<span class="string">'router-link'</span>, &#123;</span><br><span class="line">      props: &#123;</span><br><span class="line">        to: <span class="built_in">String</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// render --- 可在 vue 运行时版直接使用</span></span><br><span class="line">      render(h) &#123;</span><br><span class="line">        <span class="comment">// h(选择器（标签的名字）， 属性，生成的某个标签的内容)</span></span><br><span class="line">        <span class="keyword">return</span> h(<span class="string">'a'</span>, &#123;</span><br><span class="line">          attrs: &#123;</span><br><span class="line">            href: <span class="string">'#'</span> + <span class="keyword">this</span>.to,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="comment">// 注册事件</span></span><br><span class="line">        <span class="comment">//   on: &#123;</span></span><br><span class="line">        <span class="comment">//     click: this.clickHandler // 点击事件</span></span><br><span class="line">        <span class="comment">//   &#125;,</span></span><br><span class="line">        &#125;, [<span class="keyword">this</span>.$slots.default]) <span class="comment">// this.$slot.default 默认插槽</span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// router-view 组件</span></span><br><span class="line">    <span class="keyword">const</span> self = <span class="keyword">this</span>; <span class="comment">//这里的 this 指向 vueRouter 实例</span></span><br><span class="line">    Vue.component(<span class="string">'router-view'</span>, &#123;</span><br><span class="line">      render(h) &#123;</span><br><span class="line">        <span class="comment">// 根据 routerMap 中的对应关系，拿到当前路由地址所对应的组件</span></span><br><span class="line">        <span class="keyword">const</span> component = self.routeMap[self.data.current]</span><br><span class="line">        <span class="keyword">return</span> h(component)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 用来注册 hashchange 事件</span></span><br><span class="line">  initEvent () &#123;</span><br><span class="line">     <span class="built_in">window</span>.addEventListener(<span class="string">'hashchange'</span>, () =&gt; &#123;</span><br><span class="line">      <span class="keyword">this</span>.data.current = <span class="keyword">this</span>.getHash();</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'load'</span>, () =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="built_in">window</span>.location.hash) &#123;</span><br><span class="line">        <span class="built_in">window</span>.location.hash = <span class="string">'#/'</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  getHash() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.location.hash.slice(<span class="number">1</span>) || <span class="string">'/'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="在模拟-Vue-js-响应式源码的基础上实现-v-html-指令，以及-v-on-指令。"><a href="#在模拟-Vue-js-响应式源码的基础上实现-v-html-指令，以及-v-on-指令。" class="headerlink" title="在模拟 Vue.js 响应式源码的基础上实现 v-html 指令，以及 v-on 指令。"></a>在模拟 Vue.js 响应式源码的基础上实现 v-html 指令，以及 v-on 指令。</h2> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不同指令所调用的函数</span></span><br><span class="line">update (node, key, attrName) &#123;</span><br><span class="line">    <span class="keyword">let</span> updateFn = <span class="keyword">this</span>[attrName + <span class="string">'Updater'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理 v-on 指令</span></span><br><span class="line">    <span class="keyword">if</span> (attrName.startsWith(<span class="string">'on:'</span>)) &#123;</span><br><span class="line">        updateFn = <span class="keyword">this</span>[<span class="string">'on'</span> + <span class="string">'Updater'</span>]</span><br><span class="line">        <span class="keyword">const</span> eventType = attrName.split(<span class="string">':'</span>)[<span class="number">1</span>]</span><br><span class="line">        updateFn.call(<span class="keyword">this</span>, node, <span class="keyword">this</span>.vm[key], key, eventType)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    updateFn &amp;&amp; updateFn.call(<span class="keyword">this</span>, node, <span class="keyword">this</span>.vm[key], key) <span class="comment">// 此处的 this 就是 compiler 对象</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理 v-html 指令</span></span><br><span class="line">htmlUpdater (node, value, key) &#123;</span><br><span class="line">    node.innerHTML = value</span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> Watcher(<span class="keyword">this</span>.vm, key, (newValue) =&gt; &#123;</span><br><span class="line">        node.innerHTML = newValue</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理 v-on 指令</span></span><br><span class="line">onUpdater (node, value, key, eventType) &#123;</span><br><span class="line">    <span class="comment">// console.log(value, key, eventType, this.vm.$options.methods[key])</span></span><br><span class="line">    node.addEventListener(eventType, <span class="keyword">this</span>.vm.$options.methods[key])</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="请简述-Vue-首次渲染过程。"><a href="#请简述-Vue-首次渲染过程。" class="headerlink" title="请简述 Vue 首次渲染过程。"></a>请简述 Vue 首次渲染过程。</h2><p>解析：</p>
<ol>
<li><p>Vue 初始化，添加实例成员、静态成员，并在原型上挂载<strong>patch</strong>方法和$mount方法。</p>
</li>
<li><p>初始化结束，调用new Vue()。在new Vue()的过程中，调用this.init()方法, 给vue的实例挂载各种功能。</p>
</li>
<li><p>在 this.init() 内部最终会调用 entry-runtime-with-compiler.js中的 vm.$mount(),用于获取render函数。</p>
</li>
<li><p>$mount 获取 render 过程: 如果用户没有传入render,会将template编译为render，如果template也没有，则将el中的内容作为模版，通过 compileToFunctions() 生成render。</p>
</li>
<li><p>接下来调用 runtime/index.js 中的 $mount, 重新获取 el 并调用 mountComponent() 方法。<br> mountComponent 用于触发 beforeMount，定义 updateComponent,创建watcher实例，触发mounted,并最终返回vm实例。</p>
</li>
<li><p>创建完watcher的实例后会调用一次 watcher.get() 方法，该方法会调用updateComponent(), updateComponent()又会调用 vm.render() 以及vm.update(),vm._update()会调用vm.<strong>patch</strong>()挂载真实dom,并将真实dom记录于vm.$el中。</p>
</li>
</ol>
<h2 id="请简述-Vue-响应式原理。"><a href="#请简述-Vue-响应式原理。" class="headerlink" title="请简述 Vue 响应式原理。"></a>请简述 Vue 响应式原理。</h2><p>解析：</p>
<ul>
<li>响应式处理整体过程为initState() =&gt; initData() =&gt; observe()</li>
<li>其中observe是响应式处理的入口，通过该方法为data对象转化为响应式对象。</li>
<li>observe方法接收的是对象且该对象不是响应式时，会为该对象创建一个observe对象，会调用Observer类</li>
<li>Observer类中判断该value是数组还是对象，进行不同的处理</li>
<li>数组的响应化处理，是重写push,pop,sort等会修改原数组的方法，调用对应的notify.然后遍历数组中的成员，判断其类型决定是否调用observe方法</li>
<li>对象的响应化处理，会调用walk方法，遍历对象中的每个属性，调用defineReactive</li>
<li>defineReactive的核心是为每一个属性定义getter和setter,getter中收集依赖，setter中派发更新,即调用dep.notify。</li>
<li>dep.notify()会调用watcher的update()方法。如果该watcher未被处理，会被添加到queue队列中，并调用flushSchedulerQueue()方法，该方法会触发对应的钩子函数以及调用watcher.run()更新视图。</li>
</ul>
<h2 id="请简述虚拟-DOM-中-Key-的作用和好处。"><a href="#请简述虚拟-DOM-中-Key-的作用和好处。" class="headerlink" title="请简述虚拟 DOM 中 Key 的作用和好处。"></a>请简述虚拟 DOM 中 Key 的作用和好处。</h2><p>解析：</p>
<p>​    作用： 标识节点在当前层级的唯一性。<br>​    好处： 在执行 updateChildren 对比新旧 Vnode 的子节点差异时，通过设置 key 可以进行更高效的比较，便于复用节点。 降低创建销毁节点成本，从而减少 dom 操作，提升更新 dom 的性能。</p>
<p>​      </p>
<h2 id="请简述-Vue-中模版编译过程。"><a href="#请简述-Vue-中模版编译过程。" class="headerlink" title="请简述 Vue 中模版编译过程。"></a>请简述 Vue 中模版编译过程。</h2><p>解析：</p>
<ul>
<li>模版编译入口函数是compileToFunctions,首先判断是否有缓存好的render函数，如果没有，则调用compile。compile用作于合并options, 它将用户传入的options和初始化的options合并起来。然后将template和合并好的options传递给baseCompile。</li>
<li>在 baseCompile 中完成了模版编译的核心部分：</li>
<li>调用parse()将template转换成AST对象；</li>
<li>调用optimize()优化 AST tree；</li>
<li>调用 generate() 将优化后的AST tree转换成字符串形式的代码。</li>
<li>最后回到compileToFunctions，通过createFunction()将字符串形式的代码转换为函数,并将其挂载到Vue实例的options对应的属性中。</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/前端/">前端</a><a class="article-category-link" href="/categories/前端/框架/">框架</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vue/">vue</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-life" class="article article-type-post" itemscope="" itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/01/02/life/" class="article-date">
      <time datetime="2019-01-01T16:00:00.000Z" itemprop="datePublished">2019-01-02</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/02/life/">记录生活</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>没什么文采，想说什么就说什么。</p>
<blockquote>
<p>2019-1-2<br>最近特别怀旧，喜欢看老剧、听老歌，可能。。。。自己真的老了吧。<br>以前看不懂的红楼梦（87版，现在的电视剧真不敢恭维，不排除有好的（有个小戏骨翻拍的红楼梦，听说还可以），但以前的老演员演技是真的好，也敬业。），现在看起来发现剧中各种小细节，很讽刺，也很现实，演员演得也好，眉眼之间但是演技，每个眼神特写都不多余。<br>对了，才发现剧中的王熙凤是邓婕（张国立的老婆）演的。</p>
</blockquote>
<blockquote>
<p>2019-3-10<br>好久没有更新博客了，利用寒假时间把js又深入的学习了一遍，发现时间过的很快，一个月转眼就过去了。<br>大三下学期要面临找实习，我开始焦虑了。<br>算下来学习前端的时间有一年多了吧。<br>尤其是大三上学期，我接触了es6、webpack打包工具、vue、vue-cli自动化构建工具、vuex状态管理、以及服务端的js——node、babel编译工具、模块化编程等等，发现前端的知识好杂乱，要学的好多，为了搞懂这些东西，花费了我大量时间，感觉时间都浪费掉了。在追求知识的广度和深度这个问题上，我迷茫了。<br>随着时间的推进，我慢慢察觉基础的重要性，开始对css、js进行更深一步的进阶学习，收获挺多，基础还是很重要的。<br>今天写了一个三级联动，碰到了一些问题，就此谈一下我的感受：</p>
<ol>
<li>对于jquery动态添加的Dom元素无法绑定事件，可以借助事件代理。但就因为这个问题我折腾了一、两个小时，为啥呢？因为我为动态添加的option标签绑定了click事件！！！（Chrome对option的click事件不支持，卧槽！在我心中堪称完美的Chrome居然也有缺陷），这个问题曾一度让我怀疑自己。</li>
<li>上面都不是关键，之所以要说这个问题，我想强调的是“百度使用方式的重要性”，之前我一直搜索的是“jquery动态添加的Dom元素绑定事件失效”，然后出来一大堆，基本上都是说使用事件代理，于是就照着这个方法修改了代码，最后发现没用啊，难道是我别的地方出错了？调试了好几遍还是没问题啊，打开控制台，发现事件添加上去了，当时的我一脸懵逼。。。来回折腾进一个小时，几乎快要崩溃。。休息了10分钟，整理了一下思绪，一步步的排除错误，最后锁定在了select标签这个东西上。再次打开百度，输入“select标签绑定click事件无效”，终于真相大白，原来是Chrome浏览器不支持 。</li>
<li>由此我发现，我还是没有找到解决问题的关键。但同样一个问题，搜索的方式至关重要，学会使用关键字搜索也是一门学问。</li>
<li>以上只是我的一些个人看法，因人而异吧。<br>最后想勉励一下自己，还得继续加油啊。</li>
</ol>
</blockquote>
<blockquote>
<p>2019-3-25<br>今天用js敲了几个排序算法（为了面试），让我再次发现了调试的重要性！下面是希尔排序，话不多说，上代码</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line">//希尔排序</span><br><span class="line">    let increase = Math.floor(arr.length / 2);</span><br><span class="line">    while (increase!==0) &#123;</span><br><span class="line">		</span><br><span class="line">		//第一层for循环 ：分成几组</span><br><span class="line">        for (let j = 0; j &lt; increase; j++) &#123;</span><br><span class="line">			</span><br><span class="line">             //第二层for循环 ：每组多少成员</span><br><span class="line">            for (let i = j + increase, t = 1; t &lt; arr.length / increase; i += increase, t++) &#123;</span><br><span class="line">				</span><br><span class="line">                let flag=i; //记录i值</span><br><span class="line">				</span><br><span class="line">				//下面while循环是直接插入排序    注意！while循环会引起i值改变</span><br><span class="line">                while (arr[i] &lt; arr[i - increase]) &#123;  </span><br><span class="line"></span><br><span class="line">                    arr[i - increase] = arr[i] + arr[i - increase];</span><br><span class="line">                    arr[i] = arr[i - increase] - arr[i];</span><br><span class="line">                    arr[i - increase] = arr[i - increase] - arr[i];</span><br><span class="line"></span><br><span class="line">                    i = i - increase;</span><br><span class="line">                    if (i === j) break;</span><br><span class="line">                &#125; </span><br><span class="line">				</span><br><span class="line">                i=flag; //恢复i值</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        //debugger</span><br><span class="line">        //console.log(arr);</span><br><span class="line">        increase = Math.floor(increase/2); //记录每次增量改变</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">折腾最久的就是上面那个i值得恢复，通过debugger发现，只要进行直接插入排序，i值就会发生变化，因此需要排序后进行i值恢复。</span><br><span class="line">上面这个希尔排序只是简单的练手，算法的性能以及健壮性上面可能不是很好，但希尔排序算法的思想还是能体现出来的。</span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">//快速排序  (百度百科)  （基准值、左右索引、递归）</span><br><span class="line">    const quickSort = (array) =&gt; &#123;</span><br><span class="line">         const sort = (arr, left = 0, right = arr.length - 1) =&gt; &#123;</span><br><span class="line">             if (left &gt;= right) &#123;//如果左边的索引大于等于右边的索引说明整理完毕</span><br><span class="line">                 return</span><br><span class="line">             &#125;</span><br><span class="line">             let i = left;</span><br><span class="line">             let j = right;</span><br><span class="line">             const baseVal = arr[j]; // 取无序数组最后一个数为基准值</span><br><span class="line">             //debugger;</span><br><span class="line">             while (i &lt; j) &#123;//把所有比基准值小的数放在左边大的数放在右边</span><br><span class="line">                 while (i &lt; j &amp;&amp; arr[i] &lt;= baseVal) &#123; //找到一个比基准值大的数交换</span><br><span class="line">                     i++</span><br><span class="line">                 &#125;</span><br><span class="line">                 arr[j] = arr[i];// 将较大的值放在右边如果没有比基准值大的数就是将自己赋值给自己（i 等于 j）</span><br><span class="line">                 while (j &gt; i &amp;&amp; arr[j] &gt;= baseVal) &#123; //找到一个比基准值小的数交换</span><br><span class="line">                     j--</span><br><span class="line">                 &#125;</span><br><span class="line">                 arr[i] = arr[j] // 将较小的值放在左边如果没有找到比基准值小的数就是将自己赋值给自己（i 等于 j）</span><br><span class="line">             &#125;</span><br><span class="line">             arr[j] = baseVal; // 将基准值放至中央位置完成一次循环（这时候 j 等于 i ）</span><br><span class="line">             sort(arr, left, j-1); // 将左边的无序数组重复上面的操作</span><br><span class="line">             sort(arr, j+1, right) // 将右边的无序数组重复上面的操作</span><br><span class="line">         &#125;;</span><br><span class="line">         const newArr = array.concat(); // 为了保证这个函数是纯函数拷贝一次数组</span><br><span class="line">         sort(newArr);</span><br><span class="line">         return newArr</span><br><span class="line">     &#125;;</span><br><span class="line"></span><br><span class="line">    //二分查找</span><br><span class="line">    function binary(find, arr, low, high) &#123;</span><br><span class="line">        if (low &lt;= high) &#123;</span><br><span class="line">            if (arr[low] == find) &#123;</span><br><span class="line">                return low;</span><br><span class="line">            &#125;</span><br><span class="line">            if (arr[high] == find) &#123;</span><br><span class="line">                return high;</span><br><span class="line">            &#125;</span><br><span class="line">            var mid = Math.ceil((high + low) / 2);</span><br><span class="line">            if (arr[mid] == find) &#123;</span><br><span class="line">                return mid;</span><br><span class="line">            &#125; else if (arr[mid] &gt; find) &#123;</span><br><span class="line">                return binary(find, arr, low, mid - 1);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                return binary(find, arr, mid + 1, high);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return -1;</span><br><span class="line">    &#125;</span><br><span class="line">		</span><br><span class="line">		//深度搜索</span><br><span class="line">		function deepTraversal(node) &#123;</span><br><span class="line">        var nodeList = [];</span><br><span class="line">        if (node) &#123;</span><br><span class="line">            var stack = [];//先进后出</span><br><span class="line">            stack.push(node);</span><br><span class="line">            while (stack.length != 0) &#123;</span><br><span class="line">                var childrenItem = stack.pop();</span><br><span class="line">                nodeList.push(childrenItem);</span><br><span class="line">                var childrenList = childrenItem.children;</span><br><span class="line">                for (var i = childrenList.length - 1; i &gt;= 0; i--)</span><br><span class="line">                    stack.push(childrenList[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return nodeList;</span><br><span class="line">    &#125;</span><br><span class="line">    //广度搜索</span><br><span class="line">    function wideTraversal(node) &#123;</span><br><span class="line">        var nodes = [];</span><br><span class="line">        if (node ) &#123;</span><br><span class="line">            var queue = [];//先进先出</span><br><span class="line">            queue.unshift(node);</span><br><span class="line">            while (queue.length != 0) &#123;</span><br><span class="line">                var item = queue.shift();</span><br><span class="line">                nodes.push(item);</span><br><span class="line">                var children = item.children;</span><br><span class="line">                for (var i = 0; i &lt; children.length; i++)</span><br><span class="line">                    queue.push(children[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return nodes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">下面是几个简单的排序算法：</span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">     //简单选择排序</span><br><span class="line">     for(let i=0;i&lt;arr.length;i++)</span><br><span class="line">     &#123;</span><br><span class="line">         for(let j=i+1;j&lt;arr.length;j++)</span><br><span class="line">         &#123;</span><br><span class="line">             if(arr[j]&lt;arr[i])</span><br><span class="line">             &#123;</span><br><span class="line">                 arr[i]=arr[i]+arr[j];</span><br><span class="line">                 arr[j]=arr[i]-arr[j];</span><br><span class="line">                 arr[i]=arr[i]-arr[j];</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         //console.log(arr);</span><br><span class="line">     &#125;</span><br><span class="line">	 </span><br><span class="line">	 //冒泡排序</span><br><span class="line">     for(let i=0;i&lt;arr.length;i++)</span><br><span class="line">     &#123;</span><br><span class="line">         for(let i=0;i&lt;arr.length;i++)</span><br><span class="line">         &#123;</span><br><span class="line">             if(arr[i+1]&lt;arr[i])</span><br><span class="line">             &#123;</span><br><span class="line">                 arr[i]=arr[i]+arr[i+1];</span><br><span class="line">                 arr[i+1]=arr[i]-arr[i+1];</span><br><span class="line">                 arr[i]=arr[i]-arr[i+1];</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         //console.log(arr);</span><br><span class="line">     &#125;</span><br><span class="line">	 </span><br><span class="line">	 //直接插入排序</span><br><span class="line">    for(let i=1;i&lt;arr.length;i++)</span><br><span class="line">    &#123;</span><br><span class="line">			  let flag=i;</span><br><span class="line">        while(arr[i]&lt;arr[i-1])</span><br><span class="line">        &#123;</span><br><span class="line">            arr[i-1]=arr[i]+arr[i-1];</span><br><span class="line">            arr[i]=arr[i-1]-arr[i];</span><br><span class="line">            arr[i-1]=arr[i-1]-arr[i];</span><br><span class="line"></span><br><span class="line">            i=i-1;</span><br><span class="line">            if(i===0) break;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">				 i=flag;</span><br><span class="line">       // console.log(arr);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>通过敲这几个排序算法，发现动手实践是很重要的。但我认为，动手之前基本的东西最好搞明白，不然你会发现出的错都是跟它们有关，有些错误还很低级，但足够你折腾半天。<br>还要再说一遍，只是练手，只是练手，只是练手。</p>
<blockquote>
<p>2019-5-22<br>刚开始学习React,官方文档都还没看一遍就开始被狂轰滥炸的问各种React高级和底层基础，？？？？？好慌啊，稳如狗？ 好像翻车了哦。。</p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/生活/">生活</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/生活，心情/">生活，心情</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-bug" class="article article-type-post" itemscope="" itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/12/30/bug/" class="article-date">
      <time datetime="2018-12-29T16:00:00.000Z" itemprop="datePublished">2018-12-30</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/30/bug/">遇到的一些坑</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>2018-12-30</p>
<ul>
<li>img标签设置伪元素after、before无效</li>
</ul>
</blockquote>
<blockquote>
<p>2019-3-10</p>
<ul>
<li>chrome浏览器不支持select标签下option的click事件，可以为select绑定change事件。</li>
</ul>
</blockquote>
<blockquote>
<p>2019-3-29</p>
<ul>
<li>inline元素</li>
</ul>
<ol>
<li>margin/padding在竖直方向上无效，水平方向上有效 </li>
<li>浮动或绝对定位时会转换为block </li>
</ol>
<ul>
<li>IE6浏览器常见的bug</li>
</ul>
<ol>
<li>IE6不支持min-height，解决办法使用css hack：<br>.target {<br> min-height: 100px;<br> height: auto !important;<br> height: 100px;   // IE6下内容高度超过会自动扩展高度<br>}</li>
<li>IE6只支持a标签的:hover伪类，解决方法：使用js为元素监听mouseenter，mouseleave事件，动态添加类</li>
<li>IE5-8不支持opacity，解决办法：<pre><code>.opacity {
 opacity: 0.4
 filter: alpha(opacity=60); /* for IE5-7 */
 -ms-filter: &quot;progid:DXImageTransform.Microsoft.Alpha(Opacity=60)&quot;; /* for IE 8*/
}
</code></pre></li>
<li>IE6不支持PNG透明背景，解决办法: 使用gif图片</li>
<li>IE6-7不支持display: inline-block 解决办法：<pre><code>display: inline-block;
*display: inline;
*zoom: 1;
</code></pre></li>
</ol>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/前端/">前端</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/css/">css</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  

</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2021 DiamondsZz
            </div>        
        </div>
    </div>
</footer>

    </div>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 1;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>






<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" "="">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(
            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>